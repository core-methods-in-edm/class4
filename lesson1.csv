"time","answer","id"
"1471018822967","summary(lm(y_mat[,i]~treat))$coefficients[2,3]","magdalena"
"1471018833937","","magdalena"
"1471018833941","","magdalena"
"1471018833941","","magdalena"
"1471018833941","","magdalena"
"1471018833941","","magdalena"
"1471018833941","","magdalena"
"1471018833941","","magdalena"
"1471018833956","n = 1000","magdalena"
"1471018833956","","magdalena"
"1471018833956","s = 10","magdalena"
"1471018833956","","magdalena"
"1471018833972","beta = rep(0,s)","magdalena"
"1471018833972","","magdalena"
"1471018833972","prob=0.5","magdalena"
"1471018833972","treat=rbinom(n,1,prob)","magdalena"
"1471018833987","","magdalena"
"1471018833987","for (i in 1","magdalena"
"s){","","magdalena"
"1471018833987","y=beta[i]*treat+rnorm(n)","magdalena"
"1471018833987","if (i==1){","magdalena"
"1471018834003","y_mat=y","magdalena"
"1471018834003","}","magdalena"
"1471018834003","if (i>1){","magdalena"
"1471018834003","y_mat=cbind(y_mat,y)","magdalena"
"1471018834022","}","magdalena"
"1471018834026","}","magdalena"
"1471018834035","","magdalena"
"1471018834039","beta_hat=rep(NA,s)","magdalena"
"1471018834041","t_hat=rep(NA,s)","magdalena"
"1471018834041","for (i in 1","magdalena"
"s){","","magdalena"
"1471018834041","beta_hat=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471018834056","t_hat=summary(lm(y_mat[,i]~treat))$coefficients[2,3]","magdalena"
"1471018834056","}","magdalena"
"1471018865419","","magdalena"
"1471018865422","","magdalena"
"1471018865425","","magdalena"
"1471018865430","","magdalena"
"1471018865434","","magdalena"
"1471018865439","","magdalena"
"1471018865444","","magdalena"
"1471018865448","set.seed(100)","magdalena"
"1471018865453","","magdalena"
"1471018865457","n = 1000","magdalena"
"1471018865462","","magdalena"
"1471018865465","s = 10","magdalena"
"1471018865471","","magdalena"
"1471018865475","beta = rep(0,s)","magdalena"
"1471018865481","","magdalena"
"1471018865484","prob=0.5","magdalena"
"1471018865488","treat=rbinom(n,1,prob)","magdalena"
"1471018865494","","magdalena"
"1471018865499","for (i in 1","magdalena"
"s){","","magdalena"
"1471018865504","y=beta[i]*treat+rnorm(n)","magdalena"
"1471018865509","if (i==1){","magdalena"
"1471018865512","y_mat=y","magdalena"
"1471018865516","}","magdalena"
"1471018865520","if (i>1){","magdalena"
"1471018865525","y_mat=cbind(y_mat,y)","magdalena"
"1471018865530","}","magdalena"
"1471018865535","}","magdalena"
"1471018865551","","magdalena"
"1471018865557","beta_hat=rep(NA,s)","magdalena"
"1471018865562","t_hat=rep(NA,s)","magdalena"
"1471018865570","for (i in 1","magdalena"
"s){","","magdalena"
"1471018865575","beta_hat=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471018865579","t_hat=summary(lm(y_mat[,i]~treat))$coefficients[2,3]","magdalena"
"1471018865584","}","magdalena"
"1471018927226","summary(lm(y_mat[,i]~treat))$coefficients","magdalena"
"1471019041442","","magdalena"
"1471019041442","","magdalena"
"1471019041442","","magdalena"
"1471019041442","","magdalena"
"1471019041458","","magdalena"
"1471019041458","","magdalena"
"1471019041458","","magdalena"
"1471019041458","set.seed(100)","magdalena"
"1471019041477","","magdalena"
"1471019041480","n = 1000","magdalena"
"1471019041486","","magdalena"
"1471019041489","s = 10","magdalena"
"1471019041494","","magdalena"
"1471019041494","beta = rep(0,s)","magdalena"
"1471019041494","","magdalena"
"1471019041494","prob=0.5","magdalena"
"1471019041509","treat=rbinom(n,1,prob)","magdalena"
"1471019041509","","magdalena"
"1471019041509","for (i in 1","magdalena"
"s){","","magdalena"
"1471019041525","y=beta[i]*treat+rnorm(n)","magdalena"
"1471019041525","if (i==1){","magdalena"
"1471019041525","y_mat=y","magdalena"
"1471019041525","}","magdalena"
"1471019041541","if (i>1){","magdalena"
"1471019041541","y_mat=cbind(y_mat,y)","magdalena"
"1471019041551","}","magdalena"
"1471019041556","}","magdalena"
"1471019041569","","magdalena"
"1471019041575","beta_hat=rep(NA,s)","magdalena"
"1471019041580","t_hat=rep(NA,s)","magdalena"
"1471019041586","reject_unadjust=rep(,s)","magdalena"
"1471019041591","for (i in 1","magdalena"
"s){","","magdalena"
"1471019041595","beta_hat=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471019041600","t_hat=summary(lm(y_mat[,i]~treat))$coefficients[2,3]","magdalena"
"1471019041606","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471019041610","reject_unadjust[i]=No","magdalena"
"1471019041613","}","magdalena"
"1471019041619","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471019041624","reject_unadjust[i]=90","magdalena"
"1471019041624","}","magdalena"
"1471019041624","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471019041624","reject_unadjust[i]=95","magdalena"
"1471019041639","}","magdalena"
"1471019041639","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471019041639","reject_unadjust[i]=99","magdalena"
"1471019041658","}","magdalena"
"1471019041663","}","magdalena"
"1471019046777","reject_unadjust","magdalena"
"1471019159844","help(sample)","magdalena"
"1471019269086","i=1","magdalena"
"1471019273529","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471019278949","table(id)","magdalena"
"1471019343785","sample=cbind(y_mat,treat)[id,]","magdalena"
"1471019347452","View(sample)","magdalena"
"1471019357376","dim(sample)","magdalena"
"1471019636930","for (k in 1","magdalena"
"s){","","magdalena"
"1471019636930","beta_bs[i,k]=lm(sample[,k]~sample[,s+1])$coefficients[2]","magdalena"
"1471019636930","t_bs[i,k]=(beta_bs[i,k]-beta_hat[k])/summary(lm(sample[,k]~sample[,s+1]))$coefficients[2,2]","magdalena"
"1471019636930","}","magdalena"
"1471019642510","beta_bs=matrix(NA,s,B)","magdalena"
"1471019659789","t_bs=matrix(NA,s,B)","magdalena"
"1471019666579","B=1000","magdalena"
"1471019666579","beta_bs=matrix(NA,s,B)","magdalena"
"1471019666594","t_bs=matrix(NA,s,B)","magdalena"
"1471019673653","i=1","magdalena"
"1471019682353","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471019682353","sample=cbind(y_mat,treat)[id,]","magdalena"
"1471019688565","for (k in 1","magdalena"
"s){","","magdalena"
"1471019688565","beta_bs[i,k]=lm(sample[,k]~sample[,s+1])$coefficients[2]","magdalena"
"1471019688565","t_bs[i,k]=(beta_bs[i,k]-beta_hat[k])/summary(lm(sample[,k]~sample[,s+1]))$coefficients[2,2]","magdalena"
"1471019688565","}","magdalena"
"1471019693862","View(beta_bs)","magdalena"
"1471019725005","View(beta_bs)","magdalena"
"1471019766469","","magdalena"
"1471019766473","B=1000","magdalena"
"1471019766477","beta_bs=matrix(NA,B,s)","magdalena"
"1471019766477","t_bs=matrix(NA,B,s)","magdalena"
"1471019774283","dim(beta_bs)","magdalena"
"1471019896289","","magdalena"
"1471019896293","","magdalena"
"1471019896296","","magdalena"
"1471019896300","","magdalena"
"1471019896303","","magdalena"
"1471019896307","","magdalena"
"1471019896312","","magdalena"
"1471019896316","set.seed(100)","magdalena"
"1471019896322","","magdalena"
"1471019896325","n = 1000","magdalena"
"1471019896330","","magdalena"
"1471019896333","s = 10","magdalena"
"1471019896338","","magdalena"
"1471019896341","beta = rep(0,s)","magdalena"
"1471019896347","","magdalena"
"1471019896350","prob=0.5","magdalena"
"1471019896354","treat=rbinom(n,1,prob)","magdalena"
"1471019896358","","magdalena"
"1471019896363","for (i in 1","magdalena"
"s){","","magdalena"
"1471019896367","y=beta[i]*treat+rnorm(n)","magdalena"
"1471019896372","if (i==1){","magdalena"
"1471019896375","y_mat=y","magdalena"
"1471019896379","}","magdalena"
"1471019896382","if (i>1){","magdalena"
"1471019896385","y_mat=cbind(y_mat,y)","magdalena"
"1471019896389","}","magdalena"
"1471019896392","}","magdalena"
"1471019896401","","magdalena"
"1471019896406","beta_hat=rep(NA,s)","magdalena"
"1471019896410","t_hat=rep(NA,s)","magdalena"
"1471019896413","reject_unadjust=rep(,s)","magdalena"
"1471019896418","for (i in 1","magdalena"
"s){","","magdalena"
"1471019896421","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471019896424","t_hat[i]=summary(lm(y_mat[,i]~treat))$coefficients[2,3]","magdalena"
"1471019896428","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471019896432","reject_unadjust[i]=No","magdalena"
"1471019896435","}","magdalena"
"1471019896439","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471019896443","reject_unadjust[i]=90","magdalena"
"1471019896448","}","magdalena"
"1471019896452","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471019896455","reject_unadjust[i]=95","magdalena"
"1471019896459","}","magdalena"
"1471019896463","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471019896467","reject_unadjust[i]=99","magdalena"
"1471019896470","}","magdalena"
"1471019896474","}","magdalena"
"1471019897040","","magdalena"
"1471019897044","","magdalena"
"1471019897047","B=1000","magdalena"
"1471019897051","beta_bs=matrix(NA,B,s)","magdalena"
"1471019897054","t_bs=matrix(NA,B,s)","magdalena"
"1471019897060","for (i in 1","magdalena"
"B){","","magdalena"
"1471019897064","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471019897069","y_mat_bs=y_mat[id,]","magdalena"
"1471019897074","treat_bs=treat[id]","magdalena"
"1471019897079","for (k in 1","magdalena"
"s){","","magdalena"
"1471019897083","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471019897087","t_bs[i,k]=(beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2]","magdalena"
"1471019897090","}","magdalena"
"1471019897094","}","magdalena"
"1471020132759","","magdalena"
"1471020132762","","magdalena"
"1471020132765","","magdalena"
"1471020132765","","magdalena"
"1471020132765","","magdalena"
"1471020132765","","magdalena"
"1471020132765","","magdalena"
"1471020132780","set.seed(100)","magdalena"
"1471020132780","","magdalena"
"1471020132780","n = 1000","magdalena"
"1471020132780","","magdalena"
"1471020132780","s = 10","magdalena"
"1471020132797","","magdalena"
"1471020132797","beta = rep(0,s)","magdalena"
"1471020132797","","magdalena"
"1471020132813","prob=0.5","magdalena"
"1471020132813","treat=rbinom(n,1,prob)","magdalena"
"1471020132813","","magdalena"
"1471020132829","for (i in 1","magdalena"
"s){","","magdalena"
"1471020132829","y=beta[i]*treat+rnorm(n)","magdalena"
"1471020132829","if (i==1){","magdalena"
"1471020132844","y_mat=y","magdalena"
"1471020132844","}","magdalena"
"1471020132844","if (i>1){","magdalena"
"1471020132844","y_mat=cbind(y_mat,y)","magdalena"
"1471020132860","}","magdalena"
"1471020132864","}","magdalena"
"1471020132880","","magdalena"
"1471020132880","beta_hat=rep(NA,s)","magdalena"
"1471020132880","t_hat=rep(NA,s)","magdalena"
"1471020132880","reject_unadjust=rep(,s)","magdalena"
"1471020132898","for (i in 1","magdalena"
"s){","","magdalena"
"1471020132898","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471020132898","t_hat[i]=summary(lm(y_mat[,i]~treat))$coefficients[2,3]","magdalena"
"1471020132898","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471020132913","reject_unadjust[i]=No","magdalena"
"1471020132913","}","magdalena"
"1471020132913","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471020132913","reject_unadjust[i]=90","magdalena"
"1471020132929","}","magdalena"
"1471020132929","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471020132929","reject_unadjust[i]=95","magdalena"
"1471020132929","}","magdalena"
"1471020132945","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471020132945","reject_unadjust[i]=99","magdalena"
"1471020132945","}","magdalena"
"1471020132945","}","magdalena"
"1471020133837","","magdalena"
"1471020133843","","magdalena"
"1471020133848","B=1000","magdalena"
"1471020133854","beta_bs=matrix(NA,B,s)","magdalena"
"1471020133860","t_bs=matrix(NA,B,s)","magdalena"
"1471020133867","for (i in 1","magdalena"
"B){","","magdalena"
"1471020133873","","magdalena"
"1471020133878","set.seed(i)","magdalena"
"1471020133884","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471020133890","y_mat_bs=y_mat[id,]","magdalena"
"1471020133896","treat_bs=treat[id]","magdalena"
"1471020133903","for (k in 1","magdalena"
"s){","","magdalena"
"1471020133909","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471020133914","t_bs[i,k]=(beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2]","magdalena"
"1471020133922","}","magdalena"
"1471020133927","}","magdalena"
"1471020663785","alpha=c(0.95,0.975,0.995)","magdalena"
"1471020663789","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471020663795","for (k in 1","magdalena"
"s){","","magdalena"
"1471020663799","t_quantiles[,k]=quantile(t_bs[,k],alpha)","magdalena"
"1471020663803","}","magdalena"
"1471020668433","t_quantiles","magdalena"
"1471020744288","which(max(t_quantiles))","magdalena"
"1471020761075","which(max(t_quantiles[1,]))","magdalena"
"1471020785322","max(t_quantiles[1,])","magdalena"
"1471020801032","which(t_quantiles==max(t_quantiles[1,]))","magdalena"
"1471020807264","which(t_quantiles[1,]==max(t_quantiles[1,]))","magdalena"
"1471020834551","rank(t_quantiles[1,])","magdalena"
"1471020837219","rank(t_quantiles[2,])","magdalena"
"1471020839888","rank(t_quantiles[3,])","magdalena"
"1471020917940","s_max=rep(NA,length(alpha))","magdalena"
"1471020917945","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471020917948","s_max[a]=which(t_quantiles[a,]==max(t_quantiles[a,]))","magdalena"
"1471020917948","}","magdalena"
"1471020920394","s_max","magdalena"
"1471021301850","help(rank)","magdalena"
"1471021324359","rank(c(1,2,4))","magdalena"
"1471021402716","","magdalena"
"1471021402716","","magdalena"
"1471021402716","","magdalena"
"1471021402716","","magdalena"
"1471021402716","","magdalena"
"1471021402732","","magdalena"
"1471021402732","","magdalena"
"1471021402732","set.seed(100)","magdalena"
"1471021402748","","magdalena"
"1471021402748","n = 1000","magdalena"
"1471021402748","","magdalena"
"1471021402748","s = 10","magdalena"
"1471021402763","","magdalena"
"1471021402763","beta = rep(0,s)","magdalena"
"1471021402763","","magdalena"
"1471021402779","prob=0.5","magdalena"
"1471021402779","treat=rbinom(n,1,prob)","magdalena"
"1471021402779","","magdalena"
"1471021402779","for (i in 1","magdalena"
"s){","","magdalena"
"1471021402798","y=beta[i]*treat+rnorm(n)","magdalena"
"1471021402801","if (i==1){","magdalena"
"1471021402801","y_mat=y","magdalena"
"1471021402801","}","magdalena"
"1471021402801","if (i>1){","magdalena"
"1471021402801","y_mat=cbind(y_mat,y)","magdalena"
"1471021402817","}","magdalena"
"1471021402817","}","magdalena"
"1471021402832","","magdalena"
"1471021402832","beta_hat=rep(NA,s)","magdalena"
"1471021402832","t_hat=rep(NA,s)","magdalena"
"1471021402848","reject_unadjust=rep(,s)","magdalena"
"1471021402848","for (i in 1","magdalena"
"s){","","magdalena"
"1471021402848","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471021402848","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471021402863","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471021402863","reject_unadjust[i]=No","magdalena"
"1471021402863","}","magdalena"
"1471021402863","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471021402879","reject_unadjust[i]=90","magdalena"
"1471021402879","}","magdalena"
"1471021402879","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471021402879","reject_unadjust[i]=95","magdalena"
"1471021402897","}","magdalena"
"1471021402901","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471021402901","reject_unadjust[i]=99","magdalena"
"1471021402901","}","magdalena"
"1471021402901","}","magdalena"
"1471021403580","","magdalena"
"1471021403584","","magdalena"
"1471021403587","B=1000","magdalena"
"1471021403593","beta_bs=matrix(NA,B,s)","magdalena"
"1471021403598","t_bs=matrix(NA,B,s)","magdalena"
"1471021403602","for (i in 1","magdalena"
"B){","","magdalena"
"1471021403606","","magdalena"
"1471021403609","set.seed(i)","magdalena"
"1471021403613","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471021403617","y_mat_bs=y_mat[id,]","magdalena"
"1471021403621","treat_bs=treat[id]","magdalena"
"1471021403627","for (k in 1","magdalena"
"s){","","magdalena"
"1471021403631","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471021403636","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471021403640","}","magdalena"
"1471021403643","}","magdalena"
"1471021565051","","magdalena"
"1471021565051","alpha=c(0.95,0.975,0.995)","magdalena"
"1471021565051","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471021641574","cbind(c(1,2,3),c(4,5,7))","magdalena"
"1471021654058","rankCol(cbind(c(1,2,3),c(4,5,7)))","magdalena"
"1471021810192","dim(t_bs)","magdalena"
"1471022559437","alpha=c(0.95,0.975,0.995)","magdalena"
"1471022559442","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471022559448","reject_adjust=rep(,s)","magdalena"
"1471022564827","a=1","magdalena"
"1471022568502","t_hat_aux=t_hat","magdalena"
"1471022568502","t_bs_aux=t_bs","magdalena"
"1471022568502","done=F","magdalena"
"1471022575939","t_max=max(t_hat_aux)","magdalena"
"1471022578640","t_max","magdalena"
"1471022583232","k=which(t_hat_aux==t_max)","magdalena"
"1471022584870","k","magdalena"
"1471022592502","reject_unadjust","magdalena"
"1471022598193","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471022598205","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471022604056","t_quantile","magdalena"
"1471022614443","t_max>=t_quantile","magdalena"
"1471022640823","a=2","magdalena"
"1471022644236","t_hat_aux=t_hat","magdalena"
"1471022644240","t_bs_aux=t_bs","magdalena"
"1471022644243","done=F","magdalena"
"1471022651314","t_max=max(t_hat_aux)","magdalena"
"1471022651318","k=which(t_hat_aux==t_max)","magdalena"
"1471022651322","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471022651340","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471022656913","t_quantile","magdalena"
"1471022661675","t_max>=t_quantile","magdalena"
"1471022671680","alpha=c(0.95,0.975,0.995)","magdalena"
"1471022671685","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471022671689","reject_adjust=rep(,s)","magdalena"
"1471022671693","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471022671694","t_hat_aux=t_hat","magdalena"
"1471022671694","t_bs_aux=t_bs","magdalena"
"1471022671694","done=F","magdalena"
"1471022671694","while(done==F){","magdalena"
"1471022671694","t_max=max(t_hat_aux)","magdalena"
"1471022671710","k=which(t_hat_aux==t_max)","magdalena"
"1471022671710","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471022671710","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471022671710","if(t_max>=t_quantile){","magdalena"
"1471022671726","reject_adjust[s]=alpha[a]","magdalena"
"1471022671726","t_hat_aux=t_hat_aux[,-k]","magdalena"
"1471022671726","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471022671726","}","magdalena"
"1471022671726","else{","magdalena"
"1471022671741","done=T","magdalena"
"1471022671741","}","magdalena"
"1471022671741","}","magdalena"
"1471022671741","}","magdalena"
"1471022678239","reject_unadjust","magdalena"
"1471022681695","reject_adjust","magdalena"
"1471022756607","","magdalena"
"1471022756611","","magdalena"
"1471022756614","","magdalena"
"1471022756617","","magdalena"
"1471022756620","","magdalena"
"1471022756624","","magdalena"
"1471022756624","","magdalena"
"1471022756624","set.seed(100)","magdalena"
"1471022756624","","magdalena"
"1471022756624","n = 1000","magdalena"
"1471022756640","","magdalena"
"1471022756640","s = 10","magdalena"
"1471022756640","","magdalena"
"1471022756657","beta = rep(1,s)","magdalena"
"1471022756662","","magdalena"
"1471022756665","prob=0.5","magdalena"
"1471022756668","treat=rbinom(n,1,prob)","magdalena"
"1471022756673","","magdalena"
"1471022756676","for (i in 1","magdalena"
"s){","","magdalena"
"1471022756680","y=beta[i]*treat+rnorm(n)","magdalena"
"1471022756684","if (i==1){","magdalena"
"1471022756687","y_mat=y","magdalena"
"1471022756690","}","magdalena"
"1471022756693","if (i>1){","magdalena"
"1471022756694","y_mat=cbind(y_mat,y)","magdalena"
"1471022756694","}","magdalena"
"1471022756694","}","magdalena"
"1471022756710","","magdalena"
"1471022756710","beta_hat=rep(NA,s)","magdalena"
"1471022756710","t_hat=rep(NA,s)","magdalena"
"1471022756726","reject_unadjust=rep(,s)","magdalena"
"1471022756726","for (i in 1","magdalena"
"s){","","magdalena"
"1471022756726","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471022756726","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471022756726","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471022756741","reject_unadjust[i]=No","magdalena"
"1471022756741","}","magdalena"
"1471022756741","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471022756741","reject_unadjust[i]=90","magdalena"
"1471022756757","}","magdalena"
"1471022756763","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471022756765","reject_unadjust[i]=95","magdalena"
"1471022756765","}","magdalena"
"1471022756765","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471022756781","reject_unadjust[i]=99","magdalena"
"1471022756781","}","magdalena"
"1471022756781","}","magdalena"
"1471022757335","","magdalena"
"1471022757339","","magdalena"
"1471022757342","B=1000","magdalena"
"1471022757347","beta_bs=matrix(NA,B,s)","magdalena"
"1471022757350","t_bs=matrix(NA,B,s)","magdalena"
"1471022757355","for (i in 1","magdalena"
"B){","","magdalena"
"1471022757358","","magdalena"
"1471022757362","set.seed(i)","magdalena"
"1471022757366","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471022757370","y_mat_bs=y_mat[id,]","magdalena"
"1471022757373","treat_bs=treat[id]","magdalena"
"1471022757377","for (k in 1","magdalena"
"s){","","magdalena"
"1471022757382","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471022757386","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471022757390","}","magdalena"
"1471022757394","}","magdalena"
"1471022970377","reject_unadjust","magdalena"
"1471022977654","alpha=c(0.95,0.975,0.995)","magdalena"
"1471022977658","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471022977664","reject_adjust=rep(,s)","magdalena"
"1471022981324","a=1","magdalena"
"1471022985126","t_hat_aux=t_hat","magdalena"
"1471022985130","t_bs_aux=t_bs","magdalena"
"1471022985134","done=F","magdalena"
"1471022991058","t_max=max(t_hat_aux)","magdalena"
"1471022991063","k=which(t_hat_aux==t_max)","magdalena"
"1471022991069","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471022991079","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471022993775","t_max","magdalena"
"1471022996123","k","magdalena"
"1471023001532","t_max>=t_quantile","magdalena"
"1471023020779","reject_adjust[k]=alpha[a]","magdalena"
"1471023020783","t_hat_aux=t_hat_aux[,-k]","magdalena"
"1471023020788","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023037628","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023041682","t_hat","magdalena"
"1471023045719","length(t_hat)","magdalena"
"1471023050964","length(t_hat_aux)","magdalena"
"1471023056964","dim(t_bs_aux)","magdalena"
"1471023067753","t_max=max(t_hat_aux)","magdalena"
"1471023067758","k=which(t_hat_aux==t_max)","magdalena"
"1471023067764","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023067777","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023071067","t_max","magdalena"
"1471023073231","k","magdalena"
"1471023079342","t_max>=t_quantile","magdalena"
"1471023083188","reject_adjust[k]=alpha[a]","magdalena"
"1471023083192","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023083196","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023095907","alpha=c(0.95,0.975,0.995)","magdalena"
"1471023095911","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471023095915","reject_adjust=rep(,s)","magdalena"
"1471023095919","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471023095924","t_hat_aux=t_hat","magdalena"
"1471023095926","t_bs_aux=t_bs","magdalena"
"1471023095929","done=F","magdalena"
"1471023095932","while(done==F){","magdalena"
"1471023095938","t_max=max(t_hat_aux)","magdalena"
"1471023095941","k=which(t_hat_aux==t_max)","magdalena"
"1471023095945","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023095948","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023095952","if(t_max>=t_quantile){","magdalena"
"1471023095957","reject_adjust[k]=alpha[a]","magdalena"
"1471023095960","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023095964","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023095969","}","magdalena"
"1471023095975","else{","magdalena"
"1471023095979","done=T","magdalena"
"1471023095984","}","magdalena"
"1471023095988","}","magdalena"
"1471023095992","}","magdalena"
"1471023096105","reject_adjust[reject_adjust==]=No","magdalena"
"1471023117766","reject_adjust","magdalena"
"1471023133036","alpha=c(0.95,0.975,0.995)","magdalena"
"1471023133041","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471023133044","reject_adjust=rep(,s)","magdalena"
"1471023142746","a=1","magdalena"
"1471023146318","t_hat_aux=t_hat","magdalena"
"1471023146321","t_bs_aux=t_bs","magdalena"
"1471023146326","done=F","magdalena"
"1471023156791","t_max=max(t_hat_aux)","magdalena"
"1471023156796","k=which(t_hat_aux==t_max)","magdalena"
"1471023156801","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023156812","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023156818","if(t_max>=t_quantile){","magdalena"
"1471023156821","reject_adjust[k]=alpha[a]","magdalena"
"1471023156825","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023156829","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023156832","}","magdalena"
"1471023166540","t_max>=t_quantile","magdalena"
"1471023173695","t_max=max(t_hat_aux)","magdalena"
"1471023173698","k=which(t_hat_aux==t_max)","magdalena"
"1471023173702","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023173715","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023173720","if(t_max>=t_quantile){","magdalena"
"1471023173723","reject_adjust[k]=alpha[a]","magdalena"
"1471023173728","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023173732","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023173736","}","magdalena"
"1471023186287","t_max>=t_quantile","magdalena"
"1471023193854","t_max=max(t_hat_aux)","magdalena"
"1471023193858","k=which(t_hat_aux==t_max)","magdalena"
"1471023193862","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023193874","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023193879","if(t_max>=t_quantile){","magdalena"
"1471023193883","reject_adjust[k]=alpha[a]","magdalena"
"1471023193887","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023193890","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023193894","}","magdalena"
"1471023238229","1-alpha[a]","magdalena"
"1471023265516","alpha=c(0.95,0.975,0.995)","magdalena"
"1471023265516","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471023265527","reject_adjust=rep(,s)","magdalena"
"1471023265531","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471023265536","t_hat_aux=t_hat","magdalena"
"1471023265540","t_bs_aux=t_bs","magdalena"
"1471023265544","done=F","magdalena"
"1471023265550","while(done==F){","magdalena"
"1471023265554","t_max=max(t_hat_aux)","magdalena"
"1471023265559","k=which(t_hat_aux==t_max)","magdalena"
"1471023265565","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023265570","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023265576","if(t_max>=t_quantile){","magdalena"
"1471023265581","reject_adjust[k]=alpha[a]*100+(1-alpha[a])*200","magdalena"
"1471023265587","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023265592","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023265596","}","magdalena"
"1471023265603","else{","magdalena"
"1471023265608","done=T","magdalena"
"1471023265614","}","magdalena"
"1471023265616","}","magdalena"
"1471023265616","}","magdalena"
"1471023283102","alpha=c(0.95,0.975,0.995)","magdalena"
"1471023283106","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471023283111","reject_adjust=rep(,s)","magdalena"
"1471023287687","a=1","magdalena"
"1471023291306","t_hat_aux=t_hat","magdalena"
"1471023291310","t_bs_aux=t_bs","magdalena"
"1471023291314","done=F","magdalena"
"1471023296204","done==F","magdalena"
"1471023307069","t_max=max(t_hat_aux)","magdalena"
"1471023307069","k=which(t_hat_aux==t_max)","magdalena"
"1471023307069","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023307084","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023307084","if(t_max>=t_quantile){","magdalena"
"1471023307084","reject_adjust[k]=alpha[a]*100+(1-alpha[a])*200","magdalena"
"1471023307084","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023307100","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023307100","}","magdalena"
"1471023313274","t_max=max(t_hat_aux)","magdalena"
"1471023313278","k=which(t_hat_aux==t_max)","magdalena"
"1471023313283","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023313293","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023313293","if(t_max>=t_quantile){","magdalena"
"1471023313293","reject_adjust[k]=alpha[a]*100+(1-alpha[a])*200","magdalena"
"1471023313310","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023313313","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023313313","}","magdalena"
"1471023316374","t_max=max(t_hat_aux)","magdalena"
"1471023316390","k=which(t_hat_aux==t_max)","magdalena"
"1471023316390","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023316390","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023316406","if(t_max>=t_quantile){","magdalena"
"1471023316406","reject_adjust[k]=alpha[a]*100+(1-alpha[a])*200","magdalena"
"1471023316406","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023316406","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023316421","}","magdalena"
"1471023320748","t_max=max(t_hat_aux)","magdalena"
"1471023320748","k=which(t_hat_aux==t_max)","magdalena"
"1471023320748","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023320764","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023320779","if(t_max>=t_quantile){","magdalena"
"1471023320779","reject_adjust[k]=alpha[a]*100+(1-alpha[a])*200","magdalena"
"1471023320779","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023320779","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023320795","}","magdalena"
"1471023323711","t_max=max(t_hat_aux)","magdalena"
"1471023323714","k=which(t_hat_aux==t_max)","magdalena"
"1471023323718","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023323725","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023323725","if(t_max>=t_quantile){","magdalena"
"1471023323725","reject_adjust[k]=alpha[a]*100+(1-alpha[a])*200","magdalena"
"1471023323725","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023323741","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023323741","}","magdalena"
"1471023332651","t_max=max(t_hat_aux)","magdalena"
"1471023332651","k=which(t_hat_aux==t_max)","magdalena"
"1471023343228","dim(t_bs_aux)","magdalena"
"1471023348990","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023348990","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023353712","if(t_max>=t_quantile){","magdalena"
"1471023353712","reject_adjust[k]=alpha[a]*100+(1-alpha[a])*200","magdalena"
"1471023353712","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023353712","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023353712","}","magdalena"
"1471023359783","t_max=max(t_hat_aux)","magdalena"
"1471023359783","k=which(t_hat_aux==t_max)","magdalena"
"1471023366256","dim(t_bs_aux)","magdalena"
"1471023371614","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023371630","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023371638","if(t_max>=t_quantile){","magdalena"
"1471023371642","reject_adjust[k]=alpha[a]*100+(1-alpha[a])*200","magdalena"
"1471023371647","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023371651","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023371655","}","magdalena"
"1471023379531","reject_adjust","magdalena"
"1471023389568","alpha[a]*100","magdalena"
"1471023406682","dim(t_bs_aux)","magdalena"
"1471023412196","t_max=max(t_hat_aux)","magdalena"
"1471023412200","k=which(t_hat_aux==t_max)","magdalena"
"1471023412204","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023412215","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023417225","if(t_max>=t_quantile){","magdalena"
"1471023417225","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*200","magdalena"
"1471023417225","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023417225","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023417225","}","magdalena"
"1471023529564","alpha=c(0.95,0.975,0.995)","magdalena"
"1471023529569","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471023529575","reject_adjust=rep(,s)","magdalena"
"1471023529582","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471023529587","t_hat_aux=t_hat","magdalena"
"1471023529591","t_bs_aux=t_bs","magdalena"
"1471023529596","done=F","magdalena"
"1471023529601","while(done==F){","magdalena"
"1471023529601","t_max=max(t_hat_aux)","magdalena"
"1471023529601","k=which(t_hat_aux==t_max)","magdalena"
"1471023529601","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471023529617","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023529617","}","magdalena"
"1471023529617","else(is.null(dim(t_bs_aux))){","magdalena"
"1471023529633","t_bs_max=t_bs_aux","magdalena"
"1471023529633","}","magdalena"
"1471023529633","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023529648","if(t_max>=t_quantile){","magdalena"
"1471023529648","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*200","magdalena"
"1471023529648","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023529648","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023529664","}","magdalena"
"1471023529664","else{","magdalena"
"1471023529664","done=T","magdalena"
"1471023529682","}","magdalena"
"1471023529682","}","magdalena"
"1471023529682","}","magdalena"
"1471023529682","reject_adjust[reject_adjust==]=No","magdalena"
"1471023614987","alpha=c(0.95,0.975,0.995)","magdalena"
"1471023614992","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471023615121","reject_adjust=rep(,s)","magdalena"
"1471023617942","a=1","magdalena"
"1471023622414","t_hat_aux=t_hat","magdalena"
"1471023622414","t_bs_aux=t_bs","magdalena"
"1471023622414","done=F","magdalena"
"1471023636263","t_max=max(t_hat_aux)","magdalena"
"1471023636263","k=which(t_hat_aux==t_max)","magdalena"
"1471023636283","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471023636286","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023636289","}","magdalena"
"1471023636295","else(is.null(dim(t_bs_aux))){","magdalena"
"1471023636295","t_bs_max=t_bs_aux","magdalena"
"1471023636295","}","magdalena"
"1471023636295","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023656439","","magdalena"
"1471023656457","alpha=c(0.95,0.975,0.995)","magdalena"
"1471023656460","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471023656464","reject_adjust=rep(,s)","magdalena"
"1471023656468","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471023656473","t_hat_aux=t_hat","magdalena"
"1471023656475","t_bs_aux=t_bs","magdalena"
"1471023656478","done=F","magdalena"
"1471023656483","while(done==F){","magdalena"
"1471023656487","t_max=max(t_hat_aux)","magdalena"
"1471023656490","k=which(t_hat_aux==t_max)","magdalena"
"1471023656494","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471023656496","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023656500","}","magdalena"
"1471023656501","else{","magdalena"
"1471023656501","t_bs_max=t_bs_aux","magdalena"
"1471023656501","}","magdalena"
"1471023656501","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023656517","if(t_max>=t_quantile){","magdalena"
"1471023656517","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*200","magdalena"
"1471023656517","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023656517","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023656517","}","magdalena"
"1471023656536","else{","magdalena"
"1471023656540","done=T","magdalena"
"1471023656545","}","magdalena"
"1471023656550","}","magdalena"
"1471023656555","}","magdalena"
"1471023656696","reject_adjust[reject_adjust==]=No","magdalena"
"1471023779067","alpha=c(0.95,0.975,0.995)","magdalena"
"1471023779071","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471023779072","reject_adjust=rep(,s)","magdalena"
"1471023779072","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471023779072","t_hat_aux=t_hat","magdalena"
"1471023779072","t_bs_aux=t_bs","magdalena"
"1471023779090","done=F","magdalena"
"1471023779090","while(done==F){","magdalena"
"1471023779090","t_max=max(t_hat_aux)","magdalena"
"1471023779090","k=which(t_hat_aux==t_max)","magdalena"
"1471023779105","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471023779105","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023779105","}","magdalena"
"1471023779105","else{","magdalena"
"1471023779121","t_bs_max=t_bs_aux","magdalena"
"1471023779121","}","magdalena"
"1471023779121","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023779121","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471023779121","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*200","magdalena"
"1471023779137","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023779137","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023779137","}","magdalena"
"1471023779137","else{","magdalena"
"1471023779137","if(t_max>=t_quantile){","magdalena"
"1471023779152","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*200","magdalena"
"1471023779152","}","magdalena"
"1471023779152","done=T","magdalena"
"1471023779152","}","magdalena"
"1471023779152","}","magdalena"
"1471023779168","}","magdalena"
"1471023779408","reject_adjust[reject_adjust==]=No","magdalena"
"1471023790845","reject_adjust","magdalena"
"1471023808832","a","magdalena"
"1471023813488","1-alpha[a]","magdalena"
"1471023820378","(1-alpha[a])*200","magdalena"
"1471023831352","alpha[a]*100","magdalena"
"1471023842876","alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471023846999","a=1","magdalena"
"1471023848880","alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471023854282","a=2","magdalena"
"1471023856022","alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471023897110","alpha=c(0.95,0.975,0.995)","magdalena"
"1471023897128","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471023897130","reject_adjust=rep(,s)","magdalena"
"1471023899740","a=1","magdalena"
"1471023903751","t_hat_aux=t_hat","magdalena"
"1471023903755","t_bs_aux=t_bs","magdalena"
"1471023903756","done=F","magdalena"
"1471023916472","t_max=max(t_hat_aux)","magdalena"
"1471023916472","k=which(t_hat_aux==t_max)","magdalena"
"1471023916472","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471023916472","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471023916488","}","magdalena"
"1471023916488","else{","magdalena"
"1471023916488","t_bs_max=t_bs_aux","magdalena"
"1471023916504","}","magdalena"
"1471023916509","t_quantile=quantile(t_bs_max,alpha[a])","magdalena"
"1471023916515","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471023916519","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471023916523","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471023916526","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471023916529","}","magdalena"
"1471023975784","","magdalena"
"1471023975785","alpha=c(0.95,0.975,0.995)","magdalena"
"1471023975785","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471023975785","reject_adjust=rep(,s)","magdalena"
"1471024020240","help(quantile)","magdalena"
"1471024054972","alpha=c(0.95,0.975,0.995)","magdalena"
"1471024055106","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471024055111","reject_adjust=rep(,s)","magdalena"
"1471024059141","t_hat_aux=t_hat","magdalena"
"1471024059150","t_bs_aux=t_bs","magdalena"
"1471024059153","done=F","magdalena"
"1471024070383","t_max=max(t_hat_aux)","magdalena"
"1471024070383","k=which(t_hat_aux==t_max)","magdalena"
"1471024070383","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471024070383","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471024070383","}","magdalena"
"1471024070399","if(is.null(dim(t_bs_aux))){","magdalena"
"1471024070399","t_bs_max=t_bs_aux","magdalena"
"1471024070399","}","magdalena"
"1471024070418","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471024075878","t_max>=t_quantile & !is.null(dim(t_bs_aux))","magdalena"
"1471024080121","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471024080121","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471024080121","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471024089013","t_max=max(t_hat_aux)","magdalena"
"1471024089013","k=which(t_hat_aux==t_max)","magdalena"
"1471024089028","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471024089028","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471024089028","}","magdalena"
"1471024089044","if(is.null(dim(t_bs_aux))){","magdalena"
"1471024089044","t_bs_max=t_bs_aux","magdalena"
"1471024089044","}","magdalena"
"1471024089044","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471024089060","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471024089060","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471024089060","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471024089075","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471024089075","}","magdalena"
"1471024094941","t_max=max(t_hat_aux)","magdalena"
"1471024094942","k=which(t_hat_aux==t_max)","magdalena"
"1471024094942","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471024094942","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471024094942","}","magdalena"
"1471024094958","if(is.null(dim(t_bs_aux))){","magdalena"
"1471024094958","t_bs_max=t_bs_aux","magdalena"
"1471024094958","}","magdalena"
"1471024094973","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471024094973","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471024094973","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471024094989","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471024094989","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471024094989","}","magdalena"
"1471024098439","t_max=max(t_hat_aux)","magdalena"
"1471024098439","k=which(t_hat_aux==t_max)","magdalena"
"1471024098439","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471024098439","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471024098454","}","magdalena"
"1471024098454","if(is.null(dim(t_bs_aux))){","magdalena"
"1471024098470","t_bs_max=t_bs_aux","magdalena"
"1471024098470","}","magdalena"
"1471024098470","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471024098470","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471024098486","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471024098486","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471024098486","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471024098486","}","magdalena"
"1471024107553","t_max>=t_quantile & !is.null(dim(t_bs_aux))","magdalena"
"1471024113640","t_max=max(t_hat_aux)","magdalena"
"1471024113646","k=which(t_hat_aux==t_max)","magdalena"
"1471024113649","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471024113653","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471024113656","}","magdalena"
"1471024113666","if(is.null(dim(t_bs_aux))){","magdalena"
"1471024113668","t_bs_max=t_bs_aux","magdalena"
"1471024113671","}","magdalena"
"1471024113677","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471024113684","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471024113688","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471024113692","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471024113695","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471024113699","}","magdalena"
"1471024117934","t_max>=t_quantile & !is.null(dim(t_bs_aux))","magdalena"
"1471024119925","t_max=max(t_hat_aux)","magdalena"
"1471024119929","k=which(t_hat_aux==t_max)","magdalena"
"1471024119933","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471024119937","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471024119940","}","magdalena"
"1471024119951","if(is.null(dim(t_bs_aux))){","magdalena"
"1471024119955","t_bs_max=t_bs_aux","magdalena"
"1471024119959","}","magdalena"
"1471024119963","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471024119970","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471024119974","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471024119978","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471024119982","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471024119986","}","magdalena"
"1471024124463","t_max>=t_quantile & !is.null(dim(t_bs_aux))","magdalena"
"1471024126462","t_max=max(t_hat_aux)","magdalena"
"1471024126464","k=which(t_hat_aux==t_max)","magdalena"
"1471024126464","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471024126464","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471024126464","}","magdalena"
"1471024126479","if(is.null(dim(t_bs_aux))){","magdalena"
"1471024126479","t_bs_max=t_bs_aux","magdalena"
"1471024126479","}","magdalena"
"1471024126479","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471024126495","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471024126495","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471024126495","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471024126495","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471024126495","}","magdalena"
"1471024130322","t_max>=t_quantile & !is.null(dim(t_bs_aux))","magdalena"
"1471024132747","t_max=max(t_hat_aux)","magdalena"
"1471024132749","k=which(t_hat_aux==t_max)","magdalena"
"1471024132749","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471024132749","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471024132749","}","magdalena"
"1471024132765","if(is.null(dim(t_bs_aux))){","magdalena"
"1471024132765","t_bs_max=t_bs_aux","magdalena"
"1471024132765","}","magdalena"
"1471024132765","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471024132781","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471024132781","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471024132781","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471024132796","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471024132796","}","magdalena"
"1471024136674","t_max>=t_quantile & !is.null(dim(t_bs_aux))","magdalena"
"1471024138551","t_max=max(t_hat_aux)","magdalena"
"1471024138556","k=which(t_hat_aux==t_max)","magdalena"
"1471024138562","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471024138567","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471024138571","}","magdalena"
"1471024138587","if(is.null(dim(t_bs_aux))){","magdalena"
"1471024138592","t_bs_max=t_bs_aux","magdalena"
"1471024138597","}","magdalena"
"1471024138603","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471024138610","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471024138615","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471024138620","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471024138625","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471024138629","}","magdalena"
"1471024142499","t_max>=t_quantile & !is.null(dim(t_bs_aux))","magdalena"
"1471024150035","t_max>=t_quantile","magdalena"
"1471024163108","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471024163108","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471024163108","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471024163108","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471024163108","}","magdalena"
"1471024163128","else{","magdalena"
"1471024163129","if(t_max>=t_quantile){","magdalena"
"1471024163129","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*200","magdalena"
"1471024163129","}","magdalena"
"1471024163129","done=T","magdalena"
"1471024163129","}","magdalena"
"1471024211367","t_max>=t_quantile & !is.null(dim(t_bs_aux))","magdalena"
"1471024217087","t_max<t_quantile | is.null(dim(t_bs_aux))","magdalena"
"1471024222425","t_max<t_quantile","magdalena"
"1471024227330","t_max>=t_quantile","magdalena"
"1471024259531","","magdalena"
"1471024259576","alpha=c(0.95,0.975,0.995)","magdalena"
"1471024259581","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471024259588","reject_adjust=rep(,s)","magdalena"
"1471024259594","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471024259599","t_hat_aux=t_hat","magdalena"
"1471024259604","t_bs_aux=t_bs","magdalena"
"1471024259608","done=F","magdalena"
"1471024259614","while(done==F){","magdalena"
"1471024259618","t_max=max(t_hat_aux)","magdalena"
"1471024259622","k=which(t_hat_aux==t_max)","magdalena"
"1471024259626","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471024259631","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471024259635","}","magdalena"
"1471024259639","if(is.null(dim(t_bs_aux))){","magdalena"
"1471024259643","t_bs_max=t_bs_aux","magdalena"
"1471024259646","}","magdalena"
"1471024259651","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471024259655","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471024259658","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471024259661","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471024259665","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471024259668","}","magdalena"
"1471024259672","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471024259677","if(t_max>=t_quantile){","magdalena"
"1471024259681","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*200","magdalena"
"1471024259684","}","magdalena"
"1471024259688","done=T","magdalena"
"1471024259691","}","magdalena"
"1471024259695","}","magdalena"
"1471024259698","}","magdalena"
"1471024260268","reject_adjust[reject_adjust==]=No","magdalena"
"1471024268315","reject_adjust","magdalena"
"1471024368922","","magdalena"
"1471024368927","alpha=c(0.95,0.975,0.995)","magdalena"
"1471024368931","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471024368937","reject_adjust=rep(,s)","magdalena"
"1471024368942","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471024368964","t_hat_aux=t_hat","magdalena"
"1471024368967","t_bs_aux=t_bs","magdalena"
"1471024368971","done=F","magdalena"
"1471024368974","while(done==F){","magdalena"
"1471024368977","t_max=max(t_hat_aux)","magdalena"
"1471024368981","k=which(t_hat_aux==t_max)","magdalena"
"1471024368985","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471024368988","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471024368992","}","magdalena"
"1471024368995","if(is.null(dim(t_bs_aux))){","magdalena"
"1471024368998","t_bs_max=t_bs_aux","magdalena"
"1471024369002","}","magdalena"
"1471024369005","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471024369010","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471024369013","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471024369017","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471024369020","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471024369023","}","magdalena"
"1471024369027","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471024369031","if(t_max>=t_quantile){","magdalena"
"1471024369035","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*200","magdalena"
"1471024369038","}","magdalena"
"1471024369042","done=T","magdalena"
"1471024369045","}","magdalena"
"1471024369048","}","magdalena"
"1471024369053","}","magdalena"
"1471024383930","reject_adjust","magdalena"
"1471024400680","alpha=c(0.95,0.975,0.995)","magdalena"
"1471024400680","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471024400680","reject_adjust=rep(,s)","magdalena"
"1471024407387","a=1","magdalena"
"1471024411387","t_hat_aux=t_hat","magdalena"
"1471024411387","t_bs_aux=t_bs","magdalena"
"1471024411387","done=F","magdalena"
"1471024420728","while(done==F){","magdalena"
"1471024420728","t_max=max(t_hat_aux)","magdalena"
"1471024420728","k=which(t_hat_aux==t_max)","magdalena"
"1471024420728","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471024420728","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471024420728","}","magdalena"
"1471024420744","if(is.null(dim(t_bs_aux))){","magdalena"
"1471024420744","t_bs_max=t_bs_aux","magdalena"
"1471024420744","}","magdalena"
"1471024420744","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471024420759","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471024420759","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471024420759","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471024420759","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471024420775","}","magdalena"
"1471024420775","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471024420775","if(t_max>=t_quantile){","magdalena"
"1471024420775","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*200","magdalena"
"1471024420794","}","magdalena"
"1471024420795","done=T","magdalena"
"1471024420795","}","magdalena"
"1471024420795","}","magdalena"
"1471024428759","reject_adjust","magdalena"
"1471024446368","alpha=c(0.95,0.975,0.995)","magdalena"
"1471024446368","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471024446368","reject_adjust=rep(,s)","magdalena"
"1471024448782","a=1","magdalena"
"1471024451695","t_hat_aux=t_hat","magdalena"
"1471024451699","t_bs_aux=t_bs","magdalena"
"1471024451703","done=F","magdalena"
"1471024456809","done==F","magdalena"
"1471024461092","t_max=max(t_hat_aux)","magdalena"
"1471024461095","k=which(t_hat_aux==t_max)","magdalena"
"1471024461100","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471024461102","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471024461102","}","magdalena"
"1471024461102","if(is.null(dim(t_bs_aux))){","magdalena"
"1471024461117","t_bs_max=t_bs_aux","magdalena"
"1471024461117","}","magdalena"
"1471024461117","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471024530872","alpha=c(0.95,0.975,0.995)","magdalena"
"1471024530872","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471024530872","reject_adjust=rep(,s)","magdalena"
"1471024532923","a","magdalena"
"1471024538701","t_hat_aux=t_hat","magdalena"
"1471024538706","t_bs_aux=t_bs","magdalena"
"1471024538711","done=F","magdalena"
"1471024538718","while(done==F){","magdalena"
"1471024538722","t_max=max(t_hat_aux)","magdalena"
"1471024538727","k=which(t_hat_aux==t_max)","magdalena"
"1471024538733","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471024538738","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471024538742","}","magdalena"
"1471024538747","if(is.null(dim(t_bs_aux))){","magdalena"
"1471024538752","t_bs_max=t_bs_aux","magdalena"
"1471024538757","}","magdalena"
"1471024538763","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471024538789","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471024538795","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471024538800","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471024538805","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471024538811","print(k)","magdalena"
"1471024538815","print(reject_adjust)","magdalena"
"1471024538820","}","magdalena"
"1471024538842","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471024538847","if(t_max>=t_quantile){","magdalena"
"1471024538852","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*200","magdalena"
"1471024538858","}","magdalena"
"1471024538863","done=T","magdalena"
"1471024538871","print(Done)","magdalena"
"1471024538877","print(k)","magdalena"
"1471024538882","}","magdalena"
"1471024538888","}","magdalena"
"1471026208931","alpha=c(0.95,0.975,0.995)","magdalena"
"1471026208946","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471026208962","reject_adjust=rep(,s)","magdalena"
"1471026219302","a=1","magdalena"
"1471026223088","t_hat_aux=t_hat","magdalena"
"1471026223088","t_bs_aux=t_bs","magdalena"
"1471026223088","done=F","magdalena"
"1471026227586","t_max=max(t_hat_aux)","magdalena"
"1471026227588","k=which(t_hat_aux==t_max)","magdalena"
"1471026229987","k","magdalena"
"1471026242163","!is.null(dim(t_bs_aux))","magdalena"
"1471026245735","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471026250958","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471026256195","t_max>=t_quantile & !is.null(dim(t_bs_aux))","magdalena"
"1471026269372","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471026269372","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471026269372","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471026269372","print(k)","magdalena"
"1471026269391","print(reject_adjust)","magdalena"
"1471026294034","t_hat","magdalena"
"1471026358976","t_hat_aux","magdalena"
"1471026380239","","magdalena"
"1471026380242","","magdalena"
"1471026380245","","magdalena"
"1471026380249","","magdalena"
"1471026380251","","magdalena"
"1471026380251","","magdalena"
"1471026380251","","magdalena"
"1471026380251","set.seed(100)","magdalena"
"1471026380267","","magdalena"
"1471026380267","n = 1000","magdalena"
"1471026380267","","magdalena"
"1471026380267","s = 10","magdalena"
"1471026380267","","magdalena"
"1471026380283","beta = rep(1,s)","magdalena"
"1471026380283","","magdalena"
"1471026380283","prob=0.5","magdalena"
"1471026380283","treat=rbinom(n,1,prob)","magdalena"
"1471026380298","","magdalena"
"1471026380298","for (i in 1","magdalena"
"s){","","magdalena"
"1471026380298","y=beta[i]*treat+rnorm(n)","magdalena"
"1471026380298","if (i==1){","magdalena"
"1471026380298","y_mat=y","magdalena"
"1471026380314","}","magdalena"
"1471026380314","if (i>1){","magdalena"
"1471026380314","y_mat=cbind(y_mat,y)","magdalena"
"1471026380314","}","magdalena"
"1471026380314","}","magdalena"
"1471026380329","","magdalena"
"1471026380329","beta_hat=rep(NA,s)","magdalena"
"1471026380346","t_hat=rep(NA,s)","magdalena"
"1471026380349","reject_unadjust=rep(,s)","magdalena"
"1471026380352","for (i in 1","magdalena"
"s){","","magdalena"
"1471026380352","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471026380352","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471026380352","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471026380352","reject_unadjust[i]=No","magdalena"
"1471026380367","}","magdalena"
"1471026380367","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471026380367","reject_unadjust[i]=90","magdalena"
"1471026380367","}","magdalena"
"1471026380383","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471026380383","reject_unadjust[i]=95","magdalena"
"1471026380383","}","magdalena"
"1471026380383","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471026380383","reject_unadjust[i]=99","magdalena"
"1471026380399","}","magdalena"
"1471026380399","}","magdalena"
"1471026380939","","magdalena"
"1471026380943","","magdalena"
"1471026380946","B=1000","magdalena"
"1471026380950","beta_bs=matrix(NA,B,s)","magdalena"
"1471026380954","t_bs=matrix(NA,B,s)","magdalena"
"1471026380958","for (i in 1","magdalena"
"B){","","magdalena"
"1471026380961","","magdalena"
"1471026380964","set.seed(i)","magdalena"
"1471026380968","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471026380972","y_mat_bs=y_mat[id,]","magdalena"
"1471026380975","treat_bs=treat[id]","magdalena"
"1471026380979","for (k in 1","magdalena"
"s){","","magdalena"
"1471026380982","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471026380985","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471026380989","}","magdalena"
"1471026380992","}","magdalena"
"1471026533717","","magdalena"
"1471026533722","alpha=c(0.95,0.975,0.995)","magdalena"
"1471026533727","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471026533733","reject_adjust=rep(,s)","magdalena"
"1471026552366","a=","magdalena"
"1471026557547","1","magdalena"
"1471026573230","t_hat_aux=t_hat","magdalena"
"1471026573232","t_bs_aux=t_bs","magdalena"
"1471026573232","done=F","magdalena"
"1471026598994","t_max=max(t_hat_aux)","magdalena"
"1471026598998","k=which(t_hat_aux==t_max)","magdalena"
"1471026600608","k","magdalena"
"1471026619714","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471026644116","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471026669303","t_max>=t_quantile","magdalena"
"1471026675308","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471026675314","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471026675319","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471026675324","print(k)","magdalena"
"1471026675325","print(reject_adjust)","magdalena"
"1471026697068","t_max=max(t_hat_aux)","magdalena"
"1471026697068","k=which(t_hat_aux==t_max)","magdalena"
"1471026697068","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471026697068","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471026697084","}","magdalena"
"1471026697089","if(is.null(dim(t_bs_aux))){","magdalena"
"1471026697105","t_bs_max=t_bs_aux","magdalena"
"1471026697105","}","magdalena"
"1471026697105","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471026697120","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471026697120","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471026697120","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471026697120","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471026697136","print(k)","magdalena"
"1471026697136","print(reject_adjust)","magdalena"
"1471026697136","}","magdalena"
"1471026702771","t_max=max(t_hat_aux)","magdalena"
"1471026702771","k=which(t_hat_aux==t_max)","magdalena"
"1471026702771","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471026702771","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471026702771","}","magdalena"
"1471026702786","if(is.null(dim(t_bs_aux))){","magdalena"
"1471026702786","t_bs_max=t_bs_aux","magdalena"
"1471026702786","}","magdalena"
"1471026702802","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471026702802","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471026702802","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471026702802","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471026702802","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471026702820","print(k)","magdalena"
"1471026702824","print(reject_adjust)","magdalena"
"1471026702829","}","magdalena"
"1471026717727","t_hat","magdalena"
"1471026722588","t_hat_aux","magdalena"
"1471026749214","t_max=max(t_hat_aux)","magdalena"
"1471026749214","k=which(t_hat_aux==t_max)","magdalena"
"1471026752833","k","magdalena"
"1471026759880","!is.null(dim(t_bs_aux))","magdalena"
"1471026766393","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471026776623","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471026782890","t_quantile","magdalena"
"1471026786945","t_max","magdalena"
"1471026840516","","magdalena"
"1471026840521","alpha=c(0.95,0.975,0.995)","magdalena"
"1471026840526","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471026840532","reject_adjust=rep(,s)","magdalena"
"1471026840539","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471026840544","t_hat_aux=t_hat","magdalena"
"1471026840548","t_bs_aux=t_bs","magdalena"
"1471026840553","done=F","magdalena"
"1471026840559","while(done==F){","magdalena"
"1471026840564","t_max=max(t_hat_aux)","magdalena"
"1471026840569","k=which(t_hat_aux==t_max)","magdalena"
"1471026840575","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471026840601","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471026840622","}","magdalena"
"1471026840628","if(is.null(dim(t_bs_aux))){","magdalena"
"1471026840642","t_bs_max=t_bs_aux","magdalena"
"1471026840651","}","magdalena"
"1471026840663","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471026840670","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471026840674","k_orig=which(t_hat==t_max)","magdalena"
"1471026840680","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471026840707","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471026840712","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471026840717","print(k)","magdalena"
"1471026840722","print(reject_adjust)","magdalena"
"1471026840727","}","magdalena"
"1471026840733","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471026840744","if(t_max>=t_quantile){","magdalena"
"1471026840751","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*200","magdalena"
"1471026840757","}","magdalena"
"1471026840764","done=T","magdalena"
"1471026840769","print(Done)","magdalena"
"1471026840774","print(k)","magdalena"
"1471026840779","}","magdalena"
"1471026840784","}","magdalena"
"1471026840790","}","magdalena"
"1471026841287","reject_adjust[reject_adjust==]=No","magdalena"
"1471026849664","reject_adjust","magdalena"
"1471026868005","alpha=c(0.95,0.975,0.995)","magdalena"
"1471026868005","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471026868005","reject_adjust=rep(,s)","magdalena"
"1471026868005","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471026868020","t_hat_aux=t_hat","magdalena"
"1471026868020","t_bs_aux=t_bs","magdalena"
"1471026868020","done=F","magdalena"
"1471026868020","while(done==F){","magdalena"
"1471026868020","t_max=max(t_hat_aux)","magdalena"
"1471026868036","k=which(t_hat_aux==t_max)","magdalena"
"1471026868036","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471026868036","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471026868036","}","magdalena"
"1471026868053","if(is.null(dim(t_bs_aux))){","magdalena"
"1471026868057","t_bs_max=t_bs_aux","magdalena"
"1471026868061","}","magdalena"
"1471026868067","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471026868073","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471026868075","k_orig=which(t_hat==t_max)","magdalena"
"1471026868075","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471026868075","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471026868090","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471026868090","print(k)","magdalena"
"1471026868090","print(reject_adjust)","magdalena"
"1471026868090","}","magdalena"
"1471026868090","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471026868107","if(t_max>=t_quantile){","magdalena"
"1471026868111","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471026868114","}","magdalena"
"1471026868118","done=T","magdalena"
"1471026868121","print(Done)","magdalena"
"1471026868126","print(k)","magdalena"
"1471026868129","}","magdalena"
"1471026868131","}","magdalena"
"1471026868131","}","magdalena"
"1471026868381","reject_adjust[reject_adjust==]=No","magdalena"
"1471026884603","reject_adjust","magdalena"
"1471026935449","","magdalena"
"1471026935453","reject_unadjust","magdalena"
"1471026935459","","magdalena"
"1471026935463","reject_adjust","magdalena"
"1471027003624","","magdalena"
"1471027003628","","magdalena"
"1471027003632","","magdalena"
"1471027003634","","magdalena"
"1471027003634","","magdalena"
"1471027003634","","magdalena"
"1471027003634","","magdalena"
"1471027003649","set.seed(100)","magdalena"
"1471027003649","","magdalena"
"1471027003649","n = 1000","magdalena"
"1471027003649","","magdalena"
"1471027003665","s = 10","magdalena"
"1471027003665","","magdalena"
"1471027003665","","magdalena"
"1471027003665","beta=c(rep(1,round(s/2),0),rep(0,s-round(s/2,0)))","magdalena"
"1471027028422","","magdalena"
"1471027028425","prob=0.5","magdalena"
"1471027028427","treat=rbinom(n,1,prob)","magdalena"
"1471027028427","","magdalena"
"1471027028427","for (i in 1","magdalena"
"s){","","magdalena"
"1471027028427","y=beta[i]*treat+rnorm(n)","magdalena"
"1471027028442","if (i==1){","magdalena"
"1471027028442","y_mat=y","magdalena"
"1471027028442","}","magdalena"
"1471027028442","if (i>1){","magdalena"
"1471027028442","y_mat=cbind(y_mat,y)","magdalena"
"1471027028458","}","magdalena"
"1471027028458","}","magdalena"
"1471027028458","","magdalena"
"1471027028458","beta_hat=rep(NA,s)","magdalena"
"1471027028474","t_hat=rep(NA,s)","magdalena"
"1471027028474","reject_unadjust=rep(,s)","magdalena"
"1471027028474","for (i in 1","magdalena"
"s){","","magdalena"
"1471027028489","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471027028489","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471027028489","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471027028505","reject_unadjust[i]=No","magdalena"
"1471027028505","}","magdalena"
"1471027028505","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471027028521","reject_unadjust[i]=90","magdalena"
"1471027028526","}","magdalena"
"1471027028527","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471027028527","reject_unadjust[i]=95","magdalena"
"1471027028527","}","magdalena"
"1471027028542","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471027028542","reject_unadjust[i]=99","magdalena"
"1471027028542","}","magdalena"
"1471027028558","}","magdalena"
"1471027066604","","magdalena"
"1471027066604","","magdalena"
"1471027066604","","magdalena"
"1471027066604","","magdalena"
"1471027066619","","magdalena"
"1471027066619","","magdalena"
"1471027066619","rm(list = ls())","magdalena"
"1471027066619","","magdalena"
"1471027066635","cat(\014)","magdalena"
"1471027066642","","magdalena"
"1471027066647","","magdalena"
"1471027066650","set.seed(100)","magdalena"
"1471027066654","","magdalena"
"1471027066657","n = 1000","magdalena"
"1471027066657","","magdalena"
"1471027066657","s = 10","magdalena"
"1471027066657","","magdalena"
"1471027066657","","magdalena"
"1471027066673","beta=c(rep(1,round(s/2),0),rep(0,s-round(s/2,0)))","magdalena"
"1471027069779","beta","magdalena"
"1471027096247","beta=c(rep(1,round(s/2,0)),rep(0,s-round(s/2,0)))","magdalena"
"1471027098252","beta","magdalena"
"1471027108559","","magdalena"
"1471027108564","prob=0.5","magdalena"
"1471027108570","treat=rbinom(n,1,prob)","magdalena"
"1471027108577","","magdalena"
"1471027108583","for (i in 1","magdalena"
"s){","","magdalena"
"1471027108587","y=beta[i]*treat+rnorm(n)","magdalena"
"1471027108593","if (i==1){","magdalena"
"1471027108598","y_mat=y","magdalena"
"1471027108603","}","magdalena"
"1471027108607","if (i>1){","magdalena"
"1471027108612","y_mat=cbind(y_mat,y)","magdalena"
"1471027108613","}","magdalena"
"1471027108613","}","magdalena"
"1471027108632","","magdalena"
"1471027108636","beta_hat=rep(NA,s)","magdalena"
"1471027108640","t_hat=rep(NA,s)","magdalena"
"1471027108643","reject_unadjust=rep(,s)","magdalena"
"1471027108643","for (i in 1","magdalena"
"s){","","magdalena"
"1471027108643","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471027108643","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471027108643","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471027108659","reject_unadjust[i]=No","magdalena"
"1471027108659","}","magdalena"
"1471027108674","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471027108674","reject_unadjust[i]=90","magdalena"
"1471027108674","}","magdalena"
"1471027108690","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471027108690","reject_unadjust[i]=95","magdalena"
"1471027108690","}","magdalena"
"1471027108705","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471027108705","reject_unadjust[i]=99","magdalena"
"1471027108705","}","magdalena"
"1471027108705","}","magdalena"
"1471027111974","reject_unadjust","magdalena"
"1471027144850","","magdalena"
"1471027144850","","magdalena"
"1471027144850","B=1000","magdalena"
"1471027144865","beta_bs=matrix(NA,B,s)","magdalena"
"1471027144865","t_bs=matrix(NA,B,s)","magdalena"
"1471027144865","for (i in 1","magdalena"
"B){","","magdalena"
"1471027144865","","magdalena"
"1471027144881","","magdalena"
"1471027144881","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471027144881","y_mat_bs=y_mat[id,]","magdalena"
"1471027144881","treat_bs=treat[id]","magdalena"
"1471027144881","for (k in 1","magdalena"
"s){","","magdalena"
"1471027144899","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471027144902","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471027144902","}","magdalena"
"1471027144902","}","magdalena"
"1471027320207","","magdalena"
"1471027320211","alpha=c(0.95,0.975,0.995)","magdalena"
"1471027320214","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471027320219","reject_adjust=rep(,s)","magdalena"
"1471027320223","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471027320227","t_hat_aux=t_hat","magdalena"
"1471027320229","t_bs_aux=t_bs","magdalena"
"1471027320232","done=F","magdalena"
"1471027320235","while(done==F){","magdalena"
"1471027320238","t_max=max(t_hat_aux)","magdalena"
"1471027320241","k=which(t_hat_aux==t_max)","magdalena"
"1471027320244","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471027320247","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471027320251","}","magdalena"
"1471027320254","if(is.null(dim(t_bs_aux))){","magdalena"
"1471027320257","t_bs_max=t_bs_aux","magdalena"
"1471027320260","}","magdalena"
"1471027320265","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471027320269","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471027320272","k_orig=which(t_hat==t_max)","magdalena"
"1471027320276","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471027320279","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471027320282","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471027320286","}","magdalena"
"1471027320290","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471027320294","if(t_max>=t_quantile){","magdalena"
"1471027320297","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471027320300","}","magdalena"
"1471027320305","done=T","magdalena"
"1471027320310","}","magdalena"
"1471027320315","}","magdalena"
"1471027320320","}","magdalena"
"1471027320447","reject_adjust[reject_adjust==]=No","magdalena"
"1471027320453","","magdalena"
"1471027320456","reject_unadjust","magdalena"
"1471027320463","","magdalena"
"1471027320467","reject_adjust","magdalena"
"1471027567251","","magdalena"
"1471027567251","","magdalena"
"1471027567251","","magdalena"
"1471027567251","","magdalena"
"1471027567251","","magdalena"
"1471027567251","","magdalena"
"1471027567267","rm(list = ls())","magdalena"
"1471027567267","","magdalena"
"1471027567267","cat(\014)","magdalena"
"1471027567267","","magdalena"
"1471027567282","","magdalena"
"1471027567282","set.seed(100)","magdalena"
"1471027567282","","magdalena"
"1471027567282","n = 1000","magdalena"
"1471027567298","","magdalena"
"1471027567298","s = 10","magdalena"
"1471027567298","","magdalena"
"1471027567298","beta = rep(1,s)","magdalena"
"1471027567298","","magdalena"
"1471027567298","","magdalena"
"1471027567314","prob=0.3","magdalena"
"1471027567314","treat=rbinom(n,1,prob)","magdalena"
"1471027567314","","magdalena"
"1471027567314","for (i in 1","magdalena"
"s){","","magdalena"
"1471027567331","y=beta[i]*treat+rnorm(n)","magdalena"
"1471027567335","if (i==1){","magdalena"
"1471027567339","y_mat=y","magdalena"
"1471027567339","}","magdalena"
"1471027567339","if (i>1){","magdalena"
"1471027567339","y_mat=cbind(y_mat,y)","magdalena"
"1471027567339","}","magdalena"
"1471027567339","}","magdalena"
"1471027567354","","magdalena"
"1471027567370","beta_hat=rep(NA,s)","magdalena"
"1471027567370","t_hat=rep(NA,s)","magdalena"
"1471027567370","reject_unadjust=rep(,s)","magdalena"
"1471027567370","for (i in 1","magdalena"
"s){","","magdalena"
"1471027567386","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471027567389","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471027567393","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471027567395","reject_unadjust[i]=No","magdalena"
"1471027567398","}","magdalena"
"1471027567402","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471027567406","reject_unadjust[i]=90","magdalena"
"1471027567410","}","magdalena"
"1471027567416","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471027567416","reject_unadjust[i]=95","magdalena"
"1471027567416","}","magdalena"
"1471027567416","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471027567435","reject_unadjust[i]=99","magdalena"
"1471027567438","}","magdalena"
"1471027567442","}","magdalena"
"1471027567978","","magdalena"
"1471027567981","","magdalena"
"1471027567984","B=1000","magdalena"
"1471027567988","beta_bs=matrix(NA,B,s)","magdalena"
"1471027567992","t_bs=matrix(NA,B,s)","magdalena"
"1471027567998","for (i in 1","magdalena"
"B){","","magdalena"
"1471027568002","","magdalena"
"1471027568006","","magdalena"
"1471027568012","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471027568018","y_mat_bs=y_mat[id,]","magdalena"
"1471027568021","treat_bs=treat[id]","magdalena"
"1471027568025","for (k in 1","magdalena"
"s){","","magdalena"
"1471027568028","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471027568032","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471027568035","}","magdalena"
"1471027568038","}","magdalena"
"1471027753018","","magdalena"
"1471027753033","alpha=c(0.95,0.975,0.995)","magdalena"
"1471027753033","t_quantiles=matrix(NA,length(alpha),s)","magdalena"
"1471027753033","reject_adjust=rep(,s)","magdalena"
"1471027753033","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471027753033","t_hat_aux=t_hat","magdalena"
"1471027753049","t_bs_aux=t_bs","magdalena"
"1471027753049","done=F","magdalena"
"1471027753049","while(done==F){","magdalena"
"1471027753049","t_max=max(t_hat_aux)","magdalena"
"1471027753049","k=which(t_hat_aux==t_max)","magdalena"
"1471027753065","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471027753065","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471027753065","}","magdalena"
"1471027753065","if(is.null(dim(t_bs_aux))){","magdalena"
"1471027753080","t_bs_max=t_bs_aux","magdalena"
"1471027753080","}","magdalena"
"1471027753080","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471027753096","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471027753096","k_orig=which(t_hat==t_max)","magdalena"
"1471027753096","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471027753096","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471027753096","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471027753114","}","magdalena"
"1471027753118","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471027753118","if(t_max>=t_quantile){","magdalena"
"1471027753118","reject_adjust[k]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471027753118","}","magdalena"
"1471027753118","done=T","magdalena"
"1471027753134","}","magdalena"
"1471027753134","}","magdalena"
"1471027753134","}","magdalena"
"1471027753362","reject_adjust[reject_adjust==]=No","magdalena"
"1471027753368","","magdalena"
"1471027753372","reject_unadjust","magdalena"
"1471027753378","","magdalena"
"1471027753381","reject_adjust","magdalena"
"1471027815076","i=2","magdalena"
"1471027822284","lm(y_mat[,i]~treat)","magdalena"
"1471027849221","summary(lm(y_mat[,i]~treat))","magdalena"
"1471027896945","alpha=c(0.95,0.975,0.995)","magdalena"
"1471027896950","","magdalena"
"1471027896953","reject_adjust=rep(,s)","magdalena"
"1471027904652","reject_unadjust","magdalena"
"1471027910261","a=1","magdalena"
"1471027916917","t_hat_aux=t_hat","magdalena"
"1471027916921","t_bs_aux=t_bs","magdalena"
"1471027916925","done=F","magdalena"
"1471027935049","rank(t_hat)","magdalena"
"1471027944148","t_hat","magdalena"
"1471028021126","t_max=max(t_hat_aux)","magdalena"
"1471028021130","k=which(t_hat_aux==t_max)","magdalena"
"1471028021130","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028021130","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028021130","}","magdalena"
"1471028021145","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028021145","t_bs_max=t_bs_aux","magdalena"
"1471028021161","}","magdalena"
"1471028021161","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028021161","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028021177","k_orig=which(t_hat==t_max)","magdalena"
"1471028021177","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028021177","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028021177","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028021192","print(k_orig)","magdalena"
"1471028021192","}","magdalena"
"1471028023028","t_max=max(t_hat_aux)","magdalena"
"1471028023028","k=which(t_hat_aux==t_max)","magdalena"
"1471028023028","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028023028","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028023043","}","magdalena"
"1471028023043","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028023043","t_bs_max=t_bs_aux","magdalena"
"1471028023059","}","magdalena"
"1471028023059","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028023059","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028023059","k_orig=which(t_hat==t_max)","magdalena"
"1471028023077","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028023082","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028023086","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028023090","print(k_orig)","magdalena"
"1471028023094","}","magdalena"
"1471028024432","t_max=max(t_hat_aux)","magdalena"
"1471028024437","k=which(t_hat_aux==t_max)","magdalena"
"1471028024441","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028024444","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028024446","}","magdalena"
"1471028024457","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028024461","t_bs_max=t_bs_aux","magdalena"
"1471028024466","}","magdalena"
"1471028024472","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028024479","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028024484","k_orig=which(t_hat==t_max)","magdalena"
"1471028024488","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028024492","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028024497","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028024502","print(k_orig)","magdalena"
"1471028024507","}","magdalena"
"1471028025862","t_max=max(t_hat_aux)","magdalena"
"1471028025862","k=which(t_hat_aux==t_max)","magdalena"
"1471028025862","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028025878","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028025882","}","magdalena"
"1471028025893","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028025898","t_bs_max=t_bs_aux","magdalena"
"1471028025902","}","magdalena"
"1471028025907","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028025907","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028025907","k_orig=which(t_hat==t_max)","magdalena"
"1471028025922","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028025922","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028025922","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028025922","print(k_orig)","magdalena"
"1471028025941","}","magdalena"
"1471028027321","t_max=max(t_hat_aux)","magdalena"
"1471028027324","k=which(t_hat_aux==t_max)","magdalena"
"1471028027324","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028027324","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028027324","}","magdalena"
"1471028027340","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028027340","t_bs_max=t_bs_aux","magdalena"
"1471028027340","}","magdalena"
"1471028027340","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028027362","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028027365","k_orig=which(t_hat==t_max)","magdalena"
"1471028027365","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028027365","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028027365","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028027381","print(k_orig)","magdalena"
"1471028027381","}","magdalena"
"1471028028755","t_max=max(t_hat_aux)","magdalena"
"1471028028759","k=which(t_hat_aux==t_max)","magdalena"
"1471028028764","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028028767","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028028770","}","magdalena"
"1471028028777","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028028777","t_bs_max=t_bs_aux","magdalena"
"1471028028777","}","magdalena"
"1471028028777","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028028792","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028028792","k_orig=which(t_hat==t_max)","magdalena"
"1471028028792","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028028792","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028028792","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028028810","print(k_orig)","magdalena"
"1471028028814","}","magdalena"
"1471028030250","t_max=max(t_hat_aux)","magdalena"
"1471028030250","k=which(t_hat_aux==t_max)","magdalena"
"1471028030250","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028030250","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028030265","}","magdalena"
"1471028030265","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028030265","t_bs_max=t_bs_aux","magdalena"
"1471028030281","}","magdalena"
"1471028030281","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028030281","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028030281","k_orig=which(t_hat==t_max)","magdalena"
"1471028030297","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028030297","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028030297","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028030297","print(k_orig)","magdalena"
"1471028030297","}","magdalena"
"1471028032219","t_max=max(t_hat_aux)","magdalena"
"1471028032219","k=which(t_hat_aux==t_max)","magdalena"
"1471028032219","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028032219","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028032234","}","magdalena"
"1471028032234","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028032234","t_bs_max=t_bs_aux","magdalena"
"1471028032234","}","magdalena"
"1471028032250","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028032250","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028032266","k_orig=which(t_hat==t_max)","magdalena"
"1471028032266","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028032266","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028032266","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028032281","print(k_orig)","magdalena"
"1471028032281","}","magdalena"
"1471028051500","t_max=max(t_hat_aux)","magdalena"
"1471028051505","k=which(t_hat_aux==t_max)","magdalena"
"1471028053218","k","magdalena"
"1471028055182","t_max","magdalena"
"1471028063730","!is.null(dim(t_bs_aux))","magdalena"
"1471028067634","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028074340","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028080049","t_quantile","magdalena"
"1471028091985","t_max>=t_quantile & !is.null(dim(t_bs_aux))","magdalena"
"1471028095959","k_orig=which(t_hat==t_max)","magdalena"
"1471028095959","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028095959","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028095959","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028095959","print(k_orig)","magdalena"
"1471028197569","is.null(dim(t_bs_aux))","magdalena"
"1471028203324","t_bs_max=t_bs_aux","magdalena"
"1471028207381","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028246531","","magdalena"
"1471028246531","alpha=c(0.95,0.975,0.995)","magdalena"
"1471028246531","","magdalena"
"1471028246531","reject_adjust=rep(,s)","magdalena"
"1471028246546","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471028246546","t_hat_aux=t_hat","magdalena"
"1471028246546","t_bs_aux=t_bs","magdalena"
"1471028246546","done=F","magdalena"
"1471028246562","while(done==F){","magdalena"
"1471028246562","t_max=max(t_hat_aux)","magdalena"
"1471028246562","k=which(t_hat_aux==t_max)","magdalena"
"1471028246562","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028246562","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028246578","}","magdalena"
"1471028246578","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028246578","t_bs_max=t_bs_aux","magdalena"
"1471028246578","}","magdalena"
"1471028246578","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028246593","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028246593","k_orig=which(t_hat==t_max)","magdalena"
"1471028246593","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028246593","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028246609","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028246609","print(k_orig)","magdalena"
"1471028246609","}","magdalena"
"1471028246609","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028246627","t_bs_max=t_bs_aux","magdalena"
"1471028246631","}","magdalena"
"1471028246631","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028246631","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471028246631","if(t_max>=t_quantile){","magdalena"
"1471028246647","k_orig=which(t_hat==t_max)","magdalena"
"1471028246647","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028246647","}","magdalena"
"1471028246647","done=T","magdalena"
"1471028246662","}","magdalena"
"1471028246662","}","magdalena"
"1471028246662","}","magdalena"
"1471028246937","reject_adjust[reject_adjust==]=No","magdalena"
"1471028246953","","magdalena"
"1471028246953","reject_unadjust","magdalena"
"1471028246953","","magdalena"
"1471028246953","reject_adjust","magdalena"
"1471028290893","t_max=max(t_hat_aux)","magdalena"
"1471028290898","k=which(t_hat_aux==t_max)","magdalena"
"1471028290904","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028290908","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028290912","}","magdalena"
"1471028290914","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028290914","t_bs_max=t_bs_aux","magdalena"
"1471028290914","}","magdalena"
"1471028290914","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028290929","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028290929","k_orig=which(t_hat==t_max)","magdalena"
"1471028290929","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028290945","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028290945","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028290945","print(k_orig)","magdalena"
"1471028290961","}","magdalena"
"1471028300887","","magdalena"
"1471028300887","alpha=c(0.95,0.975,0.995)","magdalena"
"1471028300887","","magdalena"
"1471028300887","reject_adjust=rep(,s)","magdalena"
"1471028303575","a=1","magdalena"
"1471028310821","t_max=max(t_hat_aux)","magdalena"
"1471028310822","k=which(t_hat_aux==t_max)","magdalena"
"1471028310822","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028310822","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028310838","}","magdalena"
"1471028310838","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028310838","t_bs_max=t_bs_aux","magdalena"
"1471028310838","}","magdalena"
"1471028310853","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028310853","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028310869","k_orig=which(t_hat==t_max)","magdalena"
"1471028310869","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028310869","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028310869","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028310869","print(k_orig)","magdalena"
"1471028310887","}","magdalena"
"1471028321108","alpha=c(0.95,0.975,0.995)","magdalena"
"1471028321108","","magdalena"
"1471028321108","reject_adjust=rep(,s)","magdalena"
"1471028324670","t_hat_aux=t_hat","magdalena"
"1471028324675","t_bs_aux=t_bs","magdalena"
"1471028324680","done=F","magdalena"
"1471028332317","t_max=max(t_hat_aux)","magdalena"
"1471028332319","k=which(t_hat_aux==t_max)","magdalena"
"1471028332319","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028332319","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028332319","}","magdalena"
"1471028332335","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028332335","t_bs_max=t_bs_aux","magdalena"
"1471028332335","}","magdalena"
"1471028332350","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028332350","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028332350","k_orig=which(t_hat==t_max)","magdalena"
"1471028332350","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028332366","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028332370","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028332370","print(k_orig)","magdalena"
"1471028332370","}","magdalena"
"1471028337402","t_max=max(t_hat_aux)","magdalena"
"1471028337418","k=which(t_hat_aux==t_max)","magdalena"
"1471028337418","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028337418","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028337418","}","magdalena"
"1471028337434","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028337434","t_bs_max=t_bs_aux","magdalena"
"1471028337434","}","magdalena"
"1471028337434","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028337453","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028337458","k_orig=which(t_hat==t_max)","magdalena"
"1471028337462","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028337466","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028337472","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028337476","print(k_orig)","magdalena"
"1471028337481","}","magdalena"
"1471028338827","t_max=max(t_hat_aux)","magdalena"
"1471028338827","k=which(t_hat_aux==t_max)","magdalena"
"1471028338827","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028338827","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028338843","}","magdalena"
"1471028338853","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028338856","t_bs_max=t_bs_aux","magdalena"
"1471028338859","}","magdalena"
"1471028338859","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028338859","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028338859","k_orig=which(t_hat==t_max)","magdalena"
"1471028338876","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028338879","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028338883","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028338885","print(k_orig)","magdalena"
"1471028338885","}","magdalena"
"1471028340662","t_max=max(t_hat_aux)","magdalena"
"1471028340697","k=which(t_hat_aux==t_max)","magdalena"
"1471028340697","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028340697","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028340712","}","magdalena"
"1471028340712","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028340728","t_bs_max=t_bs_aux","magdalena"
"1471028340728","}","magdalena"
"1471028340728","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028340728","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028340747","k_orig=which(t_hat==t_max)","magdalena"
"1471028340751","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028340754","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028340754","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028340754","print(k_orig)","magdalena"
"1471028340754","}","magdalena"
"1471028342389","t_max=max(t_hat_aux)","magdalena"
"1471028342389","k=which(t_hat_aux==t_max)","magdalena"
"1471028342389","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028342389","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028342389","}","magdalena"
"1471028342405","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028342405","t_bs_max=t_bs_aux","magdalena"
"1471028342405","}","magdalena"
"1471028342420","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028342420","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028342436","k_orig=which(t_hat==t_max)","magdalena"
"1471028342436","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028342436","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028342436","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028342453","print(k_orig)","magdalena"
"1471028342458","}","magdalena"
"1471028345717","t_max=max(t_hat_aux)","magdalena"
"1471028345723","k=which(t_hat_aux==t_max)","magdalena"
"1471028345728","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028345731","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028345734","}","magdalena"
"1471028345734","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028345734","t_bs_max=t_bs_aux","magdalena"
"1471028345734","}","magdalena"
"1471028345750","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028345760","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028345760","k_orig=which(t_hat==t_max)","magdalena"
"1471028345760","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028345760","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028345760","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028345777","print(k_orig)","magdalena"
"1471028345780","}","magdalena"
"1471028346886","t_max=max(t_hat_aux)","magdalena"
"1471028346886","k=which(t_hat_aux==t_max)","magdalena"
"1471028346902","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028346902","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028346902","}","magdalena"
"1471028346917","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028346917","t_bs_max=t_bs_aux","magdalena"
"1471028346917","}","magdalena"
"1471028346917","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028346933","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028346933","k_orig=which(t_hat==t_max)","magdalena"
"1471028346933","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028346933","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028346948","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028346948","print(k_orig)","magdalena"
"1471028346948","}","magdalena"
"1471028348316","t_max=max(t_hat_aux)","magdalena"
"1471028348316","k=which(t_hat_aux==t_max)","magdalena"
"1471028348316","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028348316","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028348332","}","magdalena"
"1471028348338","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028348338","t_bs_max=t_bs_aux","magdalena"
"1471028348338","}","magdalena"
"1471028348338","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028348353","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028348353","k_orig=which(t_hat==t_max)","magdalena"
"1471028348353","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028348353","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028348369","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028348369","print(k_orig)","magdalena"
"1471028348369","}","magdalena"
"1471028358948","t_max=max(t_hat_aux)","magdalena"
"1471028358949","k=which(t_hat_aux==t_max)","magdalena"
"1471028358949","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028358949","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028358949","}","magdalena"
"1471028358969","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028358969","t_bs_max=t_bs_aux","magdalena"
"1471028358969","}","magdalena"
"1471028358985","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028358985","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028358985","k_orig=which(t_hat==t_max)","magdalena"
"1471028359000","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028359000","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028359000","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028359000","print(k_orig)","magdalena"
"1471028359016","}","magdalena"
"1471028368090","is.null(dim(t_bs_aux))","magdalena"
"1471028372284","t_bs_max=t_bs_aux","magdalena"
"1471028378589","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028389592","t_max<t_quantile | is.null(dim(t_bs_aux))","magdalena"
"1471028409447","t_max=max(t_hat_aux)","magdalena"
"1471028422484","t_max>=t_quantile","magdalena"
"1471028428810","k_orig=which(t_hat==t_max)","magdalena"
"1471028435025","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028445432","reject_adjust","magdalena"
"1471028457133","","magdalena"
"1471028457133","alpha=c(0.95,0.975,0.995)","magdalena"
"1471028457133","","magdalena"
"1471028457133","reject_adjust=rep(,s)","magdalena"
"1471028457148","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471028457148","t_hat_aux=t_hat","magdalena"
"1471028457148","t_bs_aux=t_bs","magdalena"
"1471028457148","done=F","magdalena"
"1471028457164","while(done==F){","magdalena"
"1471028457164","t_max=max(t_hat_aux)","magdalena"
"1471028457164","k=which(t_hat_aux==t_max)","magdalena"
"1471028457164","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028457180","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028457180","}","magdalena"
"1471028457180","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028457180","t_bs_max=t_bs_aux","magdalena"
"1471028457180","}","magdalena"
"1471028457201","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028457205","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028457205","k_orig=which(t_hat==t_max)","magdalena"
"1471028457205","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028457205","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028457205","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028457220","print(k_orig)","magdalena"
"1471028457220","}","magdalena"
"1471028457220","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028457236","t_bs_max=t_bs_aux","magdalena"
"1471028457236","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028457236","t_max=max(t_hat_aux)","magdalena"
"1471028457236","}","magdalena"
"1471028457253","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471028457258","if(t_max>=t_quantile){","magdalena"
"1471028457262","k_orig=which(t_hat==t_max)","magdalena"
"1471028457267","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028457272","}","magdalena"
"1471028457277","done=T","magdalena"
"1471028457282","}","magdalena"
"1471028457287","}","magdalena"
"1471028457292","}","magdalena"
"1471028457626","reject_adjust[reject_adjust==]=No","magdalena"
"1471028457632","","magdalena"
"1471028457637","reject_unadjust","magdalena"
"1471028457642","","magdalena"
"1471028457645","reject_adjust","magdalena"
"1471028490189","","magdalena"
"1471028490193","","magdalena"
"1471028490195","","magdalena"
"1471028490199","","magdalena"
"1471028490202","","magdalena"
"1471028490205","","magdalena"
"1471028490205","rm(list = ls())","magdalena"
"1471028490205","","magdalena"
"1471028490205","cat(\014)","magdalena"
"1471028490221","","magdalena"
"1471028490221","","magdalena"
"1471028490221","","magdalena"
"1471028490221","","magdalena"
"1471028490237","n = 1000","magdalena"
"1471028490237","","magdalena"
"1471028490237","s = 10","magdalena"
"1471028490237","","magdalena"
"1471028490237","","magdalena"
"1471028490252","beta=c(rep(1,round(s/2,0)),rep(0,s-round(s/2,0)))","magdalena"
"1471028490252","","magdalena"
"1471028490252","prob=0.3","magdalena"
"1471028490252","treat=rbinom(n,1,prob)","magdalena"
"1471028490268","","magdalena"
"1471028490268","for (i in 1","magdalena"
"s){","","magdalena"
"1471028490268","y=beta[i]*treat+rnorm(n)","magdalena"
"1471028490268","if (i==1){","magdalena"
"1471028490285","y_mat=y","magdalena"
"1471028490288","}","magdalena"
"1471028490292","if (i>1){","magdalena"
"1471028490296","y_mat=cbind(y_mat,y)","magdalena"
"1471028490300","}","magdalena"
"1471028490305","}","magdalena"
"1471028490314","","magdalena"
"1471028490318","beta_hat=rep(NA,s)","magdalena"
"1471028490322","t_hat=rep(NA,s)","magdalena"
"1471028490325","reject_unadjust=rep(,s)","magdalena"
"1471028490329","for (i in 1","magdalena"
"s){","","magdalena"
"1471028490332","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471028490335","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471028490339","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471028490343","reject_unadjust[i]=No","magdalena"
"1471028490346","}","magdalena"
"1471028490350","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471028490350","reject_unadjust[i]=90","magdalena"
"1471028490350","}","magdalena"
"1471028490350","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471028490350","reject_unadjust[i]=95","magdalena"
"1471028490366","}","magdalena"
"1471028490366","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471028490366","reject_unadjust[i]=99","magdalena"
"1471028490366","}","magdalena"
"1471028490381","}","magdalena"
"1471028491144","","magdalena"
"1471028491144","","magdalena"
"1471028491160","B=1000","magdalena"
"1471028491165","beta_bs=matrix(NA,B,s)","magdalena"
"1471028491166","t_bs=matrix(NA,B,s)","magdalena"
"1471028491166","for (i in 1","magdalena"
"B){","","magdalena"
"1471028491166","","magdalena"
"1471028491166","","magdalena"
"1471028491182","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471028491182","y_mat_bs=y_mat[id,]","magdalena"
"1471028491182","treat_bs=treat[id]","magdalena"
"1471028491182","for (k in 1","magdalena"
"s){","","magdalena"
"1471028491197","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471028491212","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471028491217","}","magdalena"
"1471028491223","}","magdalena"
"1471028675011","","magdalena"
"1471028675015","alpha=c(0.95,0.975,0.995)","magdalena"
"1471028675019","","magdalena"
"1471028675024","reject_adjust=rep(,s)","magdalena"
"1471028675029","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471028675034","t_hat_aux=t_hat","magdalena"
"1471028675037","t_bs_aux=t_bs","magdalena"
"1471028675040","done=F","magdalena"
"1471028675044","while(done==F){","magdalena"
"1471028675047","t_max=max(t_hat_aux)","magdalena"
"1471028675051","k=which(t_hat_aux==t_max)","magdalena"
"1471028675055","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028675058","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028675061","}","magdalena"
"1471028675065","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028675068","t_bs_max=t_bs_aux","magdalena"
"1471028675071","}","magdalena"
"1471028675075","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028675080","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028675083","k_orig=which(t_hat==t_max)","magdalena"
"1471028675086","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028675090","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028675093","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028675097","print(k_orig)","magdalena"
"1471028675100","}","magdalena"
"1471028675105","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028675109","t_bs_max=t_bs_aux","magdalena"
"1471028675114","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028675119","t_max=max(t_hat_aux)","magdalena"
"1471028675124","}","magdalena"
"1471028675130","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471028675135","if(t_max>=t_quantile){","magdalena"
"1471028675140","k_orig=which(t_hat==t_max)","magdalena"
"1471028675145","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028675150","}","magdalena"
"1471028675155","done=T","magdalena"
"1471028675159","}","magdalena"
"1471028675159","}","magdalena"
"1471028675159","}","magdalena"
"1471028675517","reject_adjust[reject_adjust==]=No","magdalena"
"1471028675522","","magdalena"
"1471028675525","reject_unadjust","magdalena"
"1471028675531","","magdalena"
"1471028675534","reject_adjust","magdalena"
"1471028762662","","magdalena"
"1471028762668","","magdalena"
"1471028762671","","magdalena"
"1471028762674","","magdalena"
"1471028762677","","magdalena"
"1471028762680","","magdalena"
"1471028762683","rm(list = ls())","magdalena"
"1471028762685","","magdalena"
"1471028762685","cat(\014)","magdalena"
"1471028762685","","magdalena"
"1471028762685","","magdalena"
"1471028762701","","magdalena"
"1471028762701","","magdalena"
"1471028762701","n = 1000","magdalena"
"1471028762716","","magdalena"
"1471028762716","s = 10","magdalena"
"1471028762716","","magdalena"
"1471028762716","","magdalena"
"1471028762736","beta=c(rep(1,round(s/2,0)),rep(0,s-round(s/2,0)))","magdalena"
"1471028762739","","magdalena"
"1471028762739","prob=0.3","magdalena"
"1471028762739","treat=rbinom(n,1,prob)","magdalena"
"1471028762739","","magdalena"
"1471028762754","for (i in 1","magdalena"
"s){","","magdalena"
"1471028762754","y=beta[i]*treat+rnorm(n)","magdalena"
"1471028762754","if (i==1){","magdalena"
"1471028762754","y_mat=y","magdalena"
"1471028762754","}","magdalena"
"1471028762770","if (i>1){","magdalena"
"1471028762770","y_mat=cbind(y_mat,y)","magdalena"
"1471028762785","}","magdalena"
"1471028762785","}","magdalena"
"1471028762804","","magdalena"
"1471028762808","beta_hat=rep(NA,s)","magdalena"
"1471028762811","t_hat=rep(NA,s)","magdalena"
"1471028762815","reject_unadjust=rep(,s)","magdalena"
"1471028762820","for (i in 1","magdalena"
"s){","","magdalena"
"1471028762825","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471028762828","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471028762833","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471028762837","reject_unadjust[i]=No","magdalena"
"1471028762839","}","magdalena"
"1471028762839","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471028762839","reject_unadjust[i]=90","magdalena"
"1471028762855","}","magdalena"
"1471028762855","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471028762855","reject_unadjust[i]=95","magdalena"
"1471028762855","}","magdalena"
"1471028762870","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471028762870","reject_unadjust[i]=99","magdalena"
"1471028762870","}","magdalena"
"1471028762870","}","magdalena"
"1471028763432","","magdalena"
"1471028763436","","magdalena"
"1471028763439","B=1000","magdalena"
"1471028763440","beta_bs=matrix(NA,B,s)","magdalena"
"1471028763440","t_bs=matrix(NA,B,s)","magdalena"
"1471028763440","for (i in 1","magdalena"
"B){","","magdalena"
"1471028763440","","magdalena"
"1471028763456","","magdalena"
"1471028763456","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471028763471","y_mat_bs=y_mat[id,]","magdalena"
"1471028763471","treat_bs=treat[id]","magdalena"
"1471028763471","for (k in 1","magdalena"
"s){","","magdalena"
"1471028763487","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471028763487","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471028763487","}","magdalena"
"1471028763502","}","magdalena"
"1471028935878","","magdalena"
"1471028935881","alpha=c(0.95,0.975,0.995)","magdalena"
"1471028935885","","magdalena"
"1471028935889","reject_adjust=rep(,s)","magdalena"
"1471028935893","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471028935894","t_hat_aux=t_hat","magdalena"
"1471028935894","t_bs_aux=t_bs","magdalena"
"1471028935894","done=F","magdalena"
"1471028935894","while(done==F){","magdalena"
"1471028935894","t_max=max(t_hat_aux)","magdalena"
"1471028935911","k=which(t_hat_aux==t_max)","magdalena"
"1471028935915","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471028935919","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471028935923","}","magdalena"
"1471028935927","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028935928","t_bs_max=t_bs_aux","magdalena"
"1471028935928","}","magdalena"
"1471028935928","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028935944","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471028935944","k_orig=which(t_hat==t_max)","magdalena"
"1471028935944","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028935944","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471028935959","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471028935959","print(k_orig)","magdalena"
"1471028935959","}","magdalena"
"1471028935959","if(is.null(dim(t_bs_aux))){","magdalena"
"1471028935959","t_bs_max=t_bs_aux","magdalena"
"1471028935976","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471028935976","t_max=max(t_hat_aux)","magdalena"
"1471028935976","}","magdalena"
"1471028935976","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471028935976","if(t_max>=t_quantile){","magdalena"
"1471028935995","k_orig=which(t_hat==t_max)","magdalena"
"1471028936000","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471028936003","}","magdalena"
"1471028936003","done=T","magdalena"
"1471028936003","}","magdalena"
"1471028936003","}","magdalena"
"1471028936003","}","magdalena"
"1471028936154","reject_adjust[reject_adjust==]=No","magdalena"
"1471028936154","","magdalena"
"1471028936154","reject_unadjust","magdalena"
"1471028936170","","magdalena"
"1471028936174","reject_adjust","magdalena"
"1471029201265","","magdalena"
"1471029201267","","magdalena"
"1471029201267","","magdalena"
"1471029201267","","magdalena"
"1471029201267","","magdalena"
"1471029201267","","magdalena"
"1471029201267","rm(list = ls())","magdalena"
"1471029201283","","magdalena"
"1471029201283","cat(\014)","magdalena"
"1471029201283","","magdalena"
"1471029201283","","magdalena"
"1471029201298","","magdalena"
"1471029201298","","magdalena"
"1471029201298","n = 1000","magdalena"
"1471029201314","","magdalena"
"1471029201314","s = 10","magdalena"
"1471029201314","","magdalena"
"1471029201314","","magdalena"
"1471029201314","beta=c(rep(1,round(s/2,0)),rep(0,s-round(s/2,0)))","magdalena"
"1471029201333","","magdalena"
"1471029201338","prob=0.3","magdalena"
"1471029201343","treat=rbinom(n,1,prob)","magdalena"
"1471029201349","","magdalena"
"1471029201355","for (i in 1","magdalena"
"s){","","magdalena"
"1471029201358","y=beta[i]*treat+rnorm(n)","magdalena"
"1471029201362","if (i==1){","magdalena"
"1471029201366","y_mat=y","magdalena"
"1471029201368","}","magdalena"
"1471029201371","if (i>1){","magdalena"
"1471029201374","y_mat=cbind(y_mat,y)","magdalena"
"1471029201377","}","magdalena"
"1471029201381","}","magdalena"
"1471029201390","","magdalena"
"1471029201393","beta_hat=rep(NA,s)","magdalena"
"1471029201397","t_hat=rep(NA,s)","magdalena"
"1471029201400","reject_unadjust=rep(,s)","magdalena"
"1471029201404","for (i in 1","magdalena"
"s){","","magdalena"
"1471029201407","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471029201409","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471029201414","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471029201418","reject_unadjust[i]=No","magdalena"
"1471029201423","}","magdalena"
"1471029201429","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471029201434","reject_unadjust[i]=90","magdalena"
"1471029201438","}","magdalena"
"1471029201444","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471029201449","reject_unadjust[i]=95","magdalena"
"1471029201455","}","magdalena"
"1471029201462","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471029201467","reject_unadjust[i]=99","magdalena"
"1471029201471","}","magdalena"
"1471029201476","}","magdalena"
"1471029202064","","magdalena"
"1471029202069","","magdalena"
"1471029202073","B=1000","magdalena"
"1471029202079","beta_bs=matrix(NA,B,s)","magdalena"
"1471029202085","t_bs=matrix(NA,B,s)","magdalena"
"1471029202092","for (i in 1","magdalena"
"B){","","magdalena"
"1471029202097","","magdalena"
"1471029202101","","magdalena"
"1471029202106","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471029202112","y_mat_bs=y_mat[id,]","magdalena"
"1471029202117","treat_bs=treat[id]","magdalena"
"1471029202122","for (k in 1","magdalena"
"s){","","magdalena"
"1471029202127","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471029202133","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471029202137","}","magdalena"
"1471029202141","}","magdalena"
"1471029377728","","magdalena"
"1471029377728","alpha=c(0.95,0.975,0.995)","magdalena"
"1471029377728","","magdalena"
"1471029377728","reject_adjust=rep(,s)","magdalena"
"1471029377728","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471029377744","t_hat_aux=t_hat","magdalena"
"1471029377744","t_bs_aux=t_bs","magdalena"
"1471029377744","done=F","magdalena"
"1471029377759","while(done==F){","magdalena"
"1471029377759","t_max=max(t_hat_aux)","magdalena"
"1471029377759","k=which(t_hat_aux==t_max)","magdalena"
"1471029377759","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471029377775","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471029377775","}","magdalena"
"1471029377775","if(is.null(dim(t_bs_aux))){","magdalena"
"1471029377775","t_bs_max=t_bs_aux","magdalena"
"1471029377775","}","magdalena"
"1471029377793","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471029377797","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471029377797","k_orig=which(t_hat==t_max)","magdalena"
"1471029377797","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471029377797","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471029377813","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471029377813","print(k_orig)","magdalena"
"1471029377813","}","magdalena"
"1471029377828","if(is.null(dim(t_bs_aux))){","magdalena"
"1471029377828","t_bs_max=t_bs_aux","magdalena"
"1471029377828","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471029377828","t_max=max(t_hat_aux)","magdalena"
"1471029377844","}","magdalena"
"1471029377844","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471029377860","if(t_max>=t_quantile){","magdalena"
"1471029377860","k_orig=which(t_hat==t_max)","magdalena"
"1471029377860","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471029377860","}","magdalena"
"1471029377875","done=T","magdalena"
"1471029377875","}","magdalena"
"1471029377875","}","magdalena"
"1471029377875","}","magdalena"
"1471029378013","reject_adjust[reject_adjust==]=No","magdalena"
"1471029378013","","magdalena"
"1471029378013","reject_unadjust","magdalena"
"1471029378029","","magdalena"
"1471029378031","reject_adjust","magdalena"
"1471030139282","","magdalena"
"1471030139282","","magdalena"
"1471030139299","","magdalena"
"1471030139302","","magdalena"
"1471030139302","","magdalena"
"1471030139302","","magdalena"
"1471030139302","rm(list = ls())","magdalena"
"1471030139302","","magdalena"
"1471030139318","cat(\014)","magdalena"
"1471030139318","","magdalena"
"1471030139334","","magdalena"
"1471030139334","","magdalena"
"1471030139334","","magdalena"
"1471030139334","n = 1000","magdalena"
"1471030139349","","magdalena"
"1471030139349","s = 10","magdalena"
"1471030139349","","magdalena"
"1471030139349","beta = rep(0,s)","magdalena"
"1471030139365","","magdalena"
"1471030139365","","magdalena"
"1471030139365","prob=0.8","magdalena"
"1471030139365","treat=rbinom(n,1,prob)","magdalena"
"1471030139381","","magdalena"
"1471030139381","for (i in 1","magdalena"
"s){","","magdalena"
"1471030139381","y=beta[i]*treat+rnorm(n)","magdalena"
"1471030139397","if (i==1){","magdalena"
"1471030139401","y_mat=y","magdalena"
"1471030139403","}","magdalena"
"1471030139403","if (i>1){","magdalena"
"1471030139403","y_mat=cbind(y_mat,y)","magdalena"
"1471030139418","}","magdalena"
"1471030139418","}","magdalena"
"1471030139446","","magdalena"
"1471030139462","beta_hat=rep(NA,s)","magdalena"
"1471030139462","t_hat=rep(NA,s)","magdalena"
"1471030139478","reject_unadjust=rep(,s)","magdalena"
"1471030139478","for (i in 1","magdalena"
"s){","","magdalena"
"1471030139478","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471030139498","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471030139503","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471030139507","reject_unadjust[i]=No","magdalena"
"1471030139511","}","magdalena"
"1471030139515","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471030139519","reject_unadjust[i]=90","magdalena"
"1471030139525","}","magdalena"
"1471030139530","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471030139535","reject_unadjust[i]=95","magdalena"
"1471030139539","}","magdalena"
"1471030139546","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471030139550","reject_unadjust[i]=99","magdalena"
"1471030139555","}","magdalena"
"1471030139558","}","magdalena"
"1471030140839","","magdalena"
"1471030140843","","magdalena"
"1471030140847","B=1000","magdalena"
"1471030140851","beta_bs=matrix(NA,B,s)","magdalena"
"1471030140855","t_bs=matrix(NA,B,s)","magdalena"
"1471030140860","for (i in 1","magdalena"
"B){","","magdalena"
"1471030140864","","magdalena"
"1471030140869","","magdalena"
"1471030140874","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471030140880","y_mat_bs=y_mat[id,]","magdalena"
"1471030140884","treat_bs=treat[id]","magdalena"
"1471030140889","for (k in 1","magdalena"
"s){","","magdalena"
"1471030140893","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471030140898","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471030140904","}","magdalena"
"1471030140909","}","magdalena"
"1471030304199","","magdalena"
"1471030304203","alpha=c(0.95,0.975,0.995)","magdalena"
"1471030304206","","magdalena"
"1471030304211","reject_adjust=rep(,s)","magdalena"
"1471030304215","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471030304218","t_hat_aux=t_hat","magdalena"
"1471030304222","t_bs_aux=t_bs","magdalena"
"1471030304226","done=F","magdalena"
"1471030304230","while(done==F){","magdalena"
"1471030304234","t_max=max(t_hat_aux)","magdalena"
"1471030304237","k=which(t_hat_aux==t_max)","magdalena"
"1471030304243","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471030304247","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471030304251","}","magdalena"
"1471030304254","if(is.null(dim(t_bs_aux))){","magdalena"
"1471030304258","t_bs_max=t_bs_aux","magdalena"
"1471030304261","}","magdalena"
"1471030304265","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471030304269","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471030304273","k_orig=which(t_hat==t_max)","magdalena"
"1471030304276","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471030304279","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471030304284","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471030304288","print(k_orig)","magdalena"
"1471030304291","}","magdalena"
"1471030304296","if(is.null(dim(t_bs_aux))){","magdalena"
"1471030304299","t_bs_max=t_bs_aux","magdalena"
"1471030304303","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471030304307","t_max=max(t_hat_aux)","magdalena"
"1471030304311","}","magdalena"
"1471030304317","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471030304322","if(t_max>=t_quantile){","magdalena"
"1471030304326","k_orig=which(t_hat==t_max)","magdalena"
"1471030304331","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471030304335","}","magdalena"
"1471030304339","done=T","magdalena"
"1471030304343","}","magdalena"
"1471030304346","}","magdalena"
"1471030304350","}","magdalena"
"1471030304380","reject_adjust[reject_adjust==]=No","magdalena"
"1471030304383","","magdalena"
"1471030304386","reject_unadjust","magdalena"
"1471030304391","","magdalena"
"1471030304393","reject_adjust","magdalena"
"1471030878837","","magdalena"
"1471030878837","","magdalena"
"1471030878837","","magdalena"
"1471030878837","","magdalena"
"1471030878853","","magdalena"
"1471030878853","","magdalena"
"1471030878853","rm(list = ls())","magdalena"
"1471030878853","","magdalena"
"1471030878853","cat(\014)","magdalena"
"1471030878868","","magdalena"
"1471030878868","","magdalena"
"1471030878868","","magdalena"
"1471030878868","","magdalena"
"1471030878884","n = 1000","magdalena"
"1471030878884","","magdalena"
"1471030878884","s = 10","magdalena"
"1471030878884","","magdalena"
"1471030878900","beta = rep(0,s)","magdalena"
"1471030878904","","magdalena"
"1471030878905","","magdalena"
"1471030878905","prob=0.8","magdalena"
"1471030878905","treat=rbinom(n,1,prob)","magdalena"
"1471030878905","","magdalena"
"1471030878920","for (i in 1","magdalena"
"s){","","magdalena"
"1471030878920","y=beta[i]*treat+rnorm(n)","magdalena"
"1471030878920","if (i==1){","magdalena"
"1471030878920","y_mat=y","magdalena"
"1471030878920","}","magdalena"
"1471030878936","if (i>1){","magdalena"
"1471030878936","y_mat=cbind(y_mat,y)","magdalena"
"1471030878936","}","magdalena"
"1471030878952","}","magdalena"
"1471030878952","","magdalena"
"1471030878967","beta_hat=rep(NA,s)","magdalena"
"1471030878967","t_hat=rep(NA,s)","magdalena"
"1471030878967","reject_unadjust=rep(,s)","magdalena"
"1471030878967","for (i in 1","magdalena"
"s){","","magdalena"
"1471030878983","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471030878984","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471030878995","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471030878999","reject_unadjust[i]=No","magdalena"
"1471030879003","}","magdalena"
"1471030879005","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471030879005","reject_unadjust[i]=90","magdalena"
"1471030879005","}","magdalena"
"1471030879005","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471030879020","reject_unadjust[i]=95","magdalena"
"1471030879020","}","magdalena"
"1471030879020","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471030879020","reject_unadjust[i]=99","magdalena"
"1471030879020","}","magdalena"
"1471030879036","}","magdalena"
"1471030879682","","magdalena"
"1471030879698","","magdalena"
"1471030879698","B=1000","magdalena"
"1471030879698","beta_bs=matrix(NA,B,s)","magdalena"
"1471030879698","t_bs=matrix(NA,B,s)","magdalena"
"1471030879714","for (i in 1","magdalena"
"B){","","magdalena"
"1471030879714","","magdalena"
"1471030879714","","magdalena"
"1471030879714","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471030879714","y_mat_bs=y_mat[id,]","magdalena"
"1471030879732","treat_bs=treat[id]","magdalena"
"1471030879736","for (k in 1","magdalena"
"s){","","magdalena"
"1471030879741","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471030879745","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471030879749","}","magdalena"
"1471030879752","}","magdalena"
"1471031041158","","magdalena"
"1471031041164","alpha=c(0.95,0.975,0.995)","magdalena"
"1471031041168","","magdalena"
"1471031041172","reject_adjust=rep(,s)","magdalena"
"1471031041176","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471031041181","t_hat_aux=t_hat","magdalena"
"1471031041185","t_bs_aux=t_bs","magdalena"
"1471031041190","done=F","magdalena"
"1471031041194","while(done==F){","magdalena"
"1471031041197","t_max=max(t_hat_aux)","magdalena"
"1471031041201","k=which(t_hat_aux==t_max)","magdalena"
"1471031041205","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471031041209","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471031041213","}","magdalena"
"1471031041218","if(is.null(dim(t_bs_aux))){","magdalena"
"1471031041222","t_bs_max=t_bs_aux","magdalena"
"1471031041226","}","magdalena"
"1471031041232","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471031041238","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471031041242","k_orig=which(t_hat==t_max)","magdalena"
"1471031041245","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471031041248","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471031041252","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471031041255","print(k_orig)","magdalena"
"1471031041258","}","magdalena"
"1471031041266","if(is.null(dim(t_bs_aux))){","magdalena"
"1471031041271","t_bs_max=t_bs_aux","magdalena"
"1471031041277","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471031041288","t_max=max(t_hat_aux)","magdalena"
"1471031041294","}","magdalena"
"1471031041301","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471031041305","if(t_max>=t_quantile){","magdalena"
"1471031041308","k_orig=which(t_hat==t_max)","magdalena"
"1471031041308","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471031041308","}","magdalena"
"1471031041308","done=T","magdalena"
"1471031041324","}","magdalena"
"1471031041324","}","magdalena"
"1471031041324","}","magdalena"
"1471031041372","reject_adjust[reject_adjust==]=No","magdalena"
"1471031041379","","magdalena"
"1471031041383","reject_unadjust","magdalena"
"1471031041388","","magdalena"
"1471031041393","reject_adjust","magdalena"
"1471031164904","","magdalena"
"1471031164908","","magdalena"
"1471031164912","","magdalena"
"1471031164916","","magdalena"
"1471031164919","","magdalena"
"1471031164924","","magdalena"
"1471031164928","rm(list = ls())","magdalena"
"1471031164935","","magdalena"
"1471031164939","cat(\014)","magdalena"
"1471031164947","","magdalena"
"1471031164952","","magdalena"
"1471031164956","","magdalena"
"1471031164962","","magdalena"
"1471031164966","n = 1000","magdalena"
"1471031164972","","magdalena"
"1471031164976","s = 10","magdalena"
"1471031164982","","magdalena"
"1471031164986","beta = rep(0,s)","magdalena"
"1471031164992","","magdalena"
"1471031164998","","magdalena"
"1471031165002","prob=0.8","magdalena"
"1471031165006","treat=rbinom(n,1,prob)","magdalena"
"1471031165011","","magdalena"
"1471031165016","for (i in 1","magdalena"
"s){","","magdalena"
"1471031165021","y=beta[i]*treat+rnorm(n)","magdalena"
"1471031165027","if (i==1){","magdalena"
"1471031165030","y_mat=y","magdalena"
"1471031165034","}","magdalena"
"1471031165037","if (i>1){","magdalena"
"1471031165041","y_mat=cbind(y_mat,y)","magdalena"
"1471031165044","}","magdalena"
"1471031165049","}","magdalena"
"1471031165060","","magdalena"
"1471031165064","beta_hat=rep(NA,s)","magdalena"
"1471031165069","t_hat=rep(NA,s)","magdalena"
"1471031165074","reject_unadjust=rep(,s)","magdalena"
"1471031165079","for (i in 1","magdalena"
"s){","","magdalena"
"1471031165083","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471031165087","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471031165091","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471031165095","reject_unadjust[i]=No","magdalena"
"1471031165100","}","magdalena"
"1471031165106","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471031165111","reject_unadjust[i]=90","magdalena"
"1471031165116","}","magdalena"
"1471031165122","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471031165127","reject_unadjust[i]=95","magdalena"
"1471031165132","}","magdalena"
"1471031165140","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471031165145","reject_unadjust[i]=99","magdalena"
"1471031165150","}","magdalena"
"1471031165156","}","magdalena"
"1471031165880","","magdalena"
"1471031165884","","magdalena"
"1471031165887","B=1000","magdalena"
"1471031165892","beta_bs=matrix(NA,B,s)","magdalena"
"1471031165895","t_bs=matrix(NA,B,s)","magdalena"
"1471031165900","for (i in 1","magdalena"
"B){","","magdalena"
"1471031165903","","magdalena"
"1471031165906","","magdalena"
"1471031165910","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471031165914","y_mat_bs=y_mat[id,]","magdalena"
"1471031165917","treat_bs=treat[id]","magdalena"
"1471031165921","for (k in 1","magdalena"
"s){","","magdalena"
"1471031165925","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471031165928","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471031165932","}","magdalena"
"1471031165936","}","magdalena"
"1471031358169","","magdalena"
"1471031358169","alpha=c(0.95,0.975,0.995)","magdalena"
"1471031358169","","magdalena"
"1471031358169","reject_adjust=rep(,s)","magdalena"
"1471031358169","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471031358185","t_hat_aux=t_hat","magdalena"
"1471031358185","t_bs_aux=t_bs","magdalena"
"1471031358185","done=F","magdalena"
"1471031358185","while(done==F){","magdalena"
"1471031358185","t_max=max(t_hat_aux)","magdalena"
"1471031358201","k=which(t_hat_aux==t_max)","magdalena"
"1471031358201","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471031358201","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471031358216","}","magdalena"
"1471031358216","if(is.null(dim(t_bs_aux))){","magdalena"
"1471031358216","t_bs_max=t_bs_aux","magdalena"
"1471031358216","}","magdalena"
"1471031358216","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471031358232","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471031358232","k_orig=which(t_hat==t_max)","magdalena"
"1471031358232","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471031358232","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471031358247","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471031358247","print(k_orig)","magdalena"
"1471031358247","}","magdalena"
"1471031358247","if(is.null(dim(t_bs_aux))){","magdalena"
"1471031358247","t_bs_max=t_bs_aux","magdalena"
"1471031358266","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471031358269","t_max=max(t_hat_aux)","magdalena"
"1471031358270","}","magdalena"
"1471031358270","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471031358270","if(t_max>=t_quantile){","magdalena"
"1471031358270","k_orig=which(t_hat==t_max)","magdalena"
"1471031358285","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471031358285","}","magdalena"
"1471031358285","done=T","magdalena"
"1471031358285","}","magdalena"
"1471031358285","}","magdalena"
"1471031358301","}","magdalena"
"1471031358316","reject_adjust[reject_adjust==]=No","magdalena"
"1471031358316","","magdalena"
"1471031358332","reject_unadjust","magdalena"
"1471031358344","","magdalena"
"1471031358350","reject_adjust","magdalena"
"1471033704178","","magdalena"
"1471033704184","","magdalena"
"1471033704188","","magdalena"
"1471033704192","","magdalena"
"1471033704192","","magdalena"
"1471033704192","","magdalena"
"1471033704192","rm(list = ls())","magdalena"
"1471033704208","","magdalena"
"1471033704208","cat(\014)","magdalena"
"1471033704208","","magdalena"
"1471033704224","","magdalena"
"1471033704224","","magdalena"
"1471033704224","","magdalena"
"1471033704224","n = 1000","magdalena"
"1471033704241","","magdalena"
"1471033704241","s = 10","magdalena"
"1471033704241","","magdalena"
"1471033704241","","magdalena"
"1471033704241","beta=c(rep(1,round(s/2,0)),rep(0,s-round(s/2,0)))","magdalena"
"1471033704256","","magdalena"
"1471033704256","prob=0.1","magdalena"
"1471033704256","treat=rbinom(n,1,prob)","magdalena"
"1471033704272","","magdalena"
"1471033704272","for (i in 1","magdalena"
"s){","","magdalena"
"1471033704272","y=beta[i]*treat+rnorm(n)","magdalena"
"1471033704272","if (i==1){","magdalena"
"1471033704288","y_mat=y","magdalena"
"1471033704288","}","magdalena"
"1471033704288","if (i>1){","magdalena"
"1471033704288","y_mat=cbind(y_mat,y)","magdalena"
"1471033704288","}","magdalena"
"1471033704303","}","magdalena"
"1471033704319","","magdalena"
"1471033704319","beta_hat=rep(NA,s)","magdalena"
"1471033704319","t_hat=rep(NA,s)","magdalena"
"1471033704319","reject_unadjust=rep(,s)","magdalena"
"1471033704340","for (i in 1","magdalena"
"s){","","magdalena"
"1471033704341","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471033704341","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471033704341","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471033704341","reject_unadjust[i]=No","magdalena"
"1471033704341","}","magdalena"
"1471033704357","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471033704357","reject_unadjust[i]=90","magdalena"
"1471033704370","}","magdalena"
"1471033704375","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471033704380","reject_unadjust[i]=95","magdalena"
"1471033704385","}","magdalena"
"1471033704389","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471033704393","reject_unadjust[i]=99","magdalena"
"1471033704397","}","magdalena"
"1471033704400","}","magdalena"
"1471033705000","","magdalena"
"1471033705016","","magdalena"
"1471033705016","B=1000","magdalena"
"1471033705016","beta_bs=matrix(NA,B,s)","magdalena"
"1471033705016","t_bs=matrix(NA,B,s)","magdalena"
"1471033705033","for (i in 1","magdalena"
"B){","","magdalena"
"1471033705038","","magdalena"
"1471033705042","","magdalena"
"1471033705042","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471033705042","y_mat_bs=y_mat[id,]","magdalena"
"1471033705042","treat_bs=treat[id]","magdalena"
"1471033705057","for (k in 1","magdalena"
"s){","","magdalena"
"1471033705057","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471033705057","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471033705073","}","magdalena"
"1471033705073","}","magdalena"
"1471033866598","","magdalena"
"1471033866604","alpha=c(0.95,0.975,0.995)","magdalena"
"1471033866609","","magdalena"
"1471033866614","reject_adjust=rep(,s)","magdalena"
"1471033866620","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471033866624","t_hat_aux=t_hat","magdalena"
"1471033866628","t_bs_aux=t_bs","magdalena"
"1471033866633","done=F","magdalena"
"1471033866638","while(done==F){","magdalena"
"1471033866643","t_max=max(t_hat_aux)","magdalena"
"1471033866791","k=which(t_hat_aux==t_max)","magdalena"
"1471033866801","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471033866806","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471033866809","}","magdalena"
"1471033866812","if(is.null(dim(t_bs_aux))){","magdalena"
"1471033866812","t_bs_max=t_bs_aux","magdalena"
"1471033866812","}","magdalena"
"1471033866812","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471033866812","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471033866812","k_orig=which(t_hat==t_max)","magdalena"
"1471033866828","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471033866828","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471033866828","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471033866828","print(k_orig)","magdalena"
"1471033866828","}","magdalena"
"1471033866844","if(is.null(dim(t_bs_aux))){","magdalena"
"1471033866844","t_bs_max=t_bs_aux","magdalena"
"1471033866844","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471033866844","t_max=max(t_hat_aux)","magdalena"
"1471033866844","}","magdalena"
"1471033866860","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471033866863","if(t_max>=t_quantile){","magdalena"
"1471033866866","k_orig=which(t_hat==t_max)","magdalena"
"1471033866869","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471033866872","}","magdalena"
"1471033866875","done=T","magdalena"
"1471033866875","}","magdalena"
"1471033866875","}","magdalena"
"1471033866875","}","magdalena"
"1471033867023","reject_adjust[reject_adjust==]=No","magdalena"
"1471033867038","","magdalena"
"1471033867038","reject_unadjust","magdalena"
"1471033867038","","magdalena"
"1471033867054","reject_adjust","magdalena"
"1471033876800","help(lm)","magdalena"
"1471034047195","group <- gl(2, 10, 20, labels = c(Ctl,Trt))","magdalena"
"1471034049083","group","magdalena"
"1471039911511","","magdalena"
"1471039911533","","magdalena"
"1471039911537","","magdalena"
"1471039911543","","magdalena"
"1471039911547","","magdalena"
"1471039911547","","magdalena"
"1471039911547","rm(list = ls())","magdalena"
"1471039911563","","magdalena"
"1471039911563","cat(\014)","magdalena"
"1471039911578","","magdalena"
"1471039911578","","magdalena"
"1471039911578","","magdalena"
"1471039911594","","magdalena"
"1471039911594","n = 1000","magdalena"
"1471039911594","","magdalena"
"1471039911594","s = 10","magdalena"
"1471039911617","","magdalena"
"1471039911621","beta = rep(0,s)","magdalena"
"1471039911627","","magdalena"
"1471039911632","beta[1]=2","magdalena"
"1471039911637","beta[5]=5","magdalena"
"1471039911645","","magdalena"
"1471039911650","prob=0.1","magdalena"
"1471039911656","treat=rbinom(n,1,prob)","magdalena"
"1471039911664","","magdalena"
"1471039911670","for (i in 1","magdalena"
"s){","","magdalena"
"1471039911675","y=beta[i]*treat+rnorm(n)","magdalena"
"1471039911681","if (i==1){","magdalena"
"1471039911686","y_mat=y","magdalena"
"1471039911693","}","magdalena"
"1471039911698","if (i>1){","magdalena"
"1471039911703","y_mat=cbind(y_mat,y)","magdalena"
"1471039911707","}","magdalena"
"1471039911712","}","magdalena"
"1471039911735","","magdalena"
"1471039911739","","magdalena"
"1471039911743","","magdalena"
"1471039911749","","magdalena"
"1471039911754","","magdalena"
"1471039911758","","magdalena"
"1471039911762","beta_hat=rep(NA,s)","magdalena"
"1471039911766","t_hat=rep(NA,s)","magdalena"
"1471039911769","reject_unadjust=rep(,s)","magdalena"
"1471039911771","for (i in 1","magdalena"
"s){","","magdalena"
"1471039911771","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471039911771","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471039911771","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471039911771","reject_unadjust[i]=No","magdalena"
"1471039911786","}","magdalena"
"1471039911786","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471039911786","reject_unadjust[i]=90","magdalena"
"1471039911786","}","magdalena"
"1471039911802","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471039911802","reject_unadjust[i]=95","magdalena"
"1471039911802","}","magdalena"
"1471039911802","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471039911818","reject_unadjust[i]=99","magdalena"
"1471039911818","}","magdalena"
"1471039911818","}","magdalena"
"1471039913098","","magdalena"
"1471039913103","","magdalena"
"1471039913106","B=1000","magdalena"
"1471039913112","beta_bs=matrix(NA,B,s)","magdalena"
"1471039913116","t_bs=matrix(NA,B,s)","magdalena"
"1471039913120","for (i in 1","magdalena"
"B){","","magdalena"
"1471039913123","","magdalena"
"1471039913126","","magdalena"
"1471039913129","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471039913133","y_mat_bs=y_mat[id,]","magdalena"
"1471039913137","treat_bs=treat[id]","magdalena"
"1471039913142","for (k in 1","magdalena"
"s){","","magdalena"
"1471039913146","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471039913151","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471039913155","}","magdalena"
"1471039913159","}","magdalena"
"1471040122648","","magdalena"
"1471040122654","alpha=c(0.95,0.975,0.995)","magdalena"
"1471040122660","","magdalena"
"1471040122666","reject_adjust=rep(,s)","magdalena"
"1471040122672","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471040122679","t_hat_aux=t_hat","magdalena"
"1471040122682","t_bs_aux=t_bs","magdalena"
"1471040122687","done=F","magdalena"
"1471040122693","while(done==F){","magdalena"
"1471040122697","t_max=max(t_hat_aux)","magdalena"
"1471040122701","k=which(t_hat_aux==t_max)","magdalena"
"1471040122708","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471040122713","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471040122718","}","magdalena"
"1471040122724","if(is.null(dim(t_bs_aux))){","magdalena"
"1471040122728","t_bs_max=t_bs_aux","magdalena"
"1471040122733","}","magdalena"
"1471040122740","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471040122747","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471040122752","k_orig=which(t_hat==t_max)","magdalena"
"1471040122757","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471040122762","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471040122767","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471040122772","print(k_orig)","magdalena"
"1471040122777","}","magdalena"
"1471040122784","if(is.null(dim(t_bs_aux))){","magdalena"
"1471040122789","t_bs_max=t_bs_aux","magdalena"
"1471040122794","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471040122799","t_max=max(t_hat_aux)","magdalena"
"1471040122804","}","magdalena"
"1471040122811","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471040122816","if(t_max>=t_quantile){","magdalena"
"1471040122821","k_orig=which(t_hat==t_max)","magdalena"
"1471040122826","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471040122832","}","magdalena"
"1471040122837","done=T","magdalena"
"1471040122843","}","magdalena"
"1471040122849","}","magdalena"
"1471040122854","}","magdalena"
"1471040122986","reject_adjust[reject_adjust==]=No","magdalena"
"1471040122992","","magdalena"
"1471040122999","reject_unadjust","magdalena"
"1471040123007","","magdalena"
"1471040123012","reject_adjust","magdalena"
"1471041101845","","magdalena"
"1471041101849","","magdalena"
"1471041101852","","magdalena"
"1471041101858","","magdalena"
"1471041101862","","magdalena"
"1471041101868","","magdalena"
"1471041101871","rm(list = ls())","magdalena"
"1471041101877","","magdalena"
"1471041101881","cat(\014)","magdalena"
"1471041101888","","magdalena"
"1471041101894","","magdalena"
"1471041101898","","magdalena"
"1471041101903","","magdalena"
"1471041101907","n = 1000","magdalena"
"1471041101912","","magdalena"
"1471041101917","s = 10","magdalena"
"1471041101924","","magdalena"
"1471041101928","beta = rep(0,s)","magdalena"
"1471041101933","","magdalena"
"1471041101937","beta[1]=2","magdalena"
"1471041101943","beta[5]=5","magdalena"
"1471041101950","","magdalena"
"1471041101955","prob=0.1","magdalena"
"1471041101959","treat=rbinom(n,1,prob)","magdalena"
"1471041101966","","magdalena"
"1471041101971","for (i in 1","magdalena"
"s){","","magdalena"
"1471041101975","y=beta[i]*treat+rnorm(n)","magdalena"
"1471041101980","if (i==1){","magdalena"
"1471041101984","y_mat=y","magdalena"
"1471041101988","}","magdalena"
"1471041101993","if (i>1){","magdalena"
"1471041101997","y_mat=cbind(y_mat,y)","magdalena"
"1471041102001","}","magdalena"
"1471041102005","}","magdalena"
"1471041102014","","magdalena"
"1471041102018","","magdalena"
"1471041102021","","magdalena"
"1471041102025","","magdalena"
"1471041102031","","magdalena"
"1471041102037","","magdalena"
"1471041102042","beta_hat=rep(NA,s)","magdalena"
"1471041102047","t_hat=rep(NA,s)","magdalena"
"1471041102051","reject_unadjust=rep(,s)","magdalena"
"1471041102055","for (i in 1","magdalena"
"s){","","magdalena"
"1471041102060","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471041102064","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471041102070","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471041102074","reject_unadjust[i]=No","magdalena"
"1471041102079","}","magdalena"
"1471041102085","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471041102089","reject_unadjust[i]=90","magdalena"
"1471041102094","}","magdalena"
"1471041102099","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471041102104","reject_unadjust[i]=95","magdalena"
"1471041102109","}","magdalena"
"1471041102115","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471041102120","reject_unadjust[i]=99","magdalena"
"1471041102124","}","magdalena"
"1471041102129","}","magdalena"
"1471041102845","","magdalena"
"1471041102850","","magdalena"
"1471041102855","B=1000","magdalena"
"1471041102861","beta_bs=matrix(NA,B,s)","magdalena"
"1471041102866","t_bs=matrix(NA,B,s)","magdalena"
"1471041102871","for (i in 1","magdalena"
"B){","","magdalena"
"1471041102876","","magdalena"
"1471041102881","","magdalena"
"1471041102887","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471041102893","y_mat_bs=y_mat[id,]","magdalena"
"1471041102897","treat_bs=treat[id]","magdalena"
"1471041102902","for (k in 1","magdalena"
"s){","","magdalena"
"1471041102907","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471041102912","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471041102916","}","magdalena"
"1471041102921","}","magdalena"
"1471041264143","","magdalena"
"1471041264143","alpha=c(0.95,0.975,0.995)","magdalena"
"1471041264143","","magdalena"
"1471041264159","reject_adjust=rep(,s)","magdalena"
"1471041264159","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471041264159","t_hat_aux=t_hat","magdalena"
"1471041264159","t_bs_aux=t_bs","magdalena"
"1471041264159","done=F","magdalena"
"1471041264175","while(done==F){","magdalena"
"1471041264175","t_max=max(t_hat_aux)","magdalena"
"1471041264175","k=which(t_hat_aux==t_max)","magdalena"
"1471041264175","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471041264190","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471041264190","}","magdalena"
"1471041264190","if(is.null(dim(t_bs_aux))){","magdalena"
"1471041264190","t_bs_max=t_bs_aux","magdalena"
"1471041264190","}","magdalena"
"1471041264206","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471041264206","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471041264206","k_orig=which(t_hat==t_max)","magdalena"
"1471041264206","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471041264222","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471041264227","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471041264228","print(k_orig)","magdalena"
"1471041264228","}","magdalena"
"1471041264228","if(is.null(dim(t_bs_aux))){","magdalena"
"1471041264228","t_bs_max=t_bs_aux","magdalena"
"1471041264244","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471041264244","t_max=max(t_hat_aux)","magdalena"
"1471041264244","}","magdalena"
"1471041264244","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471041264244","if(t_max>=t_quantile){","magdalena"
"1471041264259","k_orig=which(t_hat==t_max)","magdalena"
"1471041264269","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471041264272","}","magdalena"
"1471041264272","done=T","magdalena"
"1471041264272","}","magdalena"
"1471041264272","}","magdalena"
"1471041264272","}","magdalena"
"1471041264376","reject_adjust[reject_adjust==]=No","magdalena"
"1471041264376","","magdalena"
"1471041264391","reject_unadjust","magdalena"
"1471041264391","","magdalena"
"1471041264391","reject_adjust","magdalena"
"1471041329287","","magdalena"
"1471041329290","","magdalena"
"1471041329294","","magdalena"
"1471041329296","","magdalena"
"1471041329296","","magdalena"
"1471041329296","","magdalena"
"1471041329296","rm(list = ls())","magdalena"
"1471041329296","","magdalena"
"1471041329312","cat(\014)","magdalena"
"1471041329312","","magdalena"
"1471041329312","","magdalena"
"1471041329312","","magdalena"
"1471041329330","","magdalena"
"1471041329332","n = 1000","magdalena"
"1471041329332","","magdalena"
"1471041329332","s = 10","magdalena"
"1471041329332","","magdalena"
"1471041329332","beta = rep(0,s)","magdalena"
"1471041329348","","magdalena"
"1471041329348","beta[1]=2","magdalena"
"1471041329348","beta[5]=5","magdalena"
"1471041329361","","magdalena"
"1471041329364","prob=0.1","magdalena"
"1471041329364","treat=rbinom(n,1,prob)","magdalena"
"1471041329364","","magdalena"
"1471041329380","for (i in 1","magdalena"
"s){","","magdalena"
"1471041329380","y=beta[i]*treat+rnorm(n)","magdalena"
"1471041329380","if (i==1){","magdalena"
"1471041329380","y_mat=y","magdalena"
"1471041329380","}","magdalena"
"1471041329395","if (i>1){","magdalena"
"1471041329395","y_mat=cbind(y_mat,y)","magdalena"
"1471041329395","}","magdalena"
"1471041329395","}","magdalena"
"1471041329411","","magdalena"
"1471041329411","","magdalena"
"1471041329411","","magdalena"
"1471041329411","","magdalena"
"1471041329428","","magdalena"
"1471041329432","","magdalena"
"1471041329432","beta_hat=rep(NA,s)","magdalena"
"1471041329432","t_hat=rep(NA,s)","magdalena"
"1471041329432","reject_unadjust=rep(,s)","magdalena"
"1471041329448","for (i in 1","magdalena"
"s){","","magdalena"
"1471041329448","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471041329448","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471041329448","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471041329463","reject_unadjust[i]=No","magdalena"
"1471041329463","}","magdalena"
"1471041329463","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471041329463","reject_unadjust[i]=90","magdalena"
"1471041329479","}","magdalena"
"1471041329484","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471041329487","reject_unadjust[i]=95","magdalena"
"1471041329491","}","magdalena"
"1471041329495","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471041329498","reject_unadjust[i]=99","magdalena"
"1471041329502","}","magdalena"
"1471041329507","}","magdalena"
"1471041330130","","magdalena"
"1471041330133","","magdalena"
"1471041330133","B=1000","magdalena"
"1471041330133","beta_bs=matrix(NA,B,s)","magdalena"
"1471041330149","t_bs=matrix(NA,B,s)","magdalena"
"1471041330149","for (i in 1","magdalena"
"B){","","magdalena"
"1471041330149","","magdalena"
"1471041330164","","magdalena"
"1471041330164","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471041330164","y_mat_bs=y_mat[id,]","magdalena"
"1471041330164","treat_bs=treat[id]","magdalena"
"1471041330180","for (k in 1","magdalena"
"s){","","magdalena"
"1471041330180","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471041330180","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471041330197","}","magdalena"
"1471041330201","}","magdalena"
"1471041517573","","magdalena"
"1471041517588","alpha=c(0.95,0.975,0.995)","magdalena"
"1471041517588","","magdalena"
"1471041517588","reject_adjust=rep(,s)","magdalena"
"1471041517588","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471041517604","t_hat_aux=t_hat","magdalena"
"1471041517606","t_bs_aux=t_bs","magdalena"
"1471041517606","done=F","magdalena"
"1471041517606","while(done==F){","magdalena"
"1471041517606","t_max=max(t_hat_aux)","magdalena"
"1471041517606","k=which(t_hat_aux==t_max)","magdalena"
"1471041517621","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471041517621","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471041517621","}","magdalena"
"1471041517621","if(is.null(dim(t_bs_aux))){","magdalena"
"1471041517637","t_bs_max=t_bs_aux","magdalena"
"1471041517637","}","magdalena"
"1471041517637","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471041517653","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471041517653","k_orig=which(t_hat==t_max)","magdalena"
"1471041517653","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471041517653","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471041517668","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471041517668","print(k_orig)","magdalena"
"1471041517668","}","magdalena"
"1471041517684","if(is.null(dim(t_bs_aux))){","magdalena"
"1471041517684","t_bs_max=t_bs_aux","magdalena"
"1471041517700","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471041517706","t_max=max(t_hat_aux)","magdalena"
"1471041517713","}","magdalena"
"1471041517719","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471041517724","if(t_max>=t_quantile){","magdalena"
"1471041517728","k_orig=which(t_hat==t_max)","magdalena"
"1471041517734","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471041517737","}","magdalena"
"1471041517741","done=T","magdalena"
"1471041517742","}","magdalena"
"1471041517742","}","magdalena"
"1471041517742","}","magdalena"
"1471041517822","reject_adjust[reject_adjust==]=No","magdalena"
"1471041517822","","magdalena"
"1471041517837","reject_unadjust","magdalena"
"1471041517837","","magdalena"
"1471041517837","reject_adjust","magdalena"
"1471041533015","","magdalena"
"1471041533015","","magdalena"
"1471041533031","","magdalena"
"1471041533037","","magdalena"
"1471041533040","","magdalena"
"1471041533043","","magdalena"
"1471041533046","rm(list = ls())","magdalena"
"1471041533051","","magdalena"
"1471041533051","cat(\014)","magdalena"
"1471041533051","","magdalena"
"1471041533051","","magdalena"
"1471041533068","","magdalena"
"1471041533073","","magdalena"
"1471041533077","n = 1000","magdalena"
"1471041533082","","magdalena"
"1471041533082","s = 10","magdalena"
"1471041533082","","magdalena"
"1471041533082","beta = rep(0,s)","magdalena"
"1471041533098","","magdalena"
"1471041533098","beta[1]=2","magdalena"
"1471041533098","beta[5]=5","magdalena"
"1471041533113","","magdalena"
"1471041533113","prob=0.1","magdalena"
"1471041533113","treat=rbinom(n,1,prob)","magdalena"
"1471041533113","","magdalena"
"1471041533129","for (i in 1","magdalena"
"s){","","magdalena"
"1471041533129","y=beta[i]*treat+rnorm(n)","magdalena"
"1471041533129","if (i==1){","magdalena"
"1471041533129","y_mat=y","magdalena"
"1471041533145","}","magdalena"
"1471041533145","if (i>1){","magdalena"
"1471041533145","y_mat=cbind(y_mat,y)","magdalena"
"1471041533145","}","magdalena"
"1471041533145","}","magdalena"
"1471041533160","","magdalena"
"1471041533160","","magdalena"
"1471041533160","","magdalena"
"1471041533176","","magdalena"
"1471041533180","","magdalena"
"1471041533182","","magdalena"
"1471041533182","beta_hat=rep(NA,s)","magdalena"
"1471041533182","t_hat=rep(NA,s)","magdalena"
"1471041533182","reject_unadjust=rep(,s)","magdalena"
"1471041533198","for (i in 1","magdalena"
"s){","","magdalena"
"1471041533198","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471041533198","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471041533198","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471041533198","reject_unadjust[i]=No","magdalena"
"1471041533214","}","magdalena"
"1471041533214","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471041533214","reject_unadjust[i]=90","magdalena"
"1471041533214","}","magdalena"
"1471041533214","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471041533229","reject_unadjust[i]=95","magdalena"
"1471041533229","}","magdalena"
"1471041533229","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471041533229","reject_unadjust[i]=99","magdalena"
"1471041533245","}","magdalena"
"1471041533245","}","magdalena"
"1471041533800","","magdalena"
"1471041533806","","magdalena"
"1471041533810","B=1000","magdalena"
"1471041533816","beta_bs=matrix(NA,B,s)","magdalena"
"1471041533821","t_bs=matrix(NA,B,s)","magdalena"
"1471041533827","for (i in 1","magdalena"
"B){","","magdalena"
"1471041533831","","magdalena"
"1471041533831","","magdalena"
"1471041533831","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471041533847","y_mat_bs=y_mat[id,]","magdalena"
"1471041533847","treat_bs=treat[id]","magdalena"
"1471041533847","for (k in 1","magdalena"
"s){","","magdalena"
"1471041533847","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471041533847","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471041533862","}","magdalena"
"1471041533862","}","magdalena"
"1471041690516","","magdalena"
"1471041690522","alpha=c(0.95,0.975,0.995)","magdalena"
"1471041690527","","magdalena"
"1471041690533","reject_adjust=rep(,s)","magdalena"
"1471041690539","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471041690544","t_hat_aux=t_hat","magdalena"
"1471041690549","t_bs_aux=t_bs","magdalena"
"1471041690554","done=F","magdalena"
"1471041690560","while(done==F){","magdalena"
"1471041690565","t_max=max(t_hat_aux)","magdalena"
"1471041690570","k=which(t_hat_aux==t_max)","magdalena"
"1471041690576","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471041690580","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471041690585","}","magdalena"
"1471041690590","if(is.null(dim(t_bs_aux))){","magdalena"
"1471041690594","t_bs_max=t_bs_aux","magdalena"
"1471041690598","}","magdalena"
"1471041690604","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471041690611","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471041690616","k_orig=which(t_hat==t_max)","magdalena"
"1471041690620","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471041690625","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471041690630","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471041690633","print(k_orig)","magdalena"
"1471041690637","}","magdalena"
"1471041690641","if(is.null(dim(t_bs_aux))){","magdalena"
"1471041690644","t_bs_max=t_bs_aux","magdalena"
"1471041690648","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471041690652","t_max=max(t_hat_aux)","magdalena"
"1471041690655","}","magdalena"
"1471041690660","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471041690663","if(t_max>=t_quantile){","magdalena"
"1471041690666","k_orig=which(t_hat==t_max)","magdalena"
"1471041690669","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471041690672","}","magdalena"
"1471041690676","done=T","magdalena"
"1471041690679","}","magdalena"
"1471041690683","}","magdalena"
"1471041690686","}","magdalena"
"1471041690752","reject_adjust[reject_adjust==]=No","magdalena"
"1471041690756","","magdalena"
"1471041690759","reject_unadjust","magdalena"
"1471041690766","","magdalena"
"1471041690770","reject_adjust","magdalena"
"1471041700513","","magdalena"
"1471041700513","beta_hat","magdalena"
"1471041731043","","magdalena"
"1471041731043","","magdalena"
"1471041731043","","magdalena"
"1471041731058","","magdalena"
"1471041731058","","magdalena"
"1471041731058","","magdalena"
"1471041731058","rm(list = ls())","magdalena"
"1471041731058","","magdalena"
"1471041731074","cat(\014)","magdalena"
"1471041731074","","magdalena"
"1471041731074","","magdalena"
"1471041731074","","magdalena"
"1471041731090","","magdalena"
"1471041731094","n = 1000","magdalena"
"1471041731098","","magdalena"
"1471041731102","s = 10","magdalena"
"1471041731107","","magdalena"
"1471041731111","beta = rep(0,s)","magdalena"
"1471041731114","","magdalena"
"1471041731117","beta[1]=0.5","magdalena"
"1471041731122","beta[5]=5","magdalena"
"1471041731126","","magdalena"
"1471041731126","prob=0.1","magdalena"
"1471041731126","treat=rbinom(n,1,prob)","magdalena"
"1471041731126","","magdalena"
"1471041731142","for (i in 1","magdalena"
"s){","","magdalena"
"1471041731142","y=beta[i]*treat+rnorm(n)","magdalena"
"1471041731142","if (i==1){","magdalena"
"1471041731142","y_mat=y","magdalena"
"1471041731157","}","magdalena"
"1471041731157","if (i>1){","magdalena"
"1471041731157","y_mat=cbind(y_mat,y)","magdalena"
"1471041731157","}","magdalena"
"1471041731157","}","magdalena"
"1471041731173","","magdalena"
"1471041731173","","magdalena"
"1471041731188","","magdalena"
"1471041731188","","magdalena"
"1471041731188","","magdalena"
"1471041731204","","magdalena"
"1471041731209","beta_hat=rep(NA,s)","magdalena"
"1471041731214","t_hat=rep(NA,s)","magdalena"
"1471041731219","reject_unadjust=rep(,s)","magdalena"
"1471041731225","for (i in 1","magdalena"
"s){","","magdalena"
"1471041731229","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471041731233","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471041731233","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471041731233","reject_unadjust[i]=No","magdalena"
"1471041731233","}","magdalena"
"1471041731249","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471041731249","reject_unadjust[i]=90","magdalena"
"1471041731249","}","magdalena"
"1471041731265","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471041731265","reject_unadjust[i]=95","magdalena"
"1471041731265","}","magdalena"
"1471041731280","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471041731280","reject_unadjust[i]=99","magdalena"
"1471041731280","}","magdalena"
"1471041731280","}","magdalena"
"1471041731845","","magdalena"
"1471041731860","","magdalena"
"1471041731860","B=1000","magdalena"
"1471041731860","beta_bs=matrix(NA,B,s)","magdalena"
"1471041731860","t_bs=matrix(NA,B,s)","magdalena"
"1471041731876","for (i in 1","magdalena"
"B){","","magdalena"
"1471041731876","","magdalena"
"1471041731876","","magdalena"
"1471041731876","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471041731891","y_mat_bs=y_mat[id,]","magdalena"
"1471041731891","treat_bs=treat[id]","magdalena"
"1471041731891","for (k in 1","magdalena"
"s){","","magdalena"
"1471041731907","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471041731912","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471041731916","}","magdalena"
"1471041731920","}","magdalena"
"1471041886056","","magdalena"
"1471041886057","alpha=c(0.95,0.975,0.995)","magdalena"
"1471041886057","","magdalena"
"1471041886057","reject_adjust=rep(,s)","magdalena"
"1471041886057","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471041886073","t_hat_aux=t_hat","magdalena"
"1471041886073","t_bs_aux=t_bs","magdalena"
"1471041886073","done=F","magdalena"
"1471041886073","while(done==F){","magdalena"
"1471041886073","t_max=max(t_hat_aux)","magdalena"
"1471041886073","k=which(t_hat_aux==t_max)","magdalena"
"1471041886088","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471041886088","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471041886088","}","magdalena"
"1471041886088","if(is.null(dim(t_bs_aux))){","magdalena"
"1471041886104","t_bs_max=t_bs_aux","magdalena"
"1471041886104","}","magdalena"
"1471041886104","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471041886104","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471041886120","k_orig=which(t_hat==t_max)","magdalena"
"1471041886120","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471041886120","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471041886120","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471041886120","print(k_orig)","magdalena"
"1471041886135","}","magdalena"
"1471041886135","if(is.null(dim(t_bs_aux))){","magdalena"
"1471041886135","t_bs_max=t_bs_aux","magdalena"
"1471041886151","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471041886156","t_max=max(t_hat_aux)","magdalena"
"1471041886157","}","magdalena"
"1471041886157","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471041886157","if(t_max>=t_quantile){","magdalena"
"1471041886172","k_orig=which(t_hat==t_max)","magdalena"
"1471041886172","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471041886172","}","magdalena"
"1471041886188","done=T","magdalena"
"1471041886188","}","magdalena"
"1471041886188","}","magdalena"
"1471041886188","}","magdalena"
"1471041886274","reject_adjust[reject_adjust==]=No","magdalena"
"1471041886274","","magdalena"
"1471041886290","beta_hat","magdalena"
"1471041886290","","magdalena"
"1471041886290","reject_unadjust","magdalena"
"1471041886290","","magdalena"
"1471041886305","reject_adjust","magdalena"
"1471041899636","","magdalena"
"1471041899641","","magdalena"
"1471041899645","","magdalena"
"1471041899649","","magdalena"
"1471041899652","","magdalena"
"1471041899657","","magdalena"
"1471041899661","rm(list = ls())","magdalena"
"1471041899667","","magdalena"
"1471041899671","cat(\014)","magdalena"
"1471041899678","","magdalena"
"1471041899684","","magdalena"
"1471041899687","","magdalena"
"1471041899691","","magdalena"
"1471041899694","n = 1000","magdalena"
"1471041899698","","magdalena"
"1471041899701","s = 10","magdalena"
"1471041899706","","magdalena"
"1471041899707","beta = rep(0,s)","magdalena"
"1471041899707","","magdalena"
"1471041899707","beta[1]=0.5","magdalena"
"1471041899707","beta[5]=5","magdalena"
"1471041899722","","magdalena"
"1471041899722","prob=0.1","magdalena"
"1471041899722","treat=rbinom(n,1,prob)","magdalena"
"1471041899722","","magdalena"
"1471041899738","for (i in 1","magdalena"
"s){","","magdalena"
"1471041899738","y=beta[i]*treat+rnorm(n)","magdalena"
"1471041899738","if (i==1){","magdalena"
"1471041899738","y_mat=y","magdalena"
"1471041899738","}","magdalena"
"1471041899738","if (i>1){","magdalena"
"1471041899756","y_mat=cbind(y_mat,y)","magdalena"
"1471041899758","}","magdalena"
"1471041899761","}","magdalena"
"1471041899769","","magdalena"
"1471041899769","","magdalena"
"1471041899769","","magdalena"
"1471041899769","","magdalena"
"1471041899769","","magdalena"
"1471041899785","","magdalena"
"1471041899785","beta_hat=rep(NA,s)","magdalena"
"1471041899785","t_hat=rep(NA,s)","magdalena"
"1471041899785","reject_unadjust=rep(,s)","magdalena"
"1471041899800","for (i in 1","magdalena"
"s){","","magdalena"
"1471041899800","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471041899800","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471041899800","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471041899816","reject_unadjust[i]=No","magdalena"
"1471041899816","}","magdalena"
"1471041899816","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471041899816","reject_unadjust[i]=90","magdalena"
"1471041899816","}","magdalena"
"1471041899832","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471041899832","reject_unadjust[i]=95","magdalena"
"1471041899832","}","magdalena"
"1471041899847","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471041899847","reject_unadjust[i]=99","magdalena"
"1471041899847","}","magdalena"
"1471041899847","}","magdalena"
"1471041900617","","magdalena"
"1471041900623","","magdalena"
"1471041900628","B=1000","magdalena"
"1471041900634","beta_bs=matrix(NA,B,s)","magdalena"
"1471041900640","t_bs=matrix(NA,B,s)","magdalena"
"1471041900647","for (i in 1","magdalena"
"B){","","magdalena"
"1471041900652","","magdalena"
"1471041900657","","magdalena"
"1471041900664","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471041900671","y_mat_bs=y_mat[id,]","magdalena"
"1471041900676","treat_bs=treat[id]","magdalena"
"1471041900682","for (k in 1","magdalena"
"s){","","magdalena"
"1471041900687","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471041900692","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471041900697","}","magdalena"
"1471041900702","}","magdalena"
"1471042061277","","magdalena"
"1471042061282","alpha=c(0.95,0.975,0.995)","magdalena"
"1471042061287","","magdalena"
"1471042061291","reject_adjust=rep(,s)","magdalena"
"1471042061295","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471042061299","t_hat_aux=t_hat","magdalena"
"1471042061302","t_bs_aux=t_bs","magdalena"
"1471042061305","done=F","magdalena"
"1471042061309","while(done==F){","magdalena"
"1471042061313","t_max=max(t_hat_aux)","magdalena"
"1471042061317","k=which(t_hat_aux==t_max)","magdalena"
"1471042061323","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471042061328","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471042061332","}","magdalena"
"1471042061336","if(is.null(dim(t_bs_aux))){","magdalena"
"1471042061341","t_bs_max=t_bs_aux","magdalena"
"1471042061346","}","magdalena"
"1471042061352","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471042061358","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471042061363","k_orig=which(t_hat==t_max)","magdalena"
"1471042061367","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471042061372","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471042061376","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471042061381","print(k_orig)","magdalena"
"1471042061386","}","magdalena"
"1471042061392","if(is.null(dim(t_bs_aux))){","magdalena"
"1471042061397","t_bs_max=t_bs_aux","magdalena"
"1471042061402","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471042061407","t_max=max(t_hat_aux)","magdalena"
"1471042061412","}","magdalena"
"1471042061419","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471042061424","if(t_max>=t_quantile){","magdalena"
"1471042061428","k_orig=which(t_hat==t_max)","magdalena"
"1471042061433","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471042061439","}","magdalena"
"1471042061444","done=T","magdalena"
"1471042061449","}","magdalena"
"1471042061454","}","magdalena"
"1471042061459","}","magdalena"
"1471042061605","reject_adjust[reject_adjust==]=No","magdalena"
"1471042061611","","magdalena"
"1471042061615","beta_hat","magdalena"
"1471042061623","","magdalena"
"1471042061627","reject_unadjust","magdalena"
"1471042061635","","magdalena"
"1471042061639","reject_adjust","magdalena"
"1471045486896","","magdalena"
"1471045486906","","magdalena"
"1471045486910","","magdalena"
"1471045486911","","magdalena"
"1471045486911","","magdalena"
"1471045486911","rm(list = ls())","magdalena"
"1471045486928","","magdalena"
"1471045486932","cat(\014)","magdalena"
"1471045486932","library(designmatch)","magdalena"
"1471045487432","library(foreign)","magdalena"
"1471045487499","library(Rglpk)","magdalena"
"1471045487503","library(gurobi)","magdalena"
"1471045490695","","magdalena"
"1471045490710","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/edquake/matching/01_iwas_2015/01_iwas_2015)","magdalena"
"1471045490710","source(constraintmatrix.r)","magdalena"
"1471045490726","source(problemparameters.r)","magdalena"
"1471045490747","source(bpmatch.r)","magdalena"
"1471045490763","source(errorhandling.r)","magdalena"
"1471045490783","source(useful_functions.r)","magdalena"
"1471045490792","source(finetab.r)","magdalena"
"1471045490808","","magdalena"
"1471045490808","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/Colegios)","magdalena"
"1471045490808","data = read.dta(students_qparents_2009-2013_8thgrade_4th.dta)","magdalena"
"1471045524035","load(160812_template_no_simce.RData)","magdalena"
"1471045540178","load(160812_schools_d_match_1_without_simce.RData)","magdalena"
"1471045546545","cat(\n, * Number of schools matches: , length(table(d_match$rbd[d_match$treat==0])), sep = )","magdalena"
"1471045562154","load(160812_template_with_simce.RData)","magdalena"
"1471045569127","load(160812_schools_d_match_1_with_simce.RData)","magdalena"
"1471045572012","cat(\n, * Number of schools matches: , length(table(d_match$rbd[d_match$treat==0])), sep = )","magdalena"
"1471289336057","","magdalena"
"1471289336057","","magdalena"
"1471289336073","","magdalena"
"1471289336073","","magdalena"
"1471289336073","","magdalena"
"1471289336073","","magdalena"
"1471289336073","rm(list = ls())","magdalena"
"1471289336088","","magdalena"
"1471289336088","cat(\014)","magdalena"
"1471289336088","","magdalena"
"1471289336105","","magdalena"
"1471289336107","","magdalena"
"1471289336107","","magdalena"
"1471289336107","n = 1000","magdalena"
"1471289336107","","magdalena"
"1471289336107","s = 10","magdalena"
"1471289336122","","magdalena"
"1471289336122","beta = rep(0,s)","magdalena"
"1471289336122","","magdalena"
"1471289336122","beta[1]=1","magdalena"
"1471289336138","beta[2]=1","magdalena"
"1471289336138","beta[10]=1","magdalena"
"1471289336138","","magdalena"
"1471289336154","prob=0.1","magdalena"
"1471289336154","treat=rbinom(n,1,prob)","magdalena"
"1471289336154","","magdalena"
"1471289336169","for (i in 1","magdalena"
"s){","","magdalena"
"1471289336169","y=beta[i]*treat+rnorm(n)","magdalena"
"1471289336169","if (i==1){","magdalena"
"1471289336169","y_mat=y","magdalena"
"1471289336185","}","magdalena"
"1471289336185","if (i>1){","magdalena"
"1471289336185","y_mat=cbind(y_mat,y)","magdalena"
"1471289336185","}","magdalena"
"1471289336204","}","magdalena"
"1471289336207","","magdalena"
"1471289336223","","magdalena"
"1471289336223","","magdalena"
"1471289336223","","magdalena"
"1471289336223","","magdalena"
"1471289336238","","magdalena"
"1471289336238","beta_hat=rep(NA,s)","magdalena"
"1471289336238","t_hat=rep(NA,s)","magdalena"
"1471289336254","reject_unadjust=rep(,s)","magdalena"
"1471289336254","for (i in 1","magdalena"
"s){","","magdalena"
"1471289336254","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471289336270","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471289336270","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471289336270","reject_unadjust[i]=No","magdalena"
"1471289336285","}","magdalena"
"1471289336285","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471289336285","reject_unadjust[i]=90","magdalena"
"1471289336302","}","magdalena"
"1471289336308","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471289336312","reject_unadjust[i]=95","magdalena"
"1471289336316","}","magdalena"
"1471289336322","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471289336326","reject_unadjust[i]=99","magdalena"
"1471289336333","}","magdalena"
"1471289336337","}","magdalena"
"1471289337194","","magdalena"
"1471289337194","","magdalena"
"1471289337210","B=1000","magdalena"
"1471289337210","beta_bs=matrix(NA,B,s)","magdalena"
"1471289337210","t_bs=matrix(NA,B,s)","magdalena"
"1471289337225","for (i in 1","magdalena"
"B){","","magdalena"
"1471289337225","","magdalena"
"1471289337225","","magdalena"
"1471289337241","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471289337241","y_mat_bs=y_mat[id,]","magdalena"
"1471289337241","treat_bs=treat[id]","magdalena"
"1471289337257","for (k in 1","magdalena"
"s){","","magdalena"
"1471289337257","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471289337273","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471289337277","}","magdalena"
"1471289337279","}","magdalena"
"1471289556118","","magdalena"
"1471289556124","alpha=c(0.95,0.975,0.995)","magdalena"
"1471289556130","","magdalena"
"1471289556138","reject_adjust=rep(,s)","magdalena"
"1471289556145","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471289556159","t_hat_aux=t_hat","magdalena"
"1471289556165","t_bs_aux=t_bs","magdalena"
"1471289556170","done=F","magdalena"
"1471289556185","while(done==F){","magdalena"
"1471289556190","t_max=max(t_hat_aux)","magdalena"
"1471289556195","k=which(t_hat_aux==t_max)","magdalena"
"1471289556206","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471289556214","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471289556226","}","magdalena"
"1471289556231","if(is.null(dim(t_bs_aux))){","magdalena"
"1471289556237","t_bs_max=t_bs_aux","magdalena"
"1471289556242","}","magdalena"
"1471289556261","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471289556270","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471289556276","k_orig=which(t_hat==t_max)","magdalena"
"1471289556281","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471289556292","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471289556297","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471289556312","print(k_orig)","magdalena"
"1471289556319","}","magdalena"
"1471289556326","if(is.null(dim(t_bs_aux))){","magdalena"
"1471289556331","t_bs_max=t_bs_aux","magdalena"
"1471289556337","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471289556342","t_max=max(t_hat_aux)","magdalena"
"1471289556347","}","magdalena"
"1471289556354","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471289556359","if(t_max>=t_quantile){","magdalena"
"1471289556370","k_orig=which(t_hat==t_max)","magdalena"
"1471289556382","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471289556389","}","magdalena"
"1471289556397","done=T","magdalena"
"1471289556405","}","magdalena"
"1471289556413","}","magdalena"
"1471289556428","}","magdalena"
"1471289556709","reject_adjust[reject_adjust==]=No","magdalena"
"1471289556723","","magdalena"
"1471289556729","beta_hat","magdalena"
"1471289556738","","magdalena"
"1471289556742","reject_unadjust","magdalena"
"1471289556755","","magdalena"
"1471289556760","reject_adjust","magdalena"
"1471293117175","","magdalena"
"1471293117175","","magdalena"
"1471293117175","","magdalena"
"1471293117175","","magdalena"
"1471293117191","","magdalena"
"1471293117193","","magdalena"
"1471293117193","rm(list = ls())","magdalena"
"1471293117193","","magdalena"
"1471293117193","cat(\014)","magdalena"
"1471293117208","","magdalena"
"1471293117208","","magdalena"
"1471293117224","","magdalena"
"1471293117224","","magdalena"
"1471293117224","n = 1000","magdalena"
"1471293117224","","magdalena"
"1471293117240","s = 11","magdalena"
"1471293117244","","magdalena"
"1471293117247","beta = rep(0,s)","magdalena"
"1471293117252","","magdalena"
"1471293117256","beta[1]=0.5","magdalena"
"1471293117261","beta[2]=0","magdalena"
"1471293117265","beta[10]=0","magdalena"
"1471293117271","","magdalena"
"1471293117275","prob=0.1","magdalena"
"1471293117280","treat=rbinom(n,1,prob)","magdalena"
"1471293117285","","magdalena"
"1471293117288","for (i in 1","magdalena"
"s){","","magdalena"
"1471293117292","y=beta[i]*treat+rnorm(n)","magdalena"
"1471293117297","if (i==1){","magdalena"
"1471293117301","y_mat=y","magdalena"
"1471293117306","}","magdalena"
"1471293117311","if (i>1){","magdalena"
"1471293117315","y_mat=cbind(y_mat,y)","magdalena"
"1471293117319","}","magdalena"
"1471293117323","}","magdalena"
"1471293117338","","magdalena"
"1471293117342","","magdalena"
"1471293117347","","magdalena"
"1471293117351","","magdalena"
"1471293117356","","magdalena"
"1471293117360","","magdalena"
"1471293117364","beta_hat=rep(NA,s)","magdalena"
"1471293117368","t_hat=rep(NA,s)","magdalena"
"1471293117371","reject_unadjust=rep(,s)","magdalena"
"1471293117376","for (i in 1","magdalena"
"s){","","magdalena"
"1471293117381","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471293117385","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471293117390","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471293117398","reject_unadjust[i]=No","magdalena"
"1471293117405","}","magdalena"
"1471293117412","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471293117417","reject_unadjust[i]=90","magdalena"
"1471293117422","}","magdalena"
"1471293117427","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471293117428","reject_unadjust[i]=95","magdalena"
"1471293117428","}","magdalena"
"1471293117428","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471293117443","reject_unadjust[i]=99","magdalena"
"1471293117443","}","magdalena"
"1471293117443","}","magdalena"
"1471293118394","","magdalena"
"1471293118399","","magdalena"
"1471293118403","B=1000","magdalena"
"1471293118407","beta_bs=matrix(NA,B,s)","magdalena"
"1471293118412","t_bs=matrix(NA,B,s)","magdalena"
"1471293118418","for (i in 1","magdalena"
"B){","","magdalena"
"1471293118422","","magdalena"
"1471293118426","","magdalena"
"1471293118430","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471293118434","y_mat_bs=y_mat[id,]","magdalena"
"1471293118437","treat_bs=treat[id]","magdalena"
"1471293118441","for (k in 1","magdalena"
"s){","","magdalena"
"1471293118445","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471293118450","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471293118454","}","magdalena"
"1471293118459","}","magdalena"
"1471293328397","","magdalena"
"1471293328397","alpha=c(0.95,0.975,0.995)","magdalena"
"1471293328397","","magdalena"
"1471293328397","reject_adjust=rep(,s)","magdalena"
"1471293328412","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471293328412","t_hat_aux=t_hat","magdalena"
"1471293328412","t_bs_aux=t_bs","magdalena"
"1471293328412","done=F","magdalena"
"1471293328412","while(done==F){","magdalena"
"1471293328428","t_max=max(t_hat_aux)","magdalena"
"1471293328428","k=which(t_hat_aux==t_max)","magdalena"
"1471293328428","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471293328443","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471293328443","}","magdalena"
"1471293328443","if(is.null(dim(t_bs_aux))){","magdalena"
"1471293328443","t_bs_max=t_bs_aux","magdalena"
"1471293328443","}","magdalena"
"1471293328461","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471293328465","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471293328466","k_orig=which(t_hat==t_max)","magdalena"
"1471293328466","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471293328466","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471293328466","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471293328481","print(k_orig)","magdalena"
"1471293328481","}","magdalena"
"1471293328481","if(is.null(dim(t_bs_aux))){","magdalena"
"1471293328481","t_bs_max=t_bs_aux","magdalena"
"1471293328481","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471293328497","t_max=max(t_hat_aux)","magdalena"
"1471293328497","}","magdalena"
"1471293328497","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471293328497","if(t_max>=t_quantile){","magdalena"
"1471293328512","k_orig=which(t_hat==t_max)","magdalena"
"1471293328512","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471293328512","}","magdalena"
"1471293328528","done=T","magdalena"
"1471293328528","}","magdalena"
"1471293328528","}","magdalena"
"1471293328528","}","magdalena"
"1471293328581","reject_adjust[reject_adjust==]=No","magdalena"
"1471293328597","","magdalena"
"1471293328597","beta_hat","magdalena"
"1471293328597","","magdalena"
"1471293328597","reject_unadjust","magdalena"
"1471293328597","","magdalena"
"1471293328612","reject_adjust","magdalena"
"1471295288862","","magdalena"
"1471295288868","","magdalena"
"1471295288873","","magdalena"
"1471295288878","","magdalena"
"1471295288883","","magdalena"
"1471295288888","","magdalena"
"1471295288895","rm(list = ls())","magdalena"
"1471295288904","","magdalena"
"1471295288910","cat(\014)","magdalena"
"1471295288932","","magdalena"
"1471295288938","","magdalena"
"1471295288943","","magdalena"
"1471295288949","","magdalena"
"1471295288954","n = 1000","magdalena"
"1471295288961","","magdalena"
"1471295288966","s = 11","magdalena"
"1471295288972","","magdalena"
"1471295288977","beta = rep(0,s)","magdalena"
"1471295288983","","magdalena"
"1471295288987","beta[1]=0.5","magdalena"
"1471295288993","beta[2]=0","magdalena"
"1471295288999","beta[10]=0","magdalena"
"1471295289007","","magdalena"
"1471295289012","prob=0.1","magdalena"
"1471295289021","treat=rbinom(n,1,prob)","magdalena"
"1471295289030","","magdalena"
"1471295289045","for (i in 1","magdalena"
"s){","","magdalena"
"1471295289052","y=beta[i]*treat+rnorm(n)","magdalena"
"1471295289059","if (i==1){","magdalena"
"1471295289064","y_mat=y","magdalena"
"1471295289070","}","magdalena"
"1471295289075","if (i>1){","magdalena"
"1471295289079","y_mat=cbind(y_mat,y)","magdalena"
"1471295289084","}","magdalena"
"1471295289089","}","magdalena"
"1471295289108","","magdalena"
"1471295289118","","magdalena"
"1471295289123","","magdalena"
"1471295289128","","magdalena"
"1471295289137","","magdalena"
"1471295289145","","magdalena"
"1471295289157","beta_hat=rep(NA,s)","magdalena"
"1471295289163","t_hat=rep(NA,s)","magdalena"
"1471295289168","reject_unadjust=rep(,s)","magdalena"
"1471295289175","for (i in 1","magdalena"
"s){","","magdalena"
"1471295289180","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471295289185","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471295289191","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471295289196","reject_unadjust[i]=No","magdalena"
"1471295289201","}","magdalena"
"1471295289209","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471295289214","reject_unadjust[i]=90","magdalena"
"1471295289219","}","magdalena"
"1471295289226","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471295289230","reject_unadjust[i]=95","magdalena"
"1471295289235","}","magdalena"
"1471295289242","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471295289247","reject_unadjust[i]=99","magdalena"
"1471295289251","}","magdalena"
"1471295289256","}","magdalena"
"1471295290242","","magdalena"
"1471295290245","","magdalena"
"1471295290245","B=1000","magdalena"
"1471295290245","beta_bs=matrix(NA,B,s)","magdalena"
"1471295290245","t_bs=matrix(NA,B,s)","magdalena"
"1471295290269","for (i in 1","magdalena"
"B){","","magdalena"
"1471295290275","","magdalena"
"1471295290280","","magdalena"
"1471295290286","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471295290290","y_mat_bs=y_mat[id,]","magdalena"
"1471295290294","treat_bs=treat[id]","magdalena"
"1471295290301","for (k in 1","magdalena"
"s){","","magdalena"
"1471295290306","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471295290311","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471295290319","}","magdalena"
"1471295290324","}","magdalena"
"1471295522475","","magdalena"
"1471295522479","alpha=c(0.95,0.975,0.995)","magdalena"
"1471295522482","","magdalena"
"1471295522486","reject_adjust=rep(,s)","magdalena"
"1471295522492","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471295522500","t_hat_aux=t_hat","magdalena"
"1471295522507","t_bs_aux=t_bs","magdalena"
"1471295522510","done=F","magdalena"
"1471295522516","while(done==F){","magdalena"
"1471295522519","t_max=max(t_hat_aux)","magdalena"
"1471295522523","k=which(t_hat_aux==t_max)","magdalena"
"1471295522528","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471295522537","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471295522542","}","magdalena"
"1471295522547","if(is.null(dim(t_bs_aux))){","magdalena"
"1471295522552","t_bs_max=t_bs_aux","magdalena"
"1471295522558","}","magdalena"
"1471295522564","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471295522574","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471295522579","k_orig=which(t_hat==t_max)","magdalena"
"1471295522583","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471295522587","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471295522591","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471295522595","print(k_orig)","magdalena"
"1471295522603","}","magdalena"
"1471295522610","if(is.null(dim(t_bs_aux))){","magdalena"
"1471295522618","t_bs_max=t_bs_aux","magdalena"
"1471295522628","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471295522638","t_max=max(t_hat_aux)","magdalena"
"1471295522643","}","magdalena"
"1471295522648","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471295522651","if(t_max>=t_quantile){","magdalena"
"1471295522654","k_orig=which(t_hat==t_max)","magdalena"
"1471295522660","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471295522671","}","magdalena"
"1471295522677","done=T","magdalena"
"1471295522681","}","magdalena"
"1471295522684","}","magdalena"
"1471295522689","}","magdalena"
"1471295522786","reject_adjust[reject_adjust==]=No","magdalena"
"1471295522791","","magdalena"
"1471295522795","beta_hat","magdalena"
"1471295522807","","magdalena"
"1471295522811","reject_unadjust","magdalena"
"1471295522821","","magdalena"
"1471295522827","reject_adjust","magdalena"
"1471296374286","","magdalena"
"1471296374291","","magdalena"
"1471296374294","","magdalena"
"1471296374297","","magdalena"
"1471296374300","","magdalena"
"1471296374303","","magdalena"
"1471296374306","rm(list = ls())","magdalena"
"1471296374311","","magdalena"
"1471296374315","cat(\014)","magdalena"
"1471296374320","","magdalena"
"1471296374324","","magdalena"
"1471296374327","","magdalena"
"1471296374331","","magdalena"
"1471296374334","n = 1000","magdalena"
"1471296374339","","magdalena"
"1471296374342","s = 11","magdalena"
"1471296374346","","magdalena"
"1471296374350","beta = rep(0,s)","magdalena"
"1471296374353","","magdalena"
"1471296374356","beta[1]=0.5","magdalena"
"1471296374360","beta[2]=0","magdalena"
"1471296374365","beta[10]=0","magdalena"
"1471296374370","","magdalena"
"1471296374374","prob=0.1","magdalena"
"1471296374378","treat=rbinom(n,1,prob)","magdalena"
"1471296374382","","magdalena"
"1471296374386","for (i in 1","magdalena"
"s){","","magdalena"
"1471296374390","y=beta[i]*treat+rnorm(n)","magdalena"
"1471296374394","if (i==1){","magdalena"
"1471296374397","y_mat=y","magdalena"
"1471296374400","}","magdalena"
"1471296374404","if (i>1){","magdalena"
"1471296374408","y_mat=cbind(y_mat,y)","magdalena"
"1471296374412","}","magdalena"
"1471296374415","}","magdalena"
"1471296374425","","magdalena"
"1471296374428","","magdalena"
"1471296374431","","magdalena"
"1471296374434","","magdalena"
"1471296374439","","magdalena"
"1471296374444","","magdalena"
"1471296374448","beta_hat=rep(NA,s)","magdalena"
"1471296374452","t_hat=rep(NA,s)","magdalena"
"1471296374457","reject_unadjust=rep(,s)","magdalena"
"1471296374462","for (i in 1","magdalena"
"s){","","magdalena"
"1471296374466","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471296374470","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471296374477","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471296374481","reject_unadjust[i]=No","magdalena"
"1471296374484","}","magdalena"
"1471296374490","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471296374495","reject_unadjust[i]=90","magdalena"
"1471296374499","}","magdalena"
"1471296374505","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471296374510","reject_unadjust[i]=95","magdalena"
"1471296374513","}","magdalena"
"1471296374519","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471296374523","reject_unadjust[i]=99","magdalena"
"1471296374527","}","magdalena"
"1471296374531","}","magdalena"
"1471296375175","","magdalena"
"1471296375180","","magdalena"
"1471296375184","B=1000","magdalena"
"1471296375190","beta_bs=matrix(NA,B,s)","magdalena"
"1471296375195","t_bs=matrix(NA,B,s)","magdalena"
"1471296375201","for (i in 1","magdalena"
"B){","","magdalena"
"1471296375205","","magdalena"
"1471296375209","","magdalena"
"1471296375213","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471296375217","y_mat_bs=y_mat[id,]","magdalena"
"1471296375220","treat_bs=treat[id]","magdalena"
"1471296375224","for (k in 1","magdalena"
"s){","","magdalena"
"1471296375228","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471296375232","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471296375236","}","magdalena"
"1471296375241","}","magdalena"
"1471296597420","","magdalena"
"1471296597425","alpha=c(0.95,0.975,0.995)","magdalena"
"1471296597429","","magdalena"
"1471296597432","reject_adjust=rep(,s)","magdalena"
"1471296597445","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471296597458","t_hat_aux=t_hat","magdalena"
"1471296597463","t_bs_aux=t_bs","magdalena"
"1471296597466","done=F","magdalena"
"1471296597470","while(done==F){","magdalena"
"1471296597475","t_max=max(t_hat_aux)","magdalena"
"1471296597486","k=which(t_hat_aux==t_max)","magdalena"
"1471296597491","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471296597495","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471296597499","}","magdalena"
"1471296597504","if(is.null(dim(t_bs_aux))){","magdalena"
"1471296597508","t_bs_max=t_bs_aux","magdalena"
"1471296597512","}","magdalena"
"1471296597516","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471296597522","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471296597527","k_orig=which(t_hat==t_max)","magdalena"
"1471296597533","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471296597541","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471296597545","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471296597563","print(k_orig)","magdalena"
"1471296597570","}","magdalena"
"1471296597576","if(is.null(dim(t_bs_aux))){","magdalena"
"1471296597581","t_bs_max=t_bs_aux","magdalena"
"1471296597585","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471296597588","t_max=max(t_hat_aux)","magdalena"
"1471296597591","}","magdalena"
"1471296597596","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471296597600","if(t_max>=t_quantile){","magdalena"
"1471296597615","k_orig=which(t_hat==t_max)","magdalena"
"1471296597622","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471296597628","}","magdalena"
"1471296597633","done=T","magdalena"
"1471296597638","}","magdalena"
"1471296597642","}","magdalena"
"1471296597648","}","magdalena"
"1471296597723","reject_adjust[reject_adjust==]=No","magdalena"
"1471296597728","","magdalena"
"1471296597739","beta_hat","magdalena"
"1471296597750","","magdalena"
"1471296597755","reject_unadjust","magdalena"
"1471296597761","","magdalena"
"1471296597766","reject_adjust","magdalena"
"1471360947347","","magdalena"
"1471360947347","","magdalena"
"1471360947347","","magdalena"
"1471360947362","","magdalena"
"1471360947362","","magdalena"
"1471360947362","rm(list = ls())","magdalena"
"1471360947416","","magdalena"
"1471360947416","cat(\014)","magdalena"
"1471360947432","library(designmatch)","magdalena"
"1471360948251","library(foreign)","magdalena"
"1471360948317","library(Rglpk)","magdalena"
"1471360948317","library(gurobi)","magdalena"
"1471360952167","setwd(/user/user2/mb3863/edquake/functions)","magdalena"
"1471360952167","","magdalena"
"1471360952182","source(constraintmatrix.r)","magdalena"
"1471360952182","source(problemparameters.r)","magdalena"
"1471360952198","source(bpmatch.r)","magdalena"
"1471360952198","source(errorhandling.r)","magdalena"
"1471360952214","source(useful_functions.r)","magdalena"
"1471360952214","source(finetab.r)","magdalena"
"1471360952214","setwd(/user/user2/mb3863/Colegios)","magdalena"
"1471360952229","","magdalena"
"1471360952229","data = read.dta(students_qparents_2008-2013_10thgrade.dta)","magdalena"
"1471361007695","","magdalena"
"1471361007700","","magdalena"
"1471361007703","","magdalena"
"1471361007706","","magdalena"
"1471361007710","","magdalena"
"1471361007714","rm(list = ls())","magdalena"
"1471361007720","","magdalena"
"1471361007721","cat(\014)","magdalena"
"1471361007721","library(designmatch)","magdalena"
"1471361007721","library(foreign)","magdalena"
"1471361007737","library(Rglpk)","magdalena"
"1471361007737","library(gurobi)","magdalena"
"1471361007737","","magdalena"
"1471361007752","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/edquake/matching/01_iwas_2015/01_iwas_2015)","magdalena"
"1471361007752","source(constraintmatrix.r)","magdalena"
"1471361007784","source(problemparameters.r)","magdalena"
"1471361007799","source(bpmatch.r)","magdalena"
"1471361007820","source(errorhandling.r)","magdalena"
"1471361007821","source(useful_functions.r)","magdalena"
"1471361007837","source(finetab.r)","magdalena"
"1471361007862","","magdalena"
"1471361007867","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/Colegios)","magdalena"
"1471361007873","data = read.dta(students_qparents_2008-2013_10thgrade.dta)","magdalena"
"1471361030940","load(160815_schools_d_match_1)","magdalena"
"1471361035298","load(160815_schools_d_match_1.RData)","magdalena"
"1471361048176","load(160815_template.RData)","magdalena"
"1471361073406","table(id_rbd_more_min)","magdalena"
"1471361098536","","magdalena"
"1471361098539","table(data$rbd)","magdalena"
"1471361101768","min=150","magdalena"
"1471361101774","id_rbd_more_min<-as.numeric(row.names(table(data$rbd)[table(data$rbd)>=min]))","magdalena"
"1471361105515","table(id_rbd_more_min)","magdalena"
"1471361110591","table(id_rbd_more_min)","magdalena"
"1471361125766","for (i in 1","magdalena"
"length(row.names(table(d_match$rbd[d_match$treat==0])))){","","magdalena"
"1471361125767","aux=row.names(table(d_match$rbd[d_match$treat==0]))[i]","magdalena"
"1471361125767","matched_150[id_rbd_more_min==aux]=1","magdalena"
"1471361125767","}","magdalena"
"1471361132767","matched_150=rep(0,length(id_rbd_more_min))","magdalena"
"1471361132768","for (i in 1","magdalena"
"length(row.names(table(d_match$rbd[d_match$treat==0])))){","","magdalena"
"1471361132768","aux=row.names(table(d_match$rbd[d_match$treat==0]))[i]","magdalena"
"1471361132768","matched_150[id_rbd_more_min==aux]=1","magdalena"
"1471361132768","}","magdalena"
"1471361149998","unmatched_schools=id_rbd_more_min[matched_150==0]","magdalena"
"1471361159668","length(unmatched_schools)","magdalena"
"1471383658180","","magdalena"
"1471383658189","","magdalena"
"1471383658192","","magdalena"
"1471383658195","","magdalena"
"1471383658199","","magdalena"
"1471383658202","rm(list = ls())","magdalena"
"1471383658208","","magdalena"
"1471383658208","cat(\014)","magdalena"
"1471383658208","library(designmatch)","magdalena"
"1471383658923","library(foreign)","magdalena"
"1471383659017","library(Rglpk)","magdalena"
"1471383659017","library(gurobi)","magdalena"
"1471383662773","","magdalena"
"1471383662789","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/edquake/matching/01_iwas_2015/01_iwas_2015)","magdalena"
"1471383662794","source(constraintmatrix.r)","magdalena"
"1471383662823","source(problemparameters.r)","magdalena"
"1471383662844","source(bpmatch.r)","magdalena"
"1471383662862","source(errorhandling.r)","magdalena"
"1471383662862","source(useful_functions.r)","magdalena"
"1471383662878","source(finetab.r)","magdalena"
"1471383662894","","magdalena"
"1471383662894","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/Colegios)","magdalena"
"1471383662894","data = read.dta(students_qparents_2008-2013_10thgrade.dta)","magdalena"
"1471383673598","","magdalena"
"1471383673603","data<-cbind(1","magdalena"
"nrow(data), data)","","magdalena"
"1471383674865","colnames(data)[1]<-id","magdalena"
"1471383738810","load(160815_template.RData)","magdalena"
"1471383741974","load(160815_schools_d_match_1.RData)","magdalena"
"1471383742093","min=150","magdalena"
"1471383742093","id_rbd_more_min<-as.numeric(row.names(table(data$rbd)[table(data$rbd)>=min]))","magdalena"
"1471383745645","matched_150=rep(0,length(id_rbd_more_min))","magdalena"
"1471383745665","for (i in 1","magdalena"
"length(row.names(table(d_match$rbd[d_match$treat==0])))){","","magdalena"
"1471383745668","aux=row.names(table(d_match$rbd[d_match$treat==0]))[i]","magdalena"
"1471383745671","matched_150[id_rbd_more_min==aux]=1","magdalena"
"1471383745675","}","magdalena"
"1471383749853","unmatched_schools=id_rbd_more_min[matched_150==0]","magdalena"
"1471383755243","save(d,template,comparison,d_match, id_rbd_more_min,","magdalena"
"1471383755243","unmatched_schools, file=160816_schools_unmatched.RData)","magdalena"
"1471383781464","save(data, d_match,template,comparison,d_match, id_rbd_more_min,","magdalena"
"1471383781464","unmatched_schools, file=160816_schools_unmatched.RData)","magdalena"
"1471383923190","","magdalena"
"1471383923198","","magdalena"
"1471383923201","","magdalena"
"1471383923205","","magdalena"
"1471383923205","","magdalena"
"1471383923205","rm(list = ls())","magdalena"
"1471383923205","","magdalena"
"1471383923221","cat(\014)","magdalena"
"1471383923221","library(designmatch)","magdalena"
"1471383923221","library(foreign)","magdalena"
"1471383923237","library(Rglpk)","magdalena"
"1471383923237","library(gurobi)","magdalena"
"1471383923252","","magdalena"
"1471383923252","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/edquake/matching/01_iwas_2015/01_iwas_2015)","magdalena"
"1471383923252","source(constraintmatrix.r)","magdalena"
"1471383923283","source(problemparameters.r)","magdalena"
"1471383923306","source(bpmatch.r)","magdalena"
"1471383923321","source(errorhandling.r)","magdalena"
"1471383923337","source(useful_functions.r)","magdalena"
"1471383923371","source(finetab.r)","magdalena"
"1471383923380","","magdalena"
"1471383923380","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/Colegios)","magdalena"
"1471383923397","data = read.dta(students_qparents_2009-2013_8thgrade_4th.dta)","magdalena"
"1471383952768","","magdalena"
"1471383952772","load(160812_template_no_simce.RData)","magdalena"
"1471383955289","load(160812_schools_d_match_1_without_simce.RData)","magdalena"
"1471383955305","min=150","magdalena"
"1471383955321","id_rbd_more_min<-as.numeric(row.names(table(data$rbd)[table(data$rbd)>=min]))","magdalena"
"1471383958102","matched_150=rep(0,length(id_rbd_more_min))","magdalena"
"1471383958102","for (i in 1","magdalena"
"length(row.names(table(d_match$rbd[d_match$treat==0])))){","","magdalena"
"1471383958102","aux=row.names(table(d_match$rbd[d_match$treat==0]))[i]","magdalena"
"1471383958102","matched_150[id_rbd_more_min==aux]=1","magdalena"
"1471383958120","}","magdalena"
"1471383958209","unmatched_schools=id_rbd_more_min[matched_150==0]","magdalena"
"1471383958226","save(data, d_match,template,comparison,d_match, id_rbd_more_min,","magdalena"
"1471383958230","unmatched_schools, file=160816_schools_unmatched_without_simce.RData)","magdalena"
"1471383993269","","magdalena"
"1471383993274","","magdalena"
"1471383993278","","magdalena"
"1471383993282","","magdalena"
"1471383993285","","magdalena"
"1471383993288","rm(list = ls())","magdalena"
"1471383993293","","magdalena"
"1471383993293","cat(\014)","magdalena"
"1471383993293","library(designmatch)","magdalena"
"1471383993309","library(foreign)","magdalena"
"1471383993309","library(Rglpk)","magdalena"
"1471383993309","library(gurobi)","magdalena"
"1471383993324","","magdalena"
"1471383993330","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/edquake/matching/01_iwas_2015/01_iwas_2015)","magdalena"
"1471383993335","source(constraintmatrix.r)","magdalena"
"1471383993393","source(problemparameters.r)","magdalena"
"1471383993416","source(bpmatch.r)","magdalena"
"1471383993432","source(errorhandling.r)","magdalena"
"1471383993441","source(useful_functions.r)","magdalena"
"1471383993458","source(finetab.r)","magdalena"
"1471383993468","","magdalena"
"1471383993475","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/Colegios)","magdalena"
"1471383993489","data = read.dta(students_qparents_2009-2013_8thgrade_4th.dta)","magdalena"
"1471384030351","load(160812_template_with_simce.RData)","magdalena"
"1471384032714","load(160812_schools_d_match_1_with_simce.RData)","magdalena"
"1471384032749","min=150","magdalena"
"1471384032749","id_rbd_more_min<-as.numeric(row.names(table(data$rbd)[table(data$rbd)>=min]))","magdalena"
"1471384036210","matched_150=rep(0,length(id_rbd_more_min))","magdalena"
"1471384036216","for (i in 1","magdalena"
"length(row.names(table(d_match$rbd[d_match$treat==0])))){","","magdalena"
"1471384036219","aux=row.names(table(d_match$rbd[d_match$treat==0]))[i]","magdalena"
"1471384036220","matched_150[id_rbd_more_min==aux]=1","magdalena"
"1471384036220","}","magdalena"
"1471384036360","unmatched_schools=id_rbd_more_min[matched_150==0]","magdalena"
"1471384036360","save(data, d_match,template,comparison,d_match, id_rbd_more_min,","magdalena"
"1471384036360","unmatched_schools, file=160816_schools_unmatched_with_simce.RData)","magdalena"
"1471447412897","","magdalena"
"1471447412904","","magdalena"
"1471447412909","","magdalena"
"1471447412914","","magdalena"
"1471447412919","","magdalena"
"1471447412924","rm(list = ls())","magdalena"
"1471447412937","","magdalena"
"1471447412942","cat(\014)","magdalena"
"1471447412949","library(designmatch)","magdalena"
"1471447414405","library(foreign)","magdalena"
"1471447414511","library(Rglpk)","magdalena"
"1471447414518","library(gurobi)","magdalena"
"1471447421153","library(xtable)","magdalena"
"1471447421263","","magdalena"
"1471447421268","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/edquake/matching/01_iwas_2015/01_iwas_2015)","magdalena"
"1471447421276","source(constraintmatrix.r)","magdalena"
"1471447421308","source(problemparameters.r)","magdalena"
"1471447421330","source(bpmatch.r)","magdalena"
"1471447421358","source(errorhandling.r)","magdalena"
"1471447421369","source(useful_functions.r)","magdalena"
"1471447421395","source(finetab.r)","magdalena"
"1471447421411","","magdalena"
"1471447421416","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/Colegios)","magdalena"
"1471447421423","load(160816_schools_unmatched.RData)","magdalena"
"1471447431243","finetab_cov = rep(NA,18)","magdalena"
"1471447431248","d_unmatch = rep(NA, ncol(d)+6)","magdalena"
"1471447431274","count = 0","magdalena"
"1471447431280","t_max_alloc=15","magdalena"
"1471447451949","finetab_cov = rep(NA,18)","magdalena"
"1471447451954","d_unmatch = rep(NA, ncol(data)+6)","magdalena"
"1471447451960","count = 0","magdalena"
"1471447451965","t_max_alloc=15","magdalena"
"1471447480294","i=1","magdalena"
"1471447504669","table(unmatched_schools)","magdalena"
"1471447523138","i=1","magdalena"
"1471447528478","","magdalena"
"1471447528482","d_aux <- data[data$rbd==unmatched_schools[i],]","magdalena"
"1471447543948","","magdalena"
"1471447543952","d_aux$treat<-0","magdalena"
"1471447543956","template$treat<-1","magdalena"
"1471447543960","d_aux<-rbind(d_aux,template)","magdalena"
"1471447543971","","magdalena"
"1471447543974","d_aux = d_aux[order(-d_aux$treat), ]","magdalena"
"1471447543980","","magdalena"
"1471447543983","names(d_aux)","magdalena"
"1471447543992","t_ind<-d_aux$treat","magdalena"
"1471447677640","","magdalena"
"1471447677645","d_aux <- data[data$rbd==unmatched_schools[i],]","magdalena"
"1471447677811","","magdalena"
"1471447677815","d_aux$treat<-0","magdalena"
"1471447677819","template$treat<-1","magdalena"
"1471447677824","d_aux<-rbind(d_aux,template)","magdalena"
"1471447677840","","magdalena"
"1471447677843","d_aux = d_aux[order(-d_aux$treat), ]","magdalena"
"1471447677848","","magdalena"
"1471447677851","names(d_aux)","magdalena"
"1471447677857","t_ind<-d_aux$treat","magdalena"
"1471447677861","","magdalena"
"1471447677865","X_mat=cbind(d_aux$edf_5,d_aux$edm_5,d_aux$inc_hh_7,d_aux$woman_3)","magdalena"
"1471447677868","dist_mat = distmat(t_ind,X_mat)","magdalena"
"1471447678083","subset_weight = 1","magdalena"
"1471447678087","","magdalena"
"1471447678091","","magdalena"
"1471447678096","","magdalena"
"1471447678099","fine_covs = cbind(d_aux$edf_5,d_aux$edm_5,d_aux$inc_hh_7,d_aux$woman_3)","magdalena"
"1471447678104","fine = list(covs = fine_covs)","magdalena"
"1471447678110","names_cov <- c(Father_Education,Mother_Education,Hh_income,Gender)","magdalena"
"1471447678115","colnames(fine_covs)<-names_cov","magdalena"
"1471447678120","","magdalena"
"1471447678124","t_max = 60*t_max_alloc","magdalena"
"1471447678131","","magdalena"
"1471447678134","","magdalena"
"1471447678142","","magdalena"
"1471447678148","","magdalena"
"1471447678153","","magdalena"
"1471447678157","t_max = 60*t_max_alloc","magdalena"
"1471447678162","solver = gurobi","magdalena"
"1471447678167","approximate = 0","magdalena"
"1471447678171","solver = list(name = solver, t_max = t_max, approximate = approximate, round_cplex = 0, trace_cplex = 0)","magdalena"
"1471447678177","","magdalena"
"1471447678181","","magdalena"
"1471447678186","","magdalena"
"1471447678190","","magdalena"
"1471447678197","out = bmatch(t_ind = t_ind, dist_mat = dist_mat, subset_weight = subset_weight,","magdalena"
"1471447678201","fine = fine, total_pairs = NULL, solver = solver)","magdalena"
"1471447749215","","magdalena"
"1471447749220","t_id = out$t_id","magdalena"
"1471447749226","c_id = out$c_id","magdalena"
"1471447749231","if (length(t_id)>0 & !is.na(t_id)) {","magdalena"
"1471447749236","cycle = FALSE","magdalena"
"1471447749241","group_id = out$group_id+count","magdalena"
"1471447749246","d_aux_2 = cbind(d_aux[c(t_id,c_id), ], group_id,i)","magdalena"
"1471447749251","d_unmatch = rbind(d_unmatch, d_aux_2)","magdalena"
"1471447749255","if (count == 0) {","magdalena"
"1471447749260","d_unmatch = d_unmatch[-1, ]","magdalena"
"1471447749265","}","magdalena"
"1471447749270","count = nrow(d_unmatch)/2","magdalena"
"1471447749274","}","magdalena"
"1471447749291","cat(\n, * Number of matched pairs: , length(t_id), sep = )","magdalena"
"1471447749296","cat(\n, * Proportion of possible pairs matched: ,round(length(out$t_id)/min(table(t_ind)), 2), sep= )","magdalena"
"1471447749309","cat(\n, * Matching time (mins): , round(out$time/60, 2), sep = )","magdalena"
"1471447749314","cat(\n, *************************************************, \n, sep = )","magdalena"
"1471447749318","","magdalena"
"1471447749321","","magdalena"
"1471447749326","","magdalena"
"1471447749330","","magdalena"
"1471447749335","aux = NA","magdalena"
"1471447749339","","magdalena"
"1471447749344","","magdalena"
"1471447749347","","magdalena"
"1471447749352","if (length(t_id)>0 & !is.na(t_id)) {","magdalena"
"1471447749357","temp_aux = NA","magdalena"
"1471447749362","","magdalena"
"1471447749365","for (z in 1","magdalena"
"ncol(fine_covs)) {","","magdalena"
"1471447749369","print(names_cov[z])","magdalena"
"1471447749373","","magdalena"
"1471447749377","n_dim<- length(table(fine_covs[,z]))","magdalena"
"1471447749382","if (n_dim>1){","magdalena"
"1471447749387","aux = c(aux,finetab(fine_covs[,z], t_id, c_id)[,2])","magdalena"
"1471447749391","temp_aux = c(temp_aux,finetab(fine_covs[,z], t_id, c_id)[,1])","magdalena"
"1471447749395","print(finetab(fine_covs[,z], t_id, c_id))","magdalena"
"1471447749398","print()","magdalena"
"1471447749401","}","magdalena"
"1471447749408","else {","magdalena"
"1471447749415","Units = rep(0, length(fine_covs[,z]))","magdalena"
"1471447749419","Units[t_id] = 1","magdalena"
"1471447749422","Units[c_id] = 2","magdalena"
"1471447749427","tab = table(fine_covs[,z], Units)[, 2","magdalena"
"3]","","magdalena"
"1471447749431","print(tab)","magdalena"
"1471447749435","print()","magdalena"
"1471447749440","}","magdalena"
"1471447749444","}","magdalena"
"1471447749448","finetab_cov = cbind(finetab_cov,aux)","magdalena"
"1471447749452","}","magdalena"
"1471447749572","print(i)","magdalena"
"1471460405247","","magdalena"
"1471460405260","","magdalena"
"1471460405265","","magdalena"
"1471460405269","","magdalena"
"1471460405275","","magdalena"
"1471460405279","rm(list = ls())","magdalena"
"1471460405398","","magdalena"
"1471460405404","cat(\014)","magdalena"
"1471460405444","library(designmatch)","magdalena"
"1471460405493","library(foreign)","magdalena"
"1471460405508","library(Rglpk)","magdalena"
"1471460405520","library(gurobi)","magdalena"
"1471460405531","library(xtable)","magdalena"
"1471460405651","","magdalena"
"1471460405658","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/edquake/matching/01_iwas_2015/01_iwas_2015)","magdalena"
"1471460405678","source(constraintmatrix.r)","magdalena"
"1471460406271","source(problemparameters.r)","magdalena"
"1471460406366","source(bpmatch.r)","magdalena"
"1471460406542","source(errorhandling.r)","magdalena"
"1471460406563","source(useful_functions.r)","magdalena"
"1471460406763","source(finetab.r)","magdalena"
"1471460406795","","magdalena"
"1471460406800","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/Colegios)","magdalena"
"1471460406807","load(160816_schools_unmatched.RData)","magdalena"
"1471460412652","finetab_cov = rep(NA,18)","magdalena"
"1471460412658","d_unmatch = rep(NA, ncol(data)+6)","magdalena"
"1471460412667","count = 0","magdalena"
"1471460412673","t_max_alloc=15","magdalena"
"1471460464006","load(160817_unmatched_schools_results.RData)","magdalena"
"1471460503441","table(d_unmatch$rbd[treat==0])","magdalena"
"1471460514836","table(d_unmatch$rbd[d$unmatchtreat==0])","magdalena"
"1471460526225","table(d_unmatch$rbd[d_unmatch$treat==0])","magdalena"
"1471460553610","max_pairs=table(d_unmatch$rbd[d_unmatch$treat==0])","magdalena"
"1471460557803","help(hist)","magdalena"
"1471460596725","hist(max_pairs)","magdalena"
"1471460662239","","magdalena"
"1471460662244","","magdalena"
"1471460662248","","magdalena"
"1471460662253","","magdalena"
"1471460662255","","magdalena"
"1471460662255","rm(list = ls())","magdalena"
"1471460662255","","magdalena"
"1471460662271","cat(\014)","magdalena"
"1471460662271","library(designmatch)","magdalena"
"1471460662271","library(foreign)","magdalena"
"1471460662293","library(Rglpk)","magdalena"
"1471460662299","library(gurobi)","magdalena"
"1471460662305","library(xtable)","magdalena"
"1471460662312","","magdalena"
"1471460662316","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/edquake/matching/01_iwas_2015/01_iwas_2015)","magdalena"
"1471460662322","source(constraintmatrix.r)","magdalena"
"1471460662356","source(problemparameters.r)","magdalena"
"1471460662370","source(bpmatch.r)","magdalena"
"1471460662402","source(errorhandling.r)","magdalena"
"1471460662402","source(useful_functions.r)","magdalena"
"1471460662429","source(finetab.r)","magdalena"
"1471460662434","","magdalena"
"1471460662434","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/Colegios)","magdalena"
"1471460662434","load(160816_schools_unmatched_without_simce.RData)","magdalena"
"1471460698313","load(160817_unmatched_schools_results_without_simce.RData)","magdalena"
"1471460701751","","magdalena"
"1471460701755","max_pairs=table(d_unmatch$rbd[d_unmatch$treat==0])","magdalena"
"1471460702032","hist(max_pairs)","magdalena"
"1471461346506","","magdalena"
"1471461346514","","magdalena"
"1471461346519","","magdalena"
"1471461346523","","magdalena"
"1471461346529","","magdalena"
"1471461346534","rm(list = ls())","magdalena"
"1471461346546","","magdalena"
"1471461346553","cat(\014)","magdalena"
"1471461346562","library(designmatch)","magdalena"
"1471461346570","library(foreign)","magdalena"
"1471461346594","library(Rglpk)","magdalena"
"1471461346607","library(gurobi)","magdalena"
"1471461346623","library(xtable)","magdalena"
"1471461346631","","magdalena"
"1471461346637","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/edquake/matching/01_iwas_2015/01_iwas_2015)","magdalena"
"1471461346652","source(constraintmatrix.r)","magdalena"
"1471461346730","source(problemparameters.r)","magdalena"
"1471461346768","source(bpmatch.r)","magdalena"
"1471461346808","source(errorhandling.r)","magdalena"
"1471461346825","source(useful_functions.r)","magdalena"
"1471461346878","source(finetab.r)","magdalena"
"1471461346896","","magdalena"
"1471461346901","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/Colegios)","magdalena"
"1471461346914","load(160816_schools_unmatched.RData)","magdalena"
"1471461364363","load(160817_unmatched_schools_results.RData)","magdalena"
"1471461371869","","magdalena"
"1471461371874","max_pairs=table(d_unmatch$rbd[d_unmatch$treat==0])","magdalena"
"1471461372484","hist(max_pairs)","magdalena"
"1471461372587","hist(max_pairs,breaks=seq(0,100,10))","magdalena"
"1471461398708","hist(max_pairs,breaks=seq(0,100,5))","magdalena"
"1471461468473","","magdalena"
"1471461468479","","magdalena"
"1471461468483","","magdalena"
"1471461468488","","magdalena"
"1471461468493","","magdalena"
"1471461468496","rm(list = ls())","magdalena"
"1471461468501","","magdalena"
"1471461468506","cat(\014)","magdalena"
"1471461468513","library(designmatch)","magdalena"
"1471461468524","library(foreign)","magdalena"
"1471461468531","library(Rglpk)","magdalena"
"1471461468536","library(gurobi)","magdalena"
"1471461468549","library(xtable)","magdalena"
"1471461468556","","magdalena"
"1471461468561","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/edquake/matching/01_iwas_2015/01_iwas_2015)","magdalena"
"1471461468567","source(constraintmatrix.r)","magdalena"
"1471461468621","source(problemparameters.r)","magdalena"
"1471461468645","source(bpmatch.r)","magdalena"
"1471461468669","source(errorhandling.r)","magdalena"
"1471461468691","source(useful_functions.r)","magdalena"
"1471461468727","source(finetab.r)","magdalena"
"1471461468749","","magdalena"
"1471461468765","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/Colegios)","magdalena"
"1471461468783","load(160816_schools_unmatched_without_simce.RData)","magdalena"
"1471461479127","load(160817_unmatched_schools_results_without_simce.RData)","magdalena"
"1471461485220","","magdalena"
"1471461485225","max_pairs=table(d_unmatch$rbd[d_unmatch$treat==0])","magdalena"
"1471461485993","hist(max_pairs,breaks=seq(0,100,5))","magdalena"
"1471461793326","","magdalena"
"1471461793331","","magdalena"
"1471461793335","","magdalena"
"1471461793338","","magdalena"
"1471461793341","","magdalena"
"1471461793345","","magdalena"
"1471461793348","rm(list = ls())","magdalena"
"1471461793353","","magdalena"
"1471461793357","cat(\014)","magdalena"
"1471461793364","","magdalena"
"1471461793368","","magdalena"
"1471461793371","set.seed(100)","magdalena"
"1471461793379","","magdalena"
"1471461793384","n = 1000","magdalena"
"1471461793396","","magdalena"
"1471461793401","s = 11","magdalena"
"1471461793407","","magdalena"
"1471461793410","beta = rep(0,s)","magdalena"
"1471461793414","","magdalena"
"1471461793419","beta[1]=0.5","magdalena"
"1471461793430","beta[2]=0","magdalena"
"1471461793435","beta[10]=0","magdalena"
"1471461793440","","magdalena"
"1471461793445","prob=0.1","magdalena"
"1471461793449","treat=rbinom(n,1,prob)","magdalena"
"1471461793467","","magdalena"
"1471461793471","for (i in 1","magdalena"
"s){","","magdalena"
"1471461793476","y=beta[i]*treat+rnorm(n)","magdalena"
"1471461793482","if (i==1){","magdalena"
"1471461793493","y_mat=y","magdalena"
"1471461793498","}","magdalena"
"1471461793501","if (i>1){","magdalena"
"1471461793506","y_mat=cbind(y_mat,y)","magdalena"
"1471461793510","}","magdalena"
"1471461793514","}","magdalena"
"1471461816174","View(y_mat)","magdalena"
"1471461921635","data = as.data.frame(cbind(y_mat,treat))","magdalena"
"1471461921643","library(foreign)","magdalena"
"1471461921649","write.dta(data, datav1.dta)","magdalena"
"1471462073972","setwd(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Research/Romano_and_Wolf)","magdalena"
"1471462082482","","magdalena"
"1471462082498","","magdalena"
"1471462082498","","magdalena"
"1471462082513","","magdalena"
"1471462082513","","magdalena"
"1471462082513","","magdalena"
"1471462082513","rm(list = ls())","magdalena"
"1471462082529","","magdalena"
"1471462082529","cat(\014)","magdalena"
"1471462082529","","magdalena"
"1471462082546","","magdalena"
"1471462082549","set.seed(100)","magdalena"
"1471462082549","","magdalena"
"1471462082549","n = 1000","magdalena"
"1471462082549","","magdalena"
"1471462082565","s = 11","magdalena"
"1471462082565","","magdalena"
"1471462082565","beta = rep(0,s)","magdalena"
"1471462082565","","magdalena"
"1471462082585","beta[1]=0.5","magdalena"
"1471462082586","beta[2]=0","magdalena"
"1471462082586","beta[10]=0","magdalena"
"1471462082601","","magdalena"
"1471462082601","prob=0.1","magdalena"
"1471462082617","treat=rbinom(n,1,prob)","magdalena"
"1471462082617","","magdalena"
"1471462082633","for (i in 1","magdalena"
"s){","","magdalena"
"1471462082633","y=beta[i]*treat+rnorm(n)","magdalena"
"1471462082633","if (i==1){","magdalena"
"1471462082633","y_mat=y","magdalena"
"1471462082651","}","magdalena"
"1471462082654","if (i>1){","magdalena"
"1471462082658","y_mat=cbind(y_mat,y)","magdalena"
"1471462082661","}","magdalena"
"1471462082665","}","magdalena"
"1471462127808","dim(y_mat)","magdalena"
"1471462177711","","magdalena"
"1471462177713","","magdalena"
"1471462177713","","magdalena"
"1471462177713","","magdalena"
"1471462177713","","magdalena"
"1471462177728","","magdalena"
"1471462177728","rm(list = ls())","magdalena"
"1471462177728","","magdalena"
"1471462177728","cat(\014)","magdalena"
"1471462177748","","magdalena"
"1471462177748","","magdalena"
"1471462177748","set.seed(100)","magdalena"
"1471462177748","","magdalena"
"1471462177764","n = 1000","magdalena"
"1471462177764","","magdalena"
"1471462177764","s = 10","magdalena"
"1471462177764","","magdalena"
"1471462177780","beta = rep(0,s)","magdalena"
"1471462177780","","magdalena"
"1471462177780","beta[1]=0.5","magdalena"
"1471462177780","beta[2]=0","magdalena"
"1471462177795","beta[10]=0","magdalena"
"1471462177795","","magdalena"
"1471462177795","prob=0.1","magdalena"
"1471462177811","treat=rbinom(n,1,prob)","magdalena"
"1471462177811","","magdalena"
"1471462177811","for (i in 1","magdalena"
"s){","","magdalena"
"1471462177827","y=beta[i]*treat+rnorm(n)","magdalena"
"1471462177827","if (i==1){","magdalena"
"1471462177827","y_mat=y","magdalena"
"1471462177844","}","magdalena"
"1471462177848","if (i>1){","magdalena"
"1471462177849","y_mat=cbind(y_mat,y)","magdalena"
"1471462177849","}","magdalena"
"1471462177849","}","magdalena"
"1471462177864","","magdalena"
"1471462177864","data=cbind(y_mat,treat)","magdalena"
"1471462177883","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1471462186243","data = as.data.frame(data)","magdalena"
"1471462189106","br(data)","magdalena"
"1471462192094","View(data)","magdalena"
"1471462205612","library(foreign)","magdalena"
"1471462205617","write.dta(data, datav1.dta)","magdalena"
"1471462308120","","magdalena"
"1471462308120","","magdalena"
"1471462308120","","magdalena"
"1471462308120","","magdalena"
"1471462308120","","magdalena"
"1471462308136","","magdalena"
"1471462308136","rm(list = ls())","magdalena"
"1471462308136","","magdalena"
"1471462308136","cat(\014)","magdalena"
"1471462308154","","magdalena"
"1471462308154","","magdalena"
"1471462308154","set.seed(100)","magdalena"
"1471462308154","","magdalena"
"1471462308154","n = 1000","magdalena"
"1471462308170","","magdalena"
"1471462308170","s = 10","magdalena"
"1471462308170","","magdalena"
"1471462308170","beta = rep(0,s)","magdalena"
"1471462308186","","magdalena"
"1471462308186","beta[1]=0.5","magdalena"
"1471462308186","beta[2]=0","magdalena"
"1471462308186","beta[10]=0","magdalena"
"1471462308201","","magdalena"
"1471462308201","prob=0.1","magdalena"
"1471462308201","treat=rbinom(n,1,prob)","magdalena"
"1471462308217","","magdalena"
"1471462308217","for (i in 1","magdalena"
"s){","","magdalena"
"1471462308217","y=beta[i]*treat+rnorm(n)","magdalena"
"1471462308233","if (i==1){","magdalena"
"1471462308233","y_mat=y","magdalena"
"1471462308233","}","magdalena"
"1471462308233","if (i>1){","magdalena"
"1471462308250","y_mat=cbind(y_mat,y)","magdalena"
"1471462308253","}","magdalena"
"1471462308257","}","magdalena"
"1471462308269","","magdalena"
"1471462308274","data=cbind(y_mat,treat)","magdalena"
"1471462308277","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1471462308277","data = as.data.frame(data)","magdalena"
"1471462308277","library(foreign)","magdalena"
"1471462308293","write.dta(data, datav1.dta)","magdalena"
"1471462308326","","magdalena"
"1471462308327","","magdalena"
"1471462308327","","magdalena"
"1471462308345","","magdalena"
"1471462308352","","magdalena"
"1471462308358","","magdalena"
"1471462308358","beta_hat=rep(NA,s)","magdalena"
"1471462308358","t_hat=rep(NA,s)","magdalena"
"1471462308373","reject_unadjust=rep(,s)","magdalena"
"1471462308373","for (i in 1","magdalena"
"s){","","magdalena"
"1471462308373","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471462308389","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471462308405","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471462308405","reject_unadjust[i]=No","magdalena"
"1471462308420","}","magdalena"
"1471462308420","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471462308420","reject_unadjust[i]=90","magdalena"
"1471462308436","}","magdalena"
"1471462308436","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471462308452","reject_unadjust[i]=95","magdalena"
"1471462308456","}","magdalena"
"1471462308456","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471462308456","reject_unadjust[i]=99","magdalena"
"1471462308471","}","magdalena"
"1471462308471","}","magdalena"
"1471462321347","reject_unadjust","magdalena"
"1471462430596","","magdalena"
"1471462430601","B=1000","magdalena"
"1471462430606","beta_bs=matrix(NA,B,s)","magdalena"
"1471462430611","t_bs=matrix(NA,B,s)","magdalena"
"1471462430611","for (i in 1","magdalena"
"B){","","magdalena"
"1471462430611","","magdalena"
"1471462430611","","magdalena"
"1471462430611","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471462430627","y_mat_bs=y_mat[id,]","magdalena"
"1471462430627","treat_bs=treat[id]","magdalena"
"1471462430627","for (k in 1","magdalena"
"s){","","magdalena"
"1471462430627","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471462430642","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471462430642","}","magdalena"
"1471462430642","}","magdalena"
"1471462841644","","magdalena"
"1471462841647","data=t_bs","magdalena"
"1471462841651","colnames(data)<-c(t_bs1,t_bs2,t_bs3,t_bs4,t_bs5,t_bs6,t_bs7,t_bs8,t_bs9,t_bs10,treat)","magdalena"
"1471462841657","data = as.data.frame(data)","magdalena"
"1471462841664","library(foreign)","magdalena"
"1471462841670","write.dta(data, datav1_bs.dta)","magdalena"
"1471462859375","","magdalena"
"1471462859380","data=t_bs","magdalena"
"1471462859383","colnames(data)<-c(t_bs1,t_bs2,t_bs3,t_bs4,t_bs5,t_bs6,t_bs7,t_bs8,t_bs9,t_bs10)","magdalena"
"1471462859387","data = as.data.frame(data)","magdalena"
"1471462859393","library(foreign)","magdalena"
"1471462859398","write.dta(data, datav1_bs.dta)","magdalena"
"1471463914177","","magdalena"
"1471463914182","","magdalena"
"1471463914185","","magdalena"
"1471463914190","","magdalena"
"1471463914194","","magdalena"
"1471463914198","","magdalena"
"1471463914202","rm(list = ls())","magdalena"
"1471463914220","","magdalena"
"1471463914225","cat(\014)","magdalena"
"1471463914240","","magdalena"
"1471463914247","","magdalena"
"1471463914253","set.seed(100)","magdalena"
"1471463914273","","magdalena"
"1471463914282","n = 1000","magdalena"
"1471463914327","","magdalena"
"1471463914333","s = 10","magdalena"
"1471463914343","","magdalena"
"1471463914350","beta = rep(0,s)","magdalena"
"1471463914359","","magdalena"
"1471463914366","beta[1]=0.5","magdalena"
"1471463914385","beta[2]=0","magdalena"
"1471463914413","beta[10]=0","magdalena"
"1471463914432","","magdalena"
"1471463914439","prob=0.1","magdalena"
"1471463914445","treat=rbinom(n,1,prob)","magdalena"
"1471463914462","","magdalena"
"1471463914471","for (i in 1","magdalena"
"s){","","magdalena"
"1471463914483","y=beta[i]*treat+rnorm(n)","magdalena"
"1471463914490","if (i==1){","magdalena"
"1471463914504","y_mat=y","magdalena"
"1471463914510","}","magdalena"
"1471463914515","if (i>1){","magdalena"
"1471463914521","y_mat=cbind(y_mat,y)","magdalena"
"1471463914534","}","magdalena"
"1471463914541","}","magdalena"
"1471463914682","","magdalena"
"1471463914691","data=cbind(y_mat,treat)","magdalena"
"1471463914699","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1471463914712","data = as.data.frame(data)","magdalena"
"1471463914743","library(foreign)","magdalena"
"1471463914779","write.dta(data, datav1.dta)","magdalena"
"1471463914864","","magdalena"
"1471463914903","","magdalena"
"1471463914909","","magdalena"
"1471463914914","","magdalena"
"1471463914924","","magdalena"
"1471463914930","","magdalena"
"1471463914936","beta_hat=rep(NA,s)","magdalena"
"1471463914987","t_hat=rep(NA,s)","magdalena"
"1471463914994","reject_unadjust=rep(,s)","magdalena"
"1471463915002","for (i in 1","magdalena"
"s){","","magdalena"
"1471463915007","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471463915015","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471463915044","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471463915052","reject_unadjust[i]=No","magdalena"
"1471463915059","}","magdalena"
"1471463915069","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471463915076","reject_unadjust[i]=90","magdalena"
"1471463915143","}","magdalena"
"1471463915151","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471463915160","reject_unadjust[i]=95","magdalena"
"1471463915169","}","magdalena"
"1471463915197","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471463915239","reject_unadjust[i]=99","magdalena"
"1471463915245","}","magdalena"
"1471463915252","}","magdalena"
"1471463975219","","magdalena"
"1471463975224","data=t_hat","magdalena"
"1471463975229","colnames(data)<-c(t_hat1,t_hat2,t_hat3,t_hat4,t_hat5,t_hat6,t_hat7,t_hat8,t_hat9,t_hat10)","magdalena"
"1471463975241","data = as.data.frame(data)","magdalena"
"1471463975250","library(foreign)","magdalena"
"1471463975259","write.dta(data, datav1_pvalues.dta)","magdalena"
"1471463987991","t_hat","magdalena"
"1471464013115","","magdalena"
"1471464013119","data=rbind(t_hat,1)","magdalena"
"1471464013123","colnames(data)<-c(t_hat1,t_hat2,t_hat3,t_hat4,t_hat5,t_hat6,t_hat7,t_hat8,t_hat9,t_hat10)","magdalena"
"1471464013126","data = as.data.frame(data)","magdalena"
"1471464013131","library(foreign)","magdalena"
"1471464013139","write.dta(data, datav1_pvalues.dta)","magdalena"
"1471465344662","","magdalena"
"1471465344680","","magdalena"
"1471465344685","","magdalena"
"1471465344691","","magdalena"
"1471465344695","","magdalena"
"1471465344702","","magdalena"
"1471465344706","rm(list = ls())","magdalena"
"1471465344722","","magdalena"
"1471465344727","cat(\014)","magdalena"
"1471465344737","","magdalena"
"1471465344744","","magdalena"
"1471465344749","set.seed(100)","magdalena"
"1471465344758","","magdalena"
"1471465344762","n = 1000","magdalena"
"1471465344769","","magdalena"
"1471465344772","s = 10","magdalena"
"1471465344772","","magdalena"
"1471465344772","beta = rep(0,s)","magdalena"
"1471465344772","","magdalena"
"1471465344787","beta[1]=0.5","magdalena"
"1471465344787","beta[2]=0","magdalena"
"1471465344787","beta[10]=0","magdalena"
"1471465344811","","magdalena"
"1471465344813","prob=0.1","magdalena"
"1471465344822","treat=rbinom(n,1,prob)","magdalena"
"1471465344829","","magdalena"
"1471465344833","for (i in 1","magdalena"
"s){","","magdalena"
"1471465344837","y=beta[i]*treat+rnorm(n)","magdalena"
"1471465344841","if (i==1){","magdalena"
"1471465344844","y_mat=y","magdalena"
"1471465344847","}","magdalena"
"1471465344850","if (i>1){","magdalena"
"1471465344851","y_mat=cbind(y_mat,y)","magdalena"
"1471465344851","}","magdalena"
"1471465344851","}","magdalena"
"1471465344882","","magdalena"
"1471465344882","data=cbind(y_mat,treat)","magdalena"
"1471465344882","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1471465344902","data = as.data.frame(data)","magdalena"
"1471465344913","library(foreign)","magdalena"
"1471465344929","write.dta(data, datav1.dta)","magdalena"
"1471465344960","","magdalena"
"1471465344976","","magdalena"
"1471465344976","","magdalena"
"1471465345014","","magdalena"
"1471465345014","","magdalena"
"1471465345014","","magdalena"
"1471465345029","beta_hat=rep(NA,s)","magdalena"
"1471465345029","t_hat=rep(NA,s)","magdalena"
"1471465345045","reject_unadjust=rep(,s)","magdalena"
"1471465345061","for (i in 1","magdalena"
"s){","","magdalena"
"1471465345101","beta_hat[i]=lm(y_mat[,i]~treat)$coefficients[2]","magdalena"
"1471465345123","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1471465345130","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1471465345138","reject_unadjust[i]=No","magdalena"
"1471465345144","}","magdalena"
"1471465345152","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1471465345193","reject_unadjust[i]=90","magdalena"
"1471465345199","}","magdalena"
"1471465345208","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1471465345217","reject_unadjust[i]=95","magdalena"
"1471465345227","}","magdalena"
"1471465345234","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1471465345239","reject_unadjust[i]=99","magdalena"
"1471465345244","}","magdalena"
"1471465345250","}","magdalena"
"1471465349456","","magdalena"
"1471465349492","data=rbind(t_hat,1)","magdalena"
"1471465349499","colnames(data)<-c(t_hat1,t_hat2,t_hat3,t_hat4,t_hat5,t_hat6,t_hat7,t_hat8,t_hat9,t_hat10)","magdalena"
"1471465349508","data = as.data.frame(data)","magdalena"
"1471465349517","library(foreign)","magdalena"
"1471465349527","write.dta(data, datav1_pvalues.dta)","magdalena"
"1471465349598","","magdalena"
"1471465349606","","magdalena"
"1471465349611","B=1000","magdalena"
"1471465349620","beta_bs=matrix(NA,B,s)","magdalena"
"1471465349630","t_bs=matrix(NA,B,s)","magdalena"
"1471465349660","for (i in 1","magdalena"
"B){","","magdalena"
"1471465349685","","magdalena"
"1471465349690","","magdalena"
"1471465349704","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1471465349714","y_mat_bs=y_mat[id,]","magdalena"
"1471465349721","treat_bs=treat[id]","magdalena"
"1471465349729","for (k in 1","magdalena"
"s){","","magdalena"
"1471465349736","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1471465349756","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1471465349764","}","magdalena"
"1471465349769","}","magdalena"
"1471465602932","","magdalena"
"1471465602938","data=t_bs","magdalena"
"1471465602943","colnames(data)<-c(t_bs1,t_bs2,t_bs3,t_bs4,t_bs5,t_bs6,t_bs7,t_bs8,t_bs9,t_bs10)","magdalena"
"1471465602947","data = as.data.frame(data)","magdalena"
"1471465602950","library(foreign)","magdalena"
"1471465602955","write.dta(data, datav1_bs.dta)","magdalena"
"1471465602985","","magdalena"
"1471465602993","alpha=c(0.95,0.975,0.995)","magdalena"
"1471465603018","","magdalena"
"1471465603023","reject_adjust=rep(,s)","magdalena"
"1471465603035","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1471465603042","t_hat_aux=t_hat","magdalena"
"1471465603059","t_bs_aux=t_bs","magdalena"
"1471465603069","done=F","magdalena"
"1471465603076","while(done==F){","magdalena"
"1471465603100","t_max=max(t_hat_aux)","magdalena"
"1471465603108","k=which(t_hat_aux==t_max)","magdalena"
"1471465603115","if(!is.null(dim(t_bs_aux))){","magdalena"
"1471465603121","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1471465603133","}","magdalena"
"1471465603139","if(is.null(dim(t_bs_aux))){","magdalena"
"1471465603151","t_bs_max=t_bs_aux","magdalena"
"1471465603168","}","magdalena"
"1471465603188","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471465603203","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1471465603211","k_orig=which(t_hat==t_max)","magdalena"
"1471465603216","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471465603227","t_hat_aux=t_hat_aux[-k]","magdalena"
"1471465603232","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1471465603245","print(k_orig)","magdalena"
"1471465603251","}","magdalena"
"1471465603269","if(is.null(dim(t_bs_aux))){","magdalena"
"1471465603288","t_bs_max=t_bs_aux","magdalena"
"1471465603300","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1471465603316","t_max=max(t_hat_aux)","magdalena"
"1471465603322","}","magdalena"
"1471465603331","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1471465603337","if(t_max>=t_quantile){","magdalena"
"1471465603353","k_orig=which(t_hat==t_max)","magdalena"
"1471465603360","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1471465603366","}","magdalena"
"1471465603374","done=T","magdalena"
"1471465603390","}","magdalena"
"1471465603396","}","magdalena"
"1471465603402","}","magdalena"
"1471465603569","reject_adjust[reject_adjust==]=No","magdalena"
"1471465603578","","magdalena"
"1471465603583","beta_hat","magdalena"
"1471465603591","","magdalena"
"1471465603603","reject_unadjust","magdalena"
"1471465603614","","magdalena"
"1471465603621","reject_adjust","magdalena"
"1471469160451","","magdalena"
"1471469160462","","magdalena"
"1471469160467","","magdalena"
"1471469160472","","magdalena"
"1471469160479","","magdalena"
"1471469160483","rm(list = ls())","magdalena"
"1471469160506","","magdalena"
"1471469160511","cat(\014)","magdalena"
"1471469160525","library(designmatch)","magdalena"
"1471469160559","library(foreign)","magdalena"
"1471469160587","library(Rglpk)","magdalena"
"1471469160596","library(gurobi)","magdalena"
"1471469160604","library(xtable)","magdalena"
"1471469160612","","magdalena"
"1471469160620","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/edquake/matching/01_iwas_2015/01_iwas_2015)","magdalena"
"1471469160634","source(constraintmatrix.r)","magdalena"
"1471469160813","source(problemparameters.r)","magdalena"
"1471469160895","source(bpmatch.r)","magdalena"
"1471469160967","source(errorhandling.r)","magdalena"
"1471469161005","source(useful_functions.r)","magdalena"
"1471469161093","source(finetab.r)","magdalena"
"1471469161124","","magdalena"
"1471469161130","setwd(C:/Users/Magdalena Bennett/Dropbox/Share Space - Mai 2/Colegios)","magdalena"
"1471469161139","load(160816_schools_unmatched_with_simce.RData)","magdalena"
"1471469176344","","magdalena"
"1471469176349","load(160817_unmatched_schools_results_with_simce.RData)","magdalena"
"1471469176365","","magdalena"
"1471469176371","max_pairs=table(d_unmatch$rbd[d_unmatch$treat==0])","magdalena"
"1471469176379","hist(max_pairs,breaks=seq(0,100,5))","magdalena"
"1471469206114","","magdalena"
"1471469206120","load(160817_unmatched_schools_results_with_simce.RData)","magdalena"
"1471469213723","","magdalena"
"1471469213730","max_pairs=table(d_unmatch$rbd[d_unmatch$treat==0])","magdalena"
"1471469214202","hist(max_pairs,breaks=seq(0,100,5))","magdalena"
"1471469246616","load(160817_unmatched_schools_results.RData)","magdalena"
"1471469255423","","magdalena"
"1471469255428","max_pairs=table(d_unmatch$rbd[d_unmatch$treat==0])","magdalena"
"1471469255838","hist(max_pairs,breaks=seq(0,100,5))","magdalena"
"1471469278559","load(160817_unmatched_schools_results_without_simce.RData)","magdalena"
"1471469287978","","magdalena"
"1471469287983","max_pairs=table(d_unmatch$rbd[d_unmatch$treat==0])","magdalena"
"1471469288433","hist(max_pairs,breaks=seq(0,100,5))","magdalena"
"1471469723453","table(d_match$rbd[d_match$treat==0])","magdalena"
"1471469745636","table(d_match$rbd[d_match$treat==0])","magdalena"
"1471469764892","table(d_match$rbd[d_match$treat==1])","magdalena"
"1471469778652","table(d_match$rbd[d_match$treat==0])","magdalena"
"1471469782100","table(d_match$rbd[d_match$treat==1])","magdalena"
"1471469802678","sum(table(d_match$rbd[d_match$treat==1]))","magdalena"
"1471469822696","sum(table(d_match$rbd[d_match$treat==0]))","magdalena"
"1471469827042","table(d_match$rbd[d_match$treat==0])","magdalena"
"1471469846682","table(d_match$rbd[d_match$treat==0])","magdalena"
"1471469860691","length(d_match$rbd[d_match$treat==0])","magdalena"
"1471469871961","length(unique(d_match$rbd[d_match$treat==0]))","magdalena"
"1472147580255","install.packages(lmtest)","magdalena"
"1472147657162","","magdalena"
"1472147657165","","magdalena"
"1472147657165","","magdalena"
"1472147657165","library(lmtest)","magdalena"
"1472147657746","","magdalena"
"1472147657762","","magdalena"
"1472147657762","","magdalena"
"1472147657762","rm(list = ls())","magdalena"
"1472147657777","","magdalena"
"1472147657777","cat(\014)","magdalena"
"1472147657793","","magdalena"
"1472147657793","","magdalena"
"1472147657793","","magdalena"
"1472147657810","","magdalena"
"1472147657810","n = 1000","magdalena"
"1472147657810","","magdalena"
"1472147657825","s = 10","magdalena"
"1472147657825","","magdalena"
"1472147657837","beta = rep(0,s)","magdalena"
"1472147657842","","magdalena"
"1472147657844","beta[1]=0.5","magdalena"
"1472147657844","beta[2]=0","magdalena"
"1472147657844","beta[10]=0","magdalena"
"1472147657844","","magdalena"
"1472147657860","prob=0.5","magdalena"
"1472147657860","treat=rbinom(n,1,prob)","magdalena"
"1472147657860","","magdalena"
"1472147657860","for (i in 1","magdalena"
"s){","","magdalena"
"1472147657876","y=beta[i]*treat+rnorm(n)","magdalena"
"1472147657876","if (i==1){","magdalena"
"1472147657876","y_mat=y","magdalena"
"1472147657876","}","magdalena"
"1472147657891","if (i>1){","magdalena"
"1472147657891","y_mat=cbind(y_mat,y)","magdalena"
"1472147657891","}","magdalena"
"1472147657891","}","magdalena"
"1472147657909","","magdalena"
"1472147657909","data=cbind(y_mat,treat)","magdalena"
"1472147657909","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1472147657928","data = as.data.frame(data)","magdalena"
"1472147657933","library(foreign)","magdalena"
"1472147657997","write.dta(data, datav1.dta)","magdalena"
"1472147658012","","magdalena"
"1472147658016","","magdalena"
"1472147658020","","magdalena"
"1472147658023","","magdalena"
"1472147658028","","magdalena"
"1472147658034","","magdalena"
"1472147658038","beta_hat=rep(NA,s)","magdalena"
"1472147658042","t_hat=rep(NA,s)","magdalena"
"1472147658045","reject_unadjust=rep(,s)","magdalena"
"1472147665642","i=1","magdalena"
"1472147707507","lm=lm(y_mat[,i]~treat)","magdalena"
"1472147714130","summary(lm)","magdalena"
"1472147731958","coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472147765077","?coeftest","magdalena"
"1472147804813","install.packages(sandwich)","magdalena"
"1472147831158","library(lmtest)","magdalena"
"1472147831158","library(sandwich)","magdalena"
"1472147831227","","magdalena"
"1472147831227","","magdalena"
"1472147831243","","magdalena"
"1472147831243","rm(list = ls())","magdalena"
"1472147831243","","magdalena"
"1472147831243","cat(\014)","magdalena"
"1472147831259","","magdalena"
"1472147831259","","magdalena"
"1472147831259","","magdalena"
"1472147831259","","magdalena"
"1472147831274","n = 1000","magdalena"
"1472147831274","","magdalena"
"1472147831274","s = 10","magdalena"
"1472147831290","","magdalena"
"1472147831290","beta = rep(0,s)","magdalena"
"1472147831290","","magdalena"
"1472147831290","beta[1]=0.5","magdalena"
"1472147831290","beta[2]=0","magdalena"
"1472147831306","beta[10]=0","magdalena"
"1472147831306","","magdalena"
"1472147831306","prob=0.5","magdalena"
"1472147831321","treat=rbinom(n,1,prob)","magdalena"
"1472147831321","","magdalena"
"1472147831321","for (i in 1","magdalena"
"s){","","magdalena"
"1472147831321","y=beta[i]*treat+rnorm(n)","magdalena"
"1472147831340","if (i==1){","magdalena"
"1472147831343","y_mat=y","magdalena"
"1472147831343","}","magdalena"
"1472147831343","if (i>1){","magdalena"
"1472147831356","y_mat=cbind(y_mat,y)","magdalena"
"1472147831361","}","magdalena"
"1472147831361","}","magdalena"
"1472147831361","","magdalena"
"1472147831361","data=cbind(y_mat,treat)","magdalena"
"1472147831376","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1472147831376","data = as.data.frame(data)","magdalena"
"1472147831376","library(foreign)","magdalena"
"1472147831376","write.dta(data, datav1.dta)","magdalena"
"1472147831392","","magdalena"
"1472147831392","","magdalena"
"1472147831408","","magdalena"
"1472147831408","","magdalena"
"1472147831408","","magdalena"
"1472147831408","","magdalena"
"1472147831423","beta_hat=rep(NA,s)","magdalena"
"1472147831423","t_hat=rep(NA,s)","magdalena"
"1472147831423","reject_unadjust=rep(,s)","magdalena"
"1472147834751","s=1","magdalena"
"1472147840480","i=1","magdalena"
"1472147851376","lm=lm(y_mat[,i]~treat)","magdalena"
"1472147855000","summary(lm)","magdalena"
"1472147865526","coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472147907904","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472147962120","abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1472147971890","abs(ct[2,3])","magdalena"
"1472148073748","","magdalena"
"1472148073752","","magdalena"
"1472148073756","","magdalena"
"1472148073762","library(lmtest)","magdalena"
"1472148073768","library(sandwich)","magdalena"
"1472148073775","","magdalena"
"1472148073780","","magdalena"
"1472148073785","","magdalena"
"1472148073789","rm(list = ls())","magdalena"
"1472148073795","","magdalena"
"1472148073800","cat(\014)","magdalena"
"1472148073807","","magdalena"
"1472148073812","","magdalena"
"1472148073816","","magdalena"
"1472148073821","","magdalena"
"1472148073825","n = 1000","magdalena"
"1472148073830","","magdalena"
"1472148073834","s = 10","magdalena"
"1472148073840","","magdalena"
"1472148073849","beta = rep(0,s)","magdalena"
"1472148073856","","magdalena"
"1472148073861","beta[1]=0.5","magdalena"
"1472148073876","beta[2]=0","magdalena"
"1472148073884","beta[10]=0","magdalena"
"1472148073891","","magdalena"
"1472148073895","prob=0.5","magdalena"
"1472148073900","treat=rbinom(n,1,prob)","magdalena"
"1472148073905","","magdalena"
"1472148073908","for (i in 1","magdalena"
"s){","","magdalena"
"1472148073912","y=beta[i]*treat+rnorm(n)","magdalena"
"1472148073917","if (i==1){","magdalena"
"1472148073920","y_mat=y","magdalena"
"1472148073924","}","magdalena"
"1472148073927","if (i>1){","magdalena"
"1472148073930","y_mat=cbind(y_mat,y)","magdalena"
"1472148073934","}","magdalena"
"1472148073937","}","magdalena"
"1472148073950","","magdalena"
"1472148073953","data=cbind(y_mat,treat)","magdalena"
"1472148073958","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1472148073962","data = as.data.frame(data)","magdalena"
"1472148073966","library(foreign)","magdalena"
"1472148073972","write.dta(data, datav1.dta)","magdalena"
"1472148073972","","magdalena"
"1472148073972","","magdalena"
"1472148073987","","magdalena"
"1472148073987","","magdalena"
"1472148073987","","magdalena"
"1472148073987","","magdalena"
"1472148074003","beta_hat=rep(NA,s)","magdalena"
"1472148074003","t_hat=rep(NA,s)","magdalena"
"1472148074003","reject_unadjust=rep(,s)","magdalena"
"1472148074003","for (i in 1","magdalena"
"s){","","magdalena"
"1472148074003","lm=lm(y_mat[,i]~treat)","magdalena"
"1472148074018","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472148074018","beta_hat[i]=lm$coefficients[2]","magdalena"
"1472148074018","","magdalena"
"1472148074018","t_hat[i]=abs(ct[2,3])","magdalena"
"1472148074018","","magdalena"
"1472148074018","if(ct[2,4]>0.1){","magdalena"
"1472148074034","reject_unadjust[i]=No","magdalena"
"1472148074034","}","magdalena"
"1472148074034","","magdalena"
"1472148074034","if(ct[2,4]<=0.1){","magdalena"
"1472148074050","reject_unadjust[i]=90","magdalena"
"1472148074050","}","magdalena"
"1472148074050","","magdalena"
"1472148074050","if(ct[2,4]<0.05){","magdalena"
"1472148074068","reject_unadjust[i]=95","magdalena"
"1472148074071","}","magdalena"
"1472148074074","","magdalena"
"1472148074077","if(ct[2,4]<0.01){","magdalena"
"1472148074081","reject_unadjust[i]=99","magdalena"
"1472148074084","}","magdalena"
"1472148074087","}","magdalena"
"1472148074387","","magdalena"
"1472148074390","data=rbind(t_hat,1)","magdalena"
"1472148074395","colnames(data)<-c(t_hat1,t_hat2,t_hat3,t_hat4,t_hat5,t_hat6,t_hat7,t_hat8,t_hat9,t_hat10)","magdalena"
"1472148074400","data = as.data.frame(data)","magdalena"
"1472148074405","library(foreign)","magdalena"
"1472148074411","write.dta(data, datav1_pvalues.dta)","magdalena"
"1472148094610","","magdalena"
"1472148094610","B=1000","magdalena"
"1472148094610","beta_bs=matrix(NA,B,s)","magdalena"
"1472148094610","t_bs=matrix(NA,B,s)","magdalena"
"1472148094610","for (i in 1","magdalena"
"B){","","magdalena"
"1472148094626","","magdalena"
"1472148094629","","magdalena"
"1472148094633","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1472148094635","y_mat_bs=y_mat[id,]","magdalena"
"1472148094635","treat_bs=treat[id]","magdalena"
"1472148094635","for (k in 1","magdalena"
"s){","","magdalena"
"1472148094635","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1472148094635","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1472148094635","}","magdalena"
"1472148094651","}","magdalena"
"1472148278844","","magdalena"
"1472148278851","data=t_bs","magdalena"
"1472148278855","colnames(data)<-c(t_bs1,t_bs2,t_bs3,t_bs4,t_bs5,t_bs6,t_bs7,t_bs8,t_bs9,t_bs10)","magdalena"
"1472148278859","data = as.data.frame(data)","magdalena"
"1472148278863","library(foreign)","magdalena"
"1472148278868","write.dta(data, datav1_bs.dta)","magdalena"
"1472148278883","","magdalena"
"1472148278888","alpha=c(0.95,0.975,0.995)","magdalena"
"1472148278893","","magdalena"
"1472148278900","reject_adjust=rep(,s)","magdalena"
"1472148278906","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1472148278913","t_hat_aux=t_hat","magdalena"
"1472148278917","t_bs_aux=t_bs","magdalena"
"1472148278922","done=F","magdalena"
"1472148278927","while(done==F){","magdalena"
"1472148278932","t_max=max(t_hat_aux)","magdalena"
"1472148278939","k=which(t_hat_aux==t_max)","magdalena"
"1472148278945","if(!is.null(dim(t_bs_aux))){","magdalena"
"1472148278949","t_bs_max=apply(t_bs_aux, 1, max)","magdalena"
"1472148278954","}","magdalena"
"1472148278958","if(is.null(dim(t_bs_aux))){","magdalena"
"1472148278963","t_bs_max=t_bs_aux","magdalena"
"1472148278968","}","magdalena"
"1472148278973","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472148278980","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1472148278984","k_orig=which(t_hat==t_max)","magdalena"
"1472148278989","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472148278995","t_hat_aux=t_hat_aux[-k]","magdalena"
"1472148278999","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1472148279004","print(k_orig)","magdalena"
"1472148279008","}","magdalena"
"1472148279013","if(is.null(dim(t_bs_aux))){","magdalena"
"1472148279016","t_bs_max=t_bs_aux","magdalena"
"1472148279021","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472148279026","t_max=max(t_hat_aux)","magdalena"
"1472148279031","}","magdalena"
"1472148279037","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1472148279042","if(t_max>=t_quantile){","magdalena"
"1472148279048","k_orig=which(t_hat==t_max)","magdalena"
"1472148279053","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472148279057","}","magdalena"
"1472148279062","done=T","magdalena"
"1472148279067","}","magdalena"
"1472148279071","}","magdalena"
"1472148279075","}","magdalena"
"1472148279153","reject_adjust[reject_adjust==]=No","magdalena"
"1472148279158","","magdalena"
"1472148279162","beta_hat","magdalena"
"1472148279169","","magdalena"
"1472148279173","reject_unadjust","magdalena"
"1472148279179","","magdalena"
"1472148279183","reject_adjust","magdalena"
"1472149025056","","magdalena"
"1472149025059","","magdalena"
"1472149025062","","magdalena"
"1472149025066","library(lmtest)","magdalena"
"1472149025088","library(sandwich)","magdalena"
"1472149025095","","magdalena"
"1472149025098","","magdalena"
"1472149025101","","magdalena"
"1472149025101","rm(list = ls())","magdalena"
"1472149025116","","magdalena"
"1472149025116","cat(\014)","magdalena"
"1472149025116","","magdalena"
"1472149025116","","magdalena"
"1472149025132","","magdalena"
"1472149025132","","magdalena"
"1472149025132","n = 1000","magdalena"
"1472149025148","","magdalena"
"1472149025148","s = 10","magdalena"
"1472149025148","","magdalena"
"1472149025148","beta = rep(0,s)","magdalena"
"1472149025148","","magdalena"
"1472149025165","beta[1]=0.5","magdalena"
"1472149025168","beta[2]=0","magdalena"
"1472149025168","beta[10]=0","magdalena"
"1472149025168","","magdalena"
"1472149025168","prob=0.5","magdalena"
"1472149025184","treat=rbinom(n,1,prob)","magdalena"
"1472149025184","","magdalena"
"1472149025184","for (i in 1","magdalena"
"s){","","magdalena"
"1472149025200","y=beta[i]*treat+rnorm(n)","magdalena"
"1472149025200","if (i==1){","magdalena"
"1472149025200","y_mat=y","magdalena"
"1472149025215","}","magdalena"
"1472149025215","if (i>1){","magdalena"
"1472149025215","y_mat=cbind(y_mat,y)","magdalena"
"1472149025215","}","magdalena"
"1472149025231","}","magdalena"
"1472149025249","","magdalena"
"1472149025249","data=cbind(y_mat,treat)","magdalena"
"1472149025266","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1472149025268","data = as.data.frame(data)","magdalena"
"1472149025284","library(foreign)","magdalena"
"1472149025284","write.dta(data, datav1.dta)","magdalena"
"1472149025331","","magdalena"
"1472149025331","","magdalena"
"1472149025331","","magdalena"
"1472149025331","","magdalena"
"1472149025346","","magdalena"
"1472149025346","","magdalena"
"1472149025362","beta_hat=rep(NA,s)","magdalena"
"1472149025368","t_hat=rep(NA,s)","magdalena"
"1472149025369","reject_unadjust=rep(,s)","magdalena"
"1472149025369","for (i in 1","magdalena"
"s){","","magdalena"
"1472149025369","lm=lm(y_mat[,i]~treat)","magdalena"
"1472149025384","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472149025390","beta_hat[i]=lm$coefficients[2]","magdalena"
"1472149025395","","magdalena"
"1472149025424","t_hat[i]=abs(ct[2,3])","magdalena"
"1472149025428","","magdalena"
"1472149025428","if(ct[2,4]>0.1){","magdalena"
"1472149025428","reject_unadjust[i]=No","magdalena"
"1472149025443","}","magdalena"
"1472149025443","","magdalena"
"1472149025443","if(ct[2,4]<=0.1){","magdalena"
"1472149025461","reject_unadjust[i]=90","magdalena"
"1472149025467","}","magdalena"
"1472149025469","","magdalena"
"1472149025469","if(ct[2,4]<0.05){","magdalena"
"1472149025469","reject_unadjust[i]=95","magdalena"
"1472149025484","}","magdalena"
"1472149025484","","magdalena"
"1472149025484","if(ct[2,4]<0.01){","magdalena"
"1472149025484","reject_unadjust[i]=99","magdalena"
"1472149025500","}","magdalena"
"1472149025500","}","magdalena"
"1472149026288","","magdalena"
"1472149026292","data=rbind(t_hat,1)","magdalena"
"1472149026296","colnames(data)<-c(t_hat1,t_hat2,t_hat3,t_hat4,t_hat5,t_hat6,t_hat7,t_hat8,t_hat9,t_hat10)","magdalena"
"1472149026300","data = as.data.frame(data)","magdalena"
"1472149026303","library(foreign)","magdalena"
"1472149026308","write.dta(data, datav1_pvalues.dta)","magdalena"
"1472149026318","","magdalena"
"1472149026324","","magdalena"
"1472149026328","B=1000","magdalena"
"1472149026334","beta_bs=matrix(NA,B,s)","magdalena"
"1472149026340","t_bs=matrix(NA,B,s)","magdalena"
"1472149026346","for (i in 1","magdalena"
"B){","","magdalena"
"1472149026351","","magdalena"
"1472149026355","","magdalena"
"1472149026361","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1472149026367","y_mat_bs=y_mat[id,]","magdalena"
"1472149026372","treat_bs=treat[id]","magdalena"
"1472149026378","for (k in 1","magdalena"
"s){","","magdalena"
"1472149026383","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1472149026387","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1472149026390","}","magdalena"
"1472149026394","}","magdalena"
"1472149204972","","magdalena"
"1472149204972","data=t_bs","magdalena"
"1472149204972","colnames(data)<-c(t_bs1,t_bs2,t_bs3,t_bs4,t_bs5,t_bs6,t_bs7,t_bs8,t_bs9,t_bs10)","magdalena"
"1472149204987","data = as.data.frame(data)","magdalena"
"1472149204987","library(foreign)","magdalena"
"1472149205006","write.dta(data, datav1_bs.dta)","magdalena"
"1472149205016","","magdalena"
"1472149205016","alpha=c(0.95,0.975,0.995)","magdalena"
"1472149205031","","magdalena"
"1472149205031","reject_adjust=rep(,s)","magdalena"
"1472149229441","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1472149229447","t_hat_aux=t_hat","magdalena"
"1472149229451","t_bs_aux=t_bs","magdalena"
"1472149229456","done=F","magdalena"
"1472149229461","while(done==F){","magdalena"
"1472149229466","t_max=max(t_hat_aux)","magdalena"
"1472149229471","k=which(t_hat_aux==t_max)","magdalena"
"1472149229477","if(!is.null(dim(t_bs_aux))){","magdalena"
"1472149229482","t_bs_max=t_bs_aux[,k]","magdalena"
"1472149229487","}","magdalena"
"1472149229492","if(is.null(dim(t_bs_aux))){","magdalena"
"1472149229496","t_bs_max=t_bs_aux","magdalena"
"1472149229501","}","magdalena"
"1472149229508","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472149229514","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1472149229519","k_orig=which(t_hat==t_max)","magdalena"
"1472149229524","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472149229528","t_hat_aux=t_hat_aux[-k]","magdalena"
"1472149229534","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1472149229538","print(k_orig)","magdalena"
"1472149229543","}","magdalena"
"1472149229550","if(is.null(dim(t_bs_aux))){","magdalena"
"1472149229555","t_bs_max=t_bs_aux","magdalena"
"1472149229560","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472149229567","t_max=max(t_hat_aux)","magdalena"
"1472149229572","}","magdalena"
"1472149229580","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1472149229586","if(t_max>=t_quantile){","magdalena"
"1472149229593","k_orig=which(t_hat==t_max)","magdalena"
"1472149229598","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472149229604","}","magdalena"
"1472149229610","done=T","magdalena"
"1472149229616","}","magdalena"
"1472149229622","}","magdalena"
"1472149229627","}","magdalena"
"1472149229665","reject_adjust[reject_adjust==]=No","magdalena"
"1472149229676","","magdalena"
"1472149229681","beta_hat","magdalena"
"1472149229692","","magdalena"
"1472149229697","reject_unadjust","magdalena"
"1472149229709","","magdalena"
"1472149229715","reject_adjust","magdalena"
"1472149294578","","magdalena"
"1472149294582","","magdalena"
"1472149294586","","magdalena"
"1472149294591","library(lmtest)","magdalena"
"1472149294596","library(sandwich)","magdalena"
"1472149294601","","magdalena"
"1472149294604","","magdalena"
"1472149294609","","magdalena"
"1472149294613","rm(list = ls())","magdalena"
"1472149294619","","magdalena"
"1472149294623","cat(\014)","magdalena"
"1472149294631","","magdalena"
"1472149294637","","magdalena"
"1472149294642","","magdalena"
"1472149294648","","magdalena"
"1472149294653","n = 1000","magdalena"
"1472149294659","","magdalena"
"1472149294664","s = 10","magdalena"
"1472149294671","","magdalena"
"1472149294679","beta = rep(0,s)","magdalena"
"1472149294689","","magdalena"
"1472149294696","","magdalena"
"1472149294700","","magdalena"
"1472149294712","","magdalena"
"1472149294720","","magdalena"
"1472149294724","prob=0.5","magdalena"
"1472149294729","treat=rbinom(n,1,prob)","magdalena"
"1472149294752","","magdalena"
"1472149294758","for (i in 1","magdalena"
"s){","","magdalena"
"1472149294762","y=beta[i]*treat+rnorm(n)","magdalena"
"1472149294768","if (i==1){","magdalena"
"1472149294772","y_mat=y","magdalena"
"1472149294776","}","magdalena"
"1472149294782","if (i>1){","magdalena"
"1472149294787","y_mat=cbind(y_mat,y)","magdalena"
"1472149294792","}","magdalena"
"1472149294797","}","magdalena"
"1472149294814","","magdalena"
"1472149294819","data=cbind(y_mat,treat)","magdalena"
"1472149294824","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1472149294829","data = as.data.frame(data)","magdalena"
"1472149294834","library(foreign)","magdalena"
"1472149294847","write.dta(data, datav1.dta)","magdalena"
"1472149294860","","magdalena"
"1472149294865","","magdalena"
"1472149294869","","magdalena"
"1472149294873","","magdalena"
"1472149294878","","magdalena"
"1472149294882","","magdalena"
"1472149294885","beta_hat=rep(NA,s)","magdalena"
"1472149294889","t_hat=rep(NA,s)","magdalena"
"1472149294892","reject_unadjust=rep(,s)","magdalena"
"1472149294897","for (i in 1","magdalena"
"s){","","magdalena"
"1472149294900","lm=lm(y_mat[,i]~treat)","magdalena"
"1472149294903","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472149294907","beta_hat[i]=lm$coefficients[2]","magdalena"
"1472149294910","","magdalena"
"1472149294913","t_hat[i]=abs(ct[2,3])","magdalena"
"1472149294917","","magdalena"
"1472149294921","if(ct[2,4]>0.1){","magdalena"
"1472149294924","reject_unadjust[i]=No","magdalena"
"1472149294924","}","magdalena"
"1472149294924","","magdalena"
"1472149294924","if(ct[2,4]<=0.1){","magdalena"
"1472149294924","reject_unadjust[i]=90","magdalena"
"1472149294939","}","magdalena"
"1472149294939","","magdalena"
"1472149294939","if(ct[2,4]<0.05){","magdalena"
"1472149294955","reject_unadjust[i]=95","magdalena"
"1472149294955","}","magdalena"
"1472149294955","","magdalena"
"1472149294955","if(ct[2,4]<0.01){","magdalena"
"1472149294970","reject_unadjust[i]=99","magdalena"
"1472149294970","}","magdalena"
"1472149294970","}","magdalena"
"1472149295493","","magdalena"
"1472149295498","data=rbind(t_hat,1)","magdalena"
"1472149295505","colnames(data)<-c(t_hat1,t_hat2,t_hat3,t_hat4,t_hat5,t_hat6,t_hat7,t_hat8,t_hat9,t_hat10)","magdalena"
"1472149295512","data = as.data.frame(data)","magdalena"
"1472149295519","library(foreign)","magdalena"
"1472149295526","write.dta(data, datav1_pvalues.dta)","magdalena"
"1472149295541","","magdalena"
"1472149295547","","magdalena"
"1472149295552","B=1000","magdalena"
"1472149295559","beta_bs=matrix(NA,B,s)","magdalena"
"1472149295564","t_bs=matrix(NA,B,s)","magdalena"
"1472149295573","for (i in 1","magdalena"
"B){","","magdalena"
"1472149295577","","magdalena"
"1472149295582","","magdalena"
"1472149295588","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1472149295594","y_mat_bs=y_mat[id,]","magdalena"
"1472149295599","treat_bs=treat[id]","magdalena"
"1472149295605","for (k in 1","magdalena"
"s){","","magdalena"
"1472149295610","beta_bs[i,k]=lm(y_mat_bs[,k]~treat_bs)$coefficients[2]","magdalena"
"1472149295615","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1472149295620","}","magdalena"
"1472149295627","}","magdalena"
"1472149494863","","magdalena"
"1472149494868","data=t_bs","magdalena"
"1472149494873","colnames(data)<-c(t_bs1,t_bs2,t_bs3,t_bs4,t_bs5,t_bs6,t_bs7,t_bs8,t_bs9,t_bs10)","magdalena"
"1472149494878","data = as.data.frame(data)","magdalena"
"1472149494884","library(foreign)","magdalena"
"1472149494891","write.dta(data, datav1_bs.dta)","magdalena"
"1472149494903","","magdalena"
"1472149494909","alpha=c(0.95,0.975,0.995)","magdalena"
"1472149494913","","magdalena"
"1472149494917","reject_adjust=rep(,s)","magdalena"
"1472149516469","a=1","magdalena"
"1472149521339","t_hat_aux=t_hat","magdalena"
"1472149521343","t_bs_aux=t_bs","magdalena"
"1472149521346","done=F","magdalena"
"1472149530372","t_hat_aux","magdalena"
"1472149552496","t_max=max(t_hat_aux)","magdalena"
"1472149552501","k=which(t_hat_aux==t_max)","magdalena"
"1472149556393","t_max","magdalena"
"1472149559586","k","magdalena"
"1472149568317","!is.null(dim(t_bs_aux))","magdalena"
"1472149576106","t_bs_max=t_bs_aux[,k]","magdalena"
"1472149582578","is.null(dim(t_bs_aux))","magdalena"
"1472149591067","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472149599938","t_quantile","magdalena"
"1472149620301","t_max>=t_quantile","magdalena"
"1472149833183","ct","magdalena"
"1472149900368","","magdalena"
"1472149900373","","magdalena"
"1472149900378","","magdalena"
"1472149900385","library(lmtest)","magdalena"
"1472149900395","library(sandwich)","magdalena"
"1472149900404","","magdalena"
"1472149900412","","magdalena"
"1472149900418","","magdalena"
"1472149900422","rm(list = ls())","magdalena"
"1472149900431","","magdalena"
"1472149900438","cat(\014)","magdalena"
"1472149900458","","magdalena"
"1472149900463","","magdalena"
"1472149900467","","magdalena"
"1472149900473","","magdalena"
"1472149900477","n = 1000","magdalena"
"1472149900482","","magdalena"
"1472149900486","s = 10","magdalena"
"1472149900491","","magdalena"
"1472149900495","beta = rep(0,s)","magdalena"
"1472149900499","","magdalena"
"1472149900502","","magdalena"
"1472149900505","","magdalena"
"1472149900509","","magdalena"
"1472149900515","","magdalena"
"1472149900518","prob=0.5","magdalena"
"1472149900524","treat=rbinom(n,1,prob)","magdalena"
"1472149900531","","magdalena"
"1472149900535","for (i in 1","magdalena"
"s){","","magdalena"
"1472149900540","y=beta[i]*treat+rnorm(n)","magdalena"
"1472149900547","if (i==1){","magdalena"
"1472149900552","y_mat=y","magdalena"
"1472149900556","}","magdalena"
"1472149900562","if (i>1){","magdalena"
"1472149900567","y_mat=cbind(y_mat,y)","magdalena"
"1472149900571","}","magdalena"
"1472149900576","}","magdalena"
"1472149900595","","magdalena"
"1472149900599","data=cbind(y_mat,treat)","magdalena"
"1472149900604","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1472149900610","data = as.data.frame(data)","magdalena"
"1472149900618","library(foreign)","magdalena"
"1472149900626","write.dta(data, datav1.dta)","magdalena"
"1472149900647","","magdalena"
"1472149900652","","magdalena"
"1472149900657","","magdalena"
"1472149900662","","magdalena"
"1472149900670","","magdalena"
"1472149900676","","magdalena"
"1472149900682","beta_hat=rep(NA,s)","magdalena"
"1472149900688","t_hat=rep(NA,s)","magdalena"
"1472149900693","reject_unadjust=rep(,s)","magdalena"
"1472149900699","for (i in 1","magdalena"
"s){","","magdalena"
"1472149900702","lm=lm(y_mat[,i]~treat)","magdalena"
"1472149900705","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472149900708","beta_hat[i]=lm$coefficients[2]","magdalena"
"1472149900708","","magdalena"
"1472149900708","t_hat[i]=abs(ct[2,3])","magdalena"
"1472149900708","","magdalena"
"1472149900708","if(ct[2,4]>0.1){","magdalena"
"1472149900724","reject_unadjust[i]=No","magdalena"
"1472149900724","}","magdalena"
"1472149900724","","magdalena"
"1472149900739","if(ct[2,4]<=0.1){","magdalena"
"1472149900739","reject_unadjust[i]=90","magdalena"
"1472149900739","}","magdalena"
"1472149900755","","magdalena"
"1472149900755","if(ct[2,4]<0.05){","magdalena"
"1472149900755","reject_unadjust[i]=95","magdalena"
"1472149900771","}","magdalena"
"1472149900771","","magdalena"
"1472149900771","if(ct[2,4]<0.01){","magdalena"
"1472149900786","reject_unadjust[i]=99","magdalena"
"1472149900786","}","magdalena"
"1472149900786","}","magdalena"
"1472149901659","","magdalena"
"1472149901662","data=rbind(t_hat,1)","magdalena"
"1472149901667","colnames(data)<-c(t_hat1,t_hat2,t_hat3,t_hat4,t_hat5,t_hat6,t_hat7,t_hat8,t_hat9,t_hat10)","magdalena"
"1472149901671","data = as.data.frame(data)","magdalena"
"1472149901675","library(foreign)","magdalena"
"1472149901680","write.dta(data, datav1_pvalues.dta)","magdalena"
"1472149901692","","magdalena"
"1472149901697","","magdalena"
"1472149901702","B=1000","magdalena"
"1472149901707","beta_bs=matrix(NA,B,s)","magdalena"
"1472149901713","t_bs=matrix(NA,B,s)","magdalena"
"1472149901719","for (i in 1","magdalena"
"B){","","magdalena"
"1472149901724","","magdalena"
"1472149901729","","magdalena"
"1472149901734","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1472149901751","y_mat_bs=y_mat[id,]","magdalena"
"1472149901756","treat_bs=treat[id]","magdalena"
"1472149901761","for (k in 1","magdalena"
"s){","","magdalena"
"1472149901766","lm=lm(y_mat_bs[,k]~treat_bs)","magdalena"
"1472149901770","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472149901776","beta_bs[i,k]=lm$coefficients[2]","magdalena"
"1472149901780","","magdalena"
"1472149901785","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/ct[2,2])","magdalena"
"1472149901790","}","magdalena"
"1472149901794","}","magdalena"
"1472150227955","","magdalena"
"1472150227959","data=t_bs","magdalena"
"1472150227962","colnames(data)<-c(t_bs1,t_bs2,t_bs3,t_bs4,t_bs5,t_bs6,t_bs7,t_bs8,t_bs9,t_bs10)","magdalena"
"1472150227966","data = as.data.frame(data)","magdalena"
"1472150227969","library(foreign)","magdalena"
"1472150227974","write.dta(data, datav1_bs.dta)","magdalena"
"1472150227987","","magdalena"
"1472150227992","alpha=c(0.95,0.975,0.995)","magdalena"
"1472150227997","","magdalena"
"1472150228003","reject_adjust=rep(,s)","magdalena"
"1472150295041","a=1","magdalena"
"1472150298533","t_hat_aux=t_hat","magdalena"
"1472150298537","t_bs_aux=t_bs","magdalena"
"1472150298537","done=F","magdalena"
"1472150306792","t_hat_aux","magdalena"
"1472150318483","reject_unadjust","magdalena"
"1472150343818","","magdalena"
"1472150343822","","magdalena"
"1472150343825","","magdalena"
"1472150343830","library(lmtest)","magdalena"
"1472150343836","library(sandwich)","magdalena"
"1472150343841","","magdalena"
"1472150343844","","magdalena"
"1472150343848","","magdalena"
"1472150343852","rm(list = ls())","magdalena"
"1472150343858","","magdalena"
"1472150343862","cat(\014)","magdalena"
"1472150343870","","magdalena"
"1472150343875","","magdalena"
"1472150343880","set.seed(100)","magdalena"
"1472150343885","","magdalena"
"1472150343889","n = 1000","magdalena"
"1472150343895","","magdalena"
"1472150343899","s = 10","magdalena"
"1472150343903","","magdalena"
"1472150343908","beta = rep(0,s)","magdalena"
"1472150343912","","magdalena"
"1472150343915","","magdalena"
"1472150343919","","magdalena"
"1472150343922","","magdalena"
"1472150343928","","magdalena"
"1472150343932","prob=0.5","magdalena"
"1472150343936","treat=rbinom(n,1,prob)","magdalena"
"1472150343942","","magdalena"
"1472150343947","for (i in 1","magdalena"
"s){","","magdalena"
"1472150343951","y=beta[i]*treat+rnorm(n)","magdalena"
"1472150343957","if (i==1){","magdalena"
"1472150343962","y_mat=y","magdalena"
"1472150343966","}","magdalena"
"1472150343970","if (i>1){","magdalena"
"1472150343975","y_mat=cbind(y_mat,y)","magdalena"
"1472150343979","}","magdalena"
"1472150343983","}","magdalena"
"1472150343997","","magdalena"
"1472150344001","data=cbind(y_mat,treat)","magdalena"
"1472150344005","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1472150344010","data = as.data.frame(data)","magdalena"
"1472150344017","library(foreign)","magdalena"
"1472150344021","write.dta(data, datav1.dta)","magdalena"
"1472150344036","","magdalena"
"1472150344040","","magdalena"
"1472150344044","","magdalena"
"1472150344049","","magdalena"
"1472150344053","","magdalena"
"1472150344053","","magdalena"
"1472150344053","beta_hat=rep(NA,s)","magdalena"
"1472150344053","t_hat=rep(NA,s)","magdalena"
"1472150344068","reject_unadjust=rep(,s)","magdalena"
"1472150344068","for (i in 1","magdalena"
"s){","","magdalena"
"1472150344068","lm=lm(y_mat[,i]~treat)","magdalena"
"1472150344068","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472150344084","beta_hat[i]=lm$coefficients[2]","magdalena"
"1472150344084","","magdalena"
"1472150344084","t_hat[i]=abs(ct[2,3])","magdalena"
"1472150344084","","magdalena"
"1472150344099","if(ct[2,4]>0.1){","magdalena"
"1472150344099","reject_unadjust[i]=No","magdalena"
"1472150344099","}","magdalena"
"1472150344099","","magdalena"
"1472150344115","if(ct[2,4]<=0.1){","magdalena"
"1472150344115","reject_unadjust[i]=90","magdalena"
"1472150344115","}","magdalena"
"1472150344131","","magdalena"
"1472150344131","if(ct[2,4]<0.05){","magdalena"
"1472150344131","reject_unadjust[i]=95","magdalena"
"1472150344149","}","magdalena"
"1472150344153","","magdalena"
"1472150344153","if(ct[2,4]<0.01){","magdalena"
"1472150344153","reject_unadjust[i]=99","magdalena"
"1472150344172","}","magdalena"
"1472150344179","}","magdalena"
"1472150344558","","magdalena"
"1472150344565","data=rbind(t_hat,1)","magdalena"
"1472150344573","colnames(data)<-c(t_hat1,t_hat2,t_hat3,t_hat4,t_hat5,t_hat6,t_hat7,t_hat8,t_hat9,t_hat10)","magdalena"
"1472150344581","data = as.data.frame(data)","magdalena"
"1472150344588","library(foreign)","magdalena"
"1472150344595","write.dta(data, datav1_pvalues.dta)","magdalena"
"1472150354328","reject_unadjust","magdalena"
"1472150369642","","magdalena"
"1472150369642","","magdalena"
"1472150369657","B=1000","magdalena"
"1472150369657","beta_bs=matrix(NA,B,s)","magdalena"
"1472150369657","t_bs=matrix(NA,B,s)","magdalena"
"1472150369675","for (i in 1","magdalena"
"B){","","magdalena"
"1472150369680","","magdalena"
"1472150369685","","magdalena"
"1472150369690","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1472150369693","y_mat_bs=y_mat[id,]","magdalena"
"1472150369693","treat_bs=treat[id]","magdalena"
"1472150369693","for (k in 1","magdalena"
"s){","","magdalena"
"1472150369710","lm=lm(y_mat_bs[,k]~treat_bs)","magdalena"
"1472150369745","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472150369751","beta_bs[i,k]=lm$coefficients[2]","magdalena"
"1472150369756","","magdalena"
"1472150369762","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/ct[2,2])","magdalena"
"1472150369769","}","magdalena"
"1472150369773","}","magdalena"
"1472150655344","","magdalena"
"1472150655347","data=t_bs","magdalena"
"1472150655350","colnames(data)<-c(t_bs1,t_bs2,t_bs3,t_bs4,t_bs5,t_bs6,t_bs7,t_bs8,t_bs9,t_bs10)","magdalena"
"1472150655354","data = as.data.frame(data)","magdalena"
"1472150655359","library(foreign)","magdalena"
"1472150655363","write.dta(data, datav1_bs.dta)","magdalena"
"1472150655372","","magdalena"
"1472150655378","alpha=c(0.95,0.975,0.995)","magdalena"
"1472150655383","","magdalena"
"1472150655388","reject_adjust=rep(,s)","magdalena"
"1472150666063","a=1","magdalena"
"1472150670276","t_hat_aux=t_hat","magdalena"
"1472150670293","t_bs_aux=t_bs","magdalena"
"1472150670298","done=F","magdalena"
"1472150677923","t_hat_aux","magdalena"
"1472150685330","t_max=max(t_hat_aux)","magdalena"
"1472150685333","k=which(t_hat_aux==t_max)","magdalena"
"1472150687705","t_max","magdalena"
"1472150690319","k","magdalena"
"1472150701659","!is.null(dim(t_bs_aux))","magdalena"
"1472150706474","t_bs_max=t_bs_aux[,k]","magdalena"
"1472150711744","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472150716876","t_quantile","magdalena"
"1472150726405","t_max>=t_quantile & !is.null(dim(t_bs_aux))","magdalena"
"1472150734313","is.null(dim(t_bs_aux))","magdalena"
"1472150740701","t_max<t_quantile | is.null(dim(t_bs_aux))","magdalena"
"1472150749006","t_max>=t_quantile","magdalena"
"1472150758136","reject_adjust=rep(,s)","magdalena"
"1472150758141","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1472150758143","t_hat_aux=t_hat","magdalena"
"1472150758143","t_bs_aux=t_bs","magdalena"
"1472150758143","done=F","magdalena"
"1472150758143","while(done==F){","magdalena"
"1472150758143","t_max=max(t_hat_aux)","magdalena"
"1472150758158","k=which(t_hat_aux==t_max)","magdalena"
"1472150758158","if(!is.null(dim(t_bs_aux))){","magdalena"
"1472150758158","t_bs_max=t_bs_aux[,k]","magdalena"
"1472150758158","}","magdalena"
"1472150758158","if(is.null(dim(t_bs_aux))){","magdalena"
"1472150758174","t_bs_max=t_bs_aux","magdalena"
"1472150758174","}","magdalena"
"1472150758174","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472150758174","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1472150758190","k_orig=which(t_hat==t_max)","magdalena"
"1472150758190","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472150758190","t_hat_aux=t_hat_aux[-k]","magdalena"
"1472150758190","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1472150758190","print(k_orig)","magdalena"
"1472150758205","}","magdalena"
"1472150758205","if(is.null(dim(t_bs_aux))){","magdalena"
"1472150758205","t_bs_max=t_bs_aux","magdalena"
"1472150758205","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472150758223","t_max=max(t_hat_aux)","magdalena"
"1472150758229","}","magdalena"
"1472150758233","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1472150758237","if(t_max>=t_quantile){","magdalena"
"1472150758241","k_orig=which(t_hat==t_max)","magdalena"
"1472150758245","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472150758249","}","magdalena"
"1472150758254","done=T","magdalena"
"1472150758258","}","magdalena"
"1472150758258","}","magdalena"
"1472150758258","}","magdalena"
"1472150758274","reject_adjust[reject_adjust==]=No","magdalena"
"1472150758274","","magdalena"
"1472150758289","beta_hat","magdalena"
"1472150758289","","magdalena"
"1472150758289","reject_unadjust","magdalena"
"1472150758289","","magdalena"
"1472150758305","reject_adjust","magdalena"
"1472150787631","","magdalena"
"1472150787635","","magdalena"
"1472150787639","","magdalena"
"1472150787645","library(lmtest)","magdalena"
"1472150787651","library(sandwich)","magdalena"
"1472150787658","","magdalena"
"1472150787663","","magdalena"
"1472150787669","","magdalena"
"1472150787673","rm(list = ls())","magdalena"
"1472150787681","","magdalena"
"1472150787685","cat(\014)","magdalena"
"1472150787693","","magdalena"
"1472150787700","","magdalena"
"1472150787704","","magdalena"
"1472150787710","","magdalena"
"1472150787715","n = 1000","magdalena"
"1472150787721","","magdalena"
"1472150787725","s = 10","magdalena"
"1472150787733","","magdalena"
"1472150787737","beta = rep(0,s)","magdalena"
"1472150787742","","magdalena"
"1472150787747","","magdalena"
"1472150787751","","magdalena"
"1472150787756","","magdalena"
"1472150787761","","magdalena"
"1472150787766","prob=0.1","magdalena"
"1472150787771","treat=rbinom(n,1,prob)","magdalena"
"1472150787778","","magdalena"
"1472150787783","for (i in 1","magdalena"
"s){","","magdalena"
"1472150787788","y=beta[i]*treat+rnorm(n)","magdalena"
"1472150787795","if (i==1){","magdalena"
"1472150787804","y_mat=y","magdalena"
"1472150787809","}","magdalena"
"1472150787813","if (i>1){","magdalena"
"1472150787818","y_mat=cbind(y_mat,y)","magdalena"
"1472150787822","}","magdalena"
"1472150787828","}","magdalena"
"1472150787844","","magdalena"
"1472150787849","data=cbind(y_mat,treat)","magdalena"
"1472150787855","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1472150787863","data = as.data.frame(data)","magdalena"
"1472150787869","library(foreign)","magdalena"
"1472150787876","write.dta(data, datav1.dta)","magdalena"
"1472150787896","","magdalena"
"1472150787901","","magdalena"
"1472150787907","","magdalena"
"1472150787911","","magdalena"
"1472150787917","","magdalena"
"1472150787923","","magdalena"
"1472150787929","beta_hat=rep(NA,s)","magdalena"
"1472150787937","t_hat=rep(NA,s)","magdalena"
"1472150787943","reject_unadjust=rep(,s)","magdalena"
"1472150787950","for (i in 1","magdalena"
"s){","","magdalena"
"1472150787954","lm=lm(y_mat[,i]~treat)","magdalena"
"1472150787960","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472150787965","beta_hat[i]=lm$coefficients[2]","magdalena"
"1472150787969","","magdalena"
"1472150787974","t_hat[i]=abs(ct[2,3])","magdalena"
"1472150787981","","magdalena"
"1472150787986","if(ct[2,4]>0.1){","magdalena"
"1472150787991","reject_unadjust[i]=No","magdalena"
"1472150787996","}","magdalena"
"1472150788003","","magdalena"
"1472150788008","if(ct[2,4]<=0.1){","magdalena"
"1472150788014","reject_unadjust[i]=90","magdalena"
"1472150788019","}","magdalena"
"1472150788025","","magdalena"
"1472150788031","if(ct[2,4]<0.05){","magdalena"
"1472150788037","reject_unadjust[i]=95","magdalena"
"1472150788042","}","magdalena"
"1472150788049","","magdalena"
"1472150788054","if(ct[2,4]<0.01){","magdalena"
"1472150788059","reject_unadjust[i]=99","magdalena"
"1472150788070","}","magdalena"
"1472150788076","}","magdalena"
"1472150788591","","magdalena"
"1472150788596","data=rbind(t_hat,1)","magdalena"
"1472150788602","colnames(data)<-c(t_hat1,t_hat2,t_hat3,t_hat4,t_hat5,t_hat6,t_hat7,t_hat8,t_hat9,t_hat10)","magdalena"
"1472150788607","data = as.data.frame(data)","magdalena"
"1472150788612","library(foreign)","magdalena"
"1472150788619","write.dta(data, datav1_pvalues.dta)","magdalena"
"1472150788631","","magdalena"
"1472150788637","","magdalena"
"1472150788642","B=1000","magdalena"
"1472150788649","beta_bs=matrix(NA,B,s)","magdalena"
"1472150788654","t_bs=matrix(NA,B,s)","magdalena"
"1472150788662","for (i in 1","magdalena"
"B){","","magdalena"
"1472150788667","","magdalena"
"1472150788671","","magdalena"
"1472150788677","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1472150788683","y_mat_bs=y_mat[id,]","magdalena"
"1472150788688","treat_bs=treat[id]","magdalena"
"1472150788694","for (k in 1","magdalena"
"s){","","magdalena"
"1472150788699","lm=lm(y_mat_bs[,k]~treat_bs)","magdalena"
"1472150788703","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472150788710","beta_bs[i,k]=lm$coefficients[2]","magdalena"
"1472150788715","","magdalena"
"1472150788722","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/ct[2,2])","magdalena"
"1472150788734","}","magdalena"
"1472150788747","}","magdalena"
"1472151106728","","magdalena"
"1472151106733","data=t_bs","magdalena"
"1472151106737","colnames(data)<-c(t_bs1,t_bs2,t_bs3,t_bs4,t_bs5,t_bs6,t_bs7,t_bs8,t_bs9,t_bs10)","magdalena"
"1472151106740","data = as.data.frame(data)","magdalena"
"1472151106740","library(foreign)","magdalena"
"1472151106740","write.dta(data, datav1_bs.dta)","magdalena"
"1472151106755","","magdalena"
"1472151106771","alpha=c(0.95,0.975,0.995)","magdalena"
"1472151106771","","magdalena"
"1472151106771","reject_adjust=rep(,s)","magdalena"
"1472151106787","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1472151106787","t_hat_aux=t_hat","magdalena"
"1472151106802","t_bs_aux=t_bs","magdalena"
"1472151106802","done=F","magdalena"
"1472151106802","while(done==F){","magdalena"
"1472151106802","t_max=max(t_hat_aux)","magdalena"
"1472151106818","k=which(t_hat_aux==t_max)","magdalena"
"1472151106818","if(!is.null(dim(t_bs_aux))){","magdalena"
"1472151106818","t_bs_max=t_bs_aux[,k]","magdalena"
"1472151106838","}","magdalena"
"1472151106842","if(is.null(dim(t_bs_aux))){","magdalena"
"1472151106847","t_bs_max=t_bs_aux","magdalena"
"1472151106851","}","magdalena"
"1472151106857","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472151106864","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1472151106868","k_orig=which(t_hat==t_max)","magdalena"
"1472151106872","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472151106875","t_hat_aux=t_hat_aux[-k]","magdalena"
"1472151106880","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1472151106880","print(k_orig)","magdalena"
"1472151106880","}","magdalena"
"1472151106896","if(is.null(dim(t_bs_aux))){","magdalena"
"1472151106896","t_bs_max=t_bs_aux","magdalena"
"1472151106896","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472151106896","t_max=max(t_hat_aux)","magdalena"
"1472151106911","}","magdalena"
"1472151106911","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1472151106911","if(t_max>=t_quantile){","magdalena"
"1472151106927","k_orig=which(t_hat==t_max)","magdalena"
"1472151106927","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472151106927","}","magdalena"
"1472151106927","done=T","magdalena"
"1472151106943","}","magdalena"
"1472151106943","}","magdalena"
"1472151106943","}","magdalena"
"1472151106958","reject_adjust[reject_adjust==]=No","magdalena"
"1472151106958","","magdalena"
"1472151106977","beta_hat","magdalena"
"1472151106980","","magdalena"
"1472151106980","reject_unadjust","magdalena"
"1472151106996","","magdalena"
"1472151106996","reject_adjust","magdalena"
"1472151321675","","magdalena"
"1472151321679","","magdalena"
"1472151321683","","magdalena"
"1472151321688","library(lmtest)","magdalena"
"1472151321693","library(sandwich)","magdalena"
"1472151321699","","magdalena"
"1472151321703","","magdalena"
"1472151321709","","magdalena"
"1472151321713","rm(list = ls())","magdalena"
"1472151321722","","magdalena"
"1472151321726","cat(\014)","magdalena"
"1472151321735","","magdalena"
"1472151321743","","magdalena"
"1472151321747","set.seed(100)","magdalena"
"1472151321754","","magdalena"
"1472151321760","n = 1000","magdalena"
"1472151321766","","magdalena"
"1472151321771","s = 10","magdalena"
"1472151321778","","magdalena"
"1472151321783","beta = rep(0,s)","magdalena"
"1472151321789","","magdalena"
"1472151321793","","magdalena"
"1472151321798","","magdalena"
"1472151321804","","magdalena"
"1472151321811","","magdalena"
"1472151321815","prob=0.1","magdalena"
"1472151321820","treat=rbinom(n,1,prob)","magdalena"
"1472151321829","","magdalena"
"1472151321835","for (i in 1","magdalena"
"s){","","magdalena"
"1472151321842","y=beta[i]*treat+rnorm(n)","magdalena"
"1472151321851","if (i==1){","magdalena"
"1472151321856","y_mat=y","magdalena"
"1472151321860","}","magdalena"
"1472151321866","if (i>1){","magdalena"
"1472151321873","y_mat=cbind(y_mat,y)","magdalena"
"1472151321878","}","magdalena"
"1472151321883","}","magdalena"
"1472151321902","","magdalena"
"1472151321907","data=cbind(y_mat,treat)","magdalena"
"1472151321913","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1472151321919","data = as.data.frame(data)","magdalena"
"1472151321927","library(foreign)","magdalena"
"1472151321934","write.dta(data, datav1.dta)","magdalena"
"1472151321951","","magdalena"
"1472151321958","","magdalena"
"1472151321964","","magdalena"
"1472151321968","","magdalena"
"1472151321974","","magdalena"
"1472151321980","","magdalena"
"1472151321986","beta_hat=rep(NA,s)","magdalena"
"1472151321992","t_hat=rep(NA,s)","magdalena"
"1472151321998","reject_unadjust=rep(,s)","magdalena"
"1472151322005","for (i in 1","magdalena"
"s){","","magdalena"
"1472151322010","lm=lm(y_mat[,i]~treat)","magdalena"
"1472151322015","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472151322020","beta_hat[i]=lm$coefficients[2]","magdalena"
"1472151322025","","magdalena"
"1472151322030","t_hat[i]=abs(ct[2,3])","magdalena"
"1472151322036","","magdalena"
"1472151322041","if(ct[2,4]>0.1){","magdalena"
"1472151322046","reject_unadjust[i]=No","magdalena"
"1472151322051","}","magdalena"
"1472151322058","","magdalena"
"1472151322063","if(ct[2,4]<=0.1){","magdalena"
"1472151322068","reject_unadjust[i]=90","magdalena"
"1472151322073","}","magdalena"
"1472151322080","","magdalena"
"1472151322085","if(ct[2,4]<0.05){","magdalena"
"1472151322090","reject_unadjust[i]=95","magdalena"
"1472151322095","}","magdalena"
"1472151322101","","magdalena"
"1472151322106","if(ct[2,4]<0.01){","magdalena"
"1472151322111","reject_unadjust[i]=99","magdalena"
"1472151322117","}","magdalena"
"1472151322122","}","magdalena"
"1472151322636","","magdalena"
"1472151322636","data=rbind(t_hat,1)","magdalena"
"1472151322651","colnames(data)<-c(t_hat1,t_hat2,t_hat3,t_hat4,t_hat5,t_hat6,t_hat7,t_hat8,t_hat9,t_hat10)","magdalena"
"1472151322651","data = as.data.frame(data)","magdalena"
"1472151322651","library(foreign)","magdalena"
"1472151322651","write.dta(data, datav1_pvalues.dta)","magdalena"
"1472151330701","reject_unadjust","magdalena"
"1472151343383","","magdalena"
"1472151343387","B=1000","magdalena"
"1472151343394","beta_bs=matrix(NA,B,s)","magdalena"
"1472151343399","t_bs=matrix(NA,B,s)","magdalena"
"1472151343405","for (i in 1","magdalena"
"B){","","magdalena"
"1472151343409","","magdalena"
"1472151343412","","magdalena"
"1472151343418","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1472151343424","y_mat_bs=y_mat[id,]","magdalena"
"1472151343428","treat_bs=treat[id]","magdalena"
"1472151343433","for (k in 1","magdalena"
"s){","","magdalena"
"1472151343438","lm=lm(y_mat_bs[,k]~treat_bs)","magdalena"
"1472151343442","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472151343447","beta_bs[i,k]=lm$coefficients[2]","magdalena"
"1472151343451","","magdalena"
"1472151343455","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/ct[2,2])","magdalena"
"1472151343459","}","magdalena"
"1472151343463","}","magdalena"
"1472151709801","","magdalena"
"1472151709801","data=t_bs","magdalena"
"1472151709817","colnames(data)<-c(t_bs1,t_bs2,t_bs3,t_bs4,t_bs5,t_bs6,t_bs7,t_bs8,t_bs9,t_bs10)","magdalena"
"1472151709822","data = as.data.frame(data)","magdalena"
"1472151709823","library(foreign)","magdalena"
"1472151709823","write.dta(data, datav1_bs.dta)","magdalena"
"1472151709839","","magdalena"
"1472151709839","alpha=c(0.95,0.975,0.995)","magdalena"
"1472151709839","","magdalena"
"1472151709854","reject_adjust=rep(,s)","magdalena"
"1472151709854","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1472151709870","t_hat_aux=t_hat","magdalena"
"1472151709875","t_bs_aux=t_bs","magdalena"
"1472151709880","done=F","magdalena"
"1472151709884","while(done==F){","magdalena"
"1472151709888","t_max=max(t_hat_aux)","magdalena"
"1472151709893","k=which(t_hat_aux==t_max)","magdalena"
"1472151709899","if(!is.null(dim(t_bs_aux))){","magdalena"
"1472151709904","t_bs_max=t_bs_aux[,k]","magdalena"
"1472151709904","}","magdalena"
"1472151709904","if(is.null(dim(t_bs_aux))){","magdalena"
"1472151709904","t_bs_max=t_bs_aux","magdalena"
"1472151709922","}","magdalena"
"1472151709924","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472151709924","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1472151709924","k_orig=which(t_hat==t_max)","magdalena"
"1472151709939","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472151709939","t_hat_aux=t_hat_aux[-k]","magdalena"
"1472151709939","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1472151709955","print(k_orig)","magdalena"
"1472151709955","}","magdalena"
"1472151709967","if(is.null(dim(t_bs_aux))){","magdalena"
"1472151709976","t_bs_max=t_bs_aux","magdalena"
"1472151709981","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472151709986","t_max=max(t_hat_aux)","magdalena"
"1472151709990","}","magdalena"
"1472151709996","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1472151709998","if(t_max>=t_quantile){","magdalena"
"1472151709998","k_orig=which(t_hat==t_max)","magdalena"
"1472151709998","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472151710015","}","magdalena"
"1472151710019","done=T","magdalena"
"1472151710023","}","magdalena"
"1472151710028","}","magdalena"
"1472151710032","}","magdalena"
"1472151710044","reject_adjust[reject_adjust==]=No","magdalena"
"1472151710048","","magdalena"
"1472151710048","beta_hat","magdalena"
"1472151710048","","magdalena"
"1472151710048","reject_unadjust","magdalena"
"1472151710063","","magdalena"
"1472151710063","reject_adjust","magdalena"
"1472151750387","a=1","magdalena"
"1472151754285","t_hat_aux=t_hat","magdalena"
"1472151754290","t_bs_aux=t_bs","magdalena"
"1472151754295","done=F","magdalena"
"1472151763950","t_max","magdalena"
"1472151777457","reject_unadjust","magdalena"
"1472151787358","t_hat","magdalena"
"1472151808915","t_bs_max=t_bs_aux[,k]","magdalena"
"1472151816383","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472151821300","t_quantile","magdalena"
"1472151904262","","magdalena"
"1472151904268","","magdalena"
"1472151904271","","magdalena"
"1472151904275","library(lmtest)","magdalena"
"1472151904280","library(sandwich)","magdalena"
"1472151904283","","magdalena"
"1472151904283","","magdalena"
"1472151904283","","magdalena"
"1472151904300","rm(list = ls())","magdalena"
"1472151904306","","magdalena"
"1472151904310","cat(\014)","magdalena"
"1472151904313","","magdalena"
"1472151904313","","magdalena"
"1472151904313","set.seed(100)","magdalena"
"1472151904328","","magdalena"
"1472151904328","n = 1000","magdalena"
"1472151904328","","magdalena"
"1472151904344","s = 10","magdalena"
"1472151904344","","magdalena"
"1472151904344","beta = rep(0,s)","magdalena"
"1472151904344","","magdalena"
"1472151904360","","magdalena"
"1472151904360","","magdalena"
"1472151904360","","magdalena"
"1472151904360","","magdalena"
"1472151904375","prob=0.1","magdalena"
"1472151904375","treat=rbinom(n,1,prob)","magdalena"
"1472151904375","","magdalena"
"1472151904391","for (i in 1","magdalena"
"s){","","magdalena"
"1472151904391","y=beta[i]*treat+rnorm(n)","magdalena"
"1472151904391","if (i==1){","magdalena"
"1472151904391","y_mat=y","magdalena"
"1472151904407","}","magdalena"
"1472151904413","if (i>1){","magdalena"
"1472151904418","y_mat=cbind(y_mat,y)","magdalena"
"1472151904423","}","magdalena"
"1472151904428","}","magdalena"
"1472151904442","","magdalena"
"1472151904447","data=cbind(y_mat,treat)","magdalena"
"1472151904452","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1472151904459","data = as.data.frame(data)","magdalena"
"1472151904464","library(foreign)","magdalena"
"1472151904470","write.dta(data, datav1.dta)","magdalena"
"1472151904489","","magdalena"
"1472151904493","","magdalena"
"1472151904499","","magdalena"
"1472151904506","","magdalena"
"1472151904513","","magdalena"
"1472151904519","","magdalena"
"1472151904524","beta_hat=rep(NA,s)","magdalena"
"1472151904529","t_hat=rep(NA,s)","magdalena"
"1472151904535","reject_unadjust=rep(,s)","magdalena"
"1472151904543","for (i in 1","magdalena"
"s){","","magdalena"
"1472151904549","lm=lm(y_mat[,i]~treat)","magdalena"
"1472151904555","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472151904560","beta_hat[i]=lm$coefficients[2]","magdalena"
"1472151904564","","magdalena"
"1472151904569","t_hat[i]=abs(ct[2,3])","magdalena"
"1472151904576","","magdalena"
"1472151904581","if(ct[2,4]>0.1){","magdalena"
"1472151904585","reject_unadjust[i]=No","magdalena"
"1472151904590","}","magdalena"
"1472151904596","","magdalena"
"1472151904601","if(ct[2,4]<=0.1){","magdalena"
"1472151904607","reject_unadjust[i]=90","magdalena"
"1472151904612","}","magdalena"
"1472151904619","","magdalena"
"1472151904624","if(ct[2,4]<0.05){","magdalena"
"1472151904629","reject_unadjust[i]=95","magdalena"
"1472151904634","}","magdalena"
"1472151904642","","magdalena"
"1472151904647","if(ct[2,4]<0.01){","magdalena"
"1472151904652","reject_unadjust[i]=99","magdalena"
"1472151904657","}","magdalena"
"1472151904661","}","magdalena"
"1472151905201","","magdalena"
"1472151905204","data=rbind(t_hat,1)","magdalena"
"1472151905207","colnames(data)<-c(t_hat1,t_hat2,t_hat3,t_hat4,t_hat5,t_hat6,t_hat7,t_hat8,t_hat9,t_hat10)","magdalena"
"1472151905212","data = as.data.frame(data)","magdalena"
"1472151905216","library(foreign)","magdalena"
"1472151905222","write.dta(data, datav1_pvalues.dta)","magdalena"
"1472151918261","i=1","magdalena"
"1472151931813","lm(y_mat[,i]~treat)","magdalena"
"1472151945383","lm=lm(y_mat[,i]~treat)","magdalena"
"1472151950411","coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472151956843","i=4","magdalena"
"1472151961704","lm=lm(y_mat[,i]~treat)","magdalena"
"1472151984066","summary(lm)","magdalena"
"1472151996737","i=3","magdalena"
"1472152002084","lm=lm(y_mat[,i]~treat)","magdalena"
"1472152005606","summary(lm)","magdalena"
"1472152088160","","magdalena"
"1472152088164","","magdalena"
"1472152088168","","magdalena"
"1472152088173","library(lmtest)","magdalena"
"1472152088180","library(sandwich)","magdalena"
"1472152088187","","magdalena"
"1472152088191","","magdalena"
"1472152088197","","magdalena"
"1472152088201","rm(list = ls())","magdalena"
"1472152088207","","magdalena"
"1472152088211","cat(\014)","magdalena"
"1472152088216","","magdalena"
"1472152088221","","magdalena"
"1472152088224","set.seed(100)","magdalena"
"1472152088228","","magdalena"
"1472152088232","n = 1000","magdalena"
"1472152088237","","magdalena"
"1472152088241","s = 10","magdalena"
"1472152088246","","magdalena"
"1472152088251","beta = rep(0,s)","magdalena"
"1472152088255","","magdalena"
"1472152088258","","magdalena"
"1472152088262","","magdalena"
"1472152088266","","magdalena"
"1472152088271","","magdalena"
"1472152088274","prob=0.2","magdalena"
"1472152088275","treat=rbinom(n,1,prob)","magdalena"
"1472152088275","","magdalena"
"1472152088275","for (i in 1","magdalena"
"s){","","magdalena"
"1472152088275","y=beta[i]*treat+rnorm(n)","magdalena"
"1472152088275","if (i==1){","magdalena"
"1472152088291","y_mat=y","magdalena"
"1472152088291","}","magdalena"
"1472152088291","if (i>1){","magdalena"
"1472152088291","y_mat=cbind(y_mat,y)","magdalena"
"1472152088291","}","magdalena"
"1472152088307","}","magdalena"
"1472152088307","","magdalena"
"1472152088307","data=cbind(y_mat,treat)","magdalena"
"1472152088307","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1472152088322","data = as.data.frame(data)","magdalena"
"1472152088322","library(foreign)","magdalena"
"1472152088322","write.dta(data, datav1.dta)","magdalena"
"1472152088338","","magdalena"
"1472152088347","","magdalena"
"1472152088351","","magdalena"
"1472152088355","","magdalena"
"1472152088355","","magdalena"
"1472152088355","","magdalena"
"1472152088355","beta_hat=rep(NA,s)","magdalena"
"1472152088372","t_hat=rep(NA,s)","magdalena"
"1472152088376","reject_unadjust=rep(,s)","magdalena"
"1472152088380","for (i in 1","magdalena"
"s){","","magdalena"
"1472152088382","lm=lm(y_mat[,i]~treat)","magdalena"
"1472152088386","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472152088389","beta_hat[i]=lm$coefficients[2]","magdalena"
"1472152088392","","magdalena"
"1472152088396","t_hat[i]=abs(ct[2,3])","magdalena"
"1472152088399","","magdalena"
"1472152088399","if(ct[2,4]>0.1){","magdalena"
"1472152088399","reject_unadjust[i]=No","magdalena"
"1472152088399","}","magdalena"
"1472152088399","","magdalena"
"1472152088415","if(ct[2,4]<=0.1){","magdalena"
"1472152088415","reject_unadjust[i]=90","magdalena"
"1472152088415","}","magdalena"
"1472152088415","","magdalena"
"1472152088430","if(ct[2,4]<0.05){","magdalena"
"1472152088430","reject_unadjust[i]=95","magdalena"
"1472152088430","}","magdalena"
"1472152088430","","magdalena"
"1472152088446","if(ct[2,4]<0.01){","magdalena"
"1472152088446","reject_unadjust[i]=99","magdalena"
"1472152088446","}","magdalena"
"1472152088446","}","magdalena"
"1472152088959","","magdalena"
"1472152088965","data=rbind(t_hat,1)","magdalena"
"1472152088970","colnames(data)<-c(t_hat1,t_hat2,t_hat3,t_hat4,t_hat5,t_hat6,t_hat7,t_hat8,t_hat9,t_hat10)","magdalena"
"1472152088978","data = as.data.frame(data)","magdalena"
"1472152088985","library(foreign)","magdalena"
"1472152088998","write.dta(data, datav1_pvalues.dta)","magdalena"
"1472152089013","","magdalena"
"1472152089018","","magdalena"
"1472152089023","B=1000","magdalena"
"1472152089030","beta_bs=matrix(NA,B,s)","magdalena"
"1472152089035","t_bs=matrix(NA,B,s)","magdalena"
"1472152089042","for (i in 1","magdalena"
"B){","","magdalena"
"1472152089047","","magdalena"
"1472152089052","","magdalena"
"1472152089059","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1472152089065","y_mat_bs=y_mat[id,]","magdalena"
"1472152089070","treat_bs=treat[id]","magdalena"
"1472152089076","for (k in 1","magdalena"
"s){","","magdalena"
"1472152089081","lm=lm(y_mat_bs[,k]~treat_bs)","magdalena"
"1472152089086","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472152089092","beta_bs[i,k]=lm$coefficients[2]","magdalena"
"1472152089097","","magdalena"
"1472152089102","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/ct[2,2])","magdalena"
"1472152089110","}","magdalena"
"1472152089116","}","magdalena"
"1472152388038","","magdalena"
"1472152388038","data=t_bs","magdalena"
"1472152388038","colnames(data)<-c(t_bs1,t_bs2,t_bs3,t_bs4,t_bs5,t_bs6,t_bs7,t_bs8,t_bs9,t_bs10)","magdalena"
"1472152388038","data = as.data.frame(data)","magdalena"
"1472152388038","library(foreign)","magdalena"
"1472152388056","write.dta(data, datav1_bs.dta)","magdalena"
"1472152388061","","magdalena"
"1472152388061","alpha=c(0.95,0.975,0.995)","magdalena"
"1472152388076","","magdalena"
"1472152388076","reject_adjust=rep(,s)","magdalena"
"1472152388076","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1472152388092","t_hat_aux=t_hat","magdalena"
"1472152388092","t_bs_aux=t_bs","magdalena"
"1472152388092","done=F","magdalena"
"1472152388092","while(done==F){","magdalena"
"1472152388108","t_max=max(t_hat_aux)","magdalena"
"1472152388108","k=which(t_hat_aux==t_max)","magdalena"
"1472152388108","if(!is.null(dim(t_bs_aux))){","magdalena"
"1472152388108","t_bs_max=t_bs_aux[,k]","magdalena"
"1472152388123","}","magdalena"
"1472152388123","if(is.null(dim(t_bs_aux))){","magdalena"
"1472152388123","t_bs_max=t_bs_aux","magdalena"
"1472152388123","}","magdalena"
"1472152388139","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472152388139","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1472152388139","k_orig=which(t_hat==t_max)","magdalena"
"1472152388139","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472152388159","t_hat_aux=t_hat_aux[-k]","magdalena"
"1472152388163","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1472152388168","print(k_orig)","magdalena"
"1472152388173","}","magdalena"
"1472152388179","if(is.null(dim(t_bs_aux))){","magdalena"
"1472152388185","t_bs_max=t_bs_aux","magdalena"
"1472152388190","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472152388194","t_max=max(t_hat_aux)","magdalena"
"1472152388198","}","magdalena"
"1472152388204","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1472152388204","if(t_max>=t_quantile){","magdalena"
"1472152388204","k_orig=which(t_hat==t_max)","magdalena"
"1472152388204","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472152388219","}","magdalena"
"1472152388225","done=T","magdalena"
"1472152388225","}","magdalena"
"1472152388225","}","magdalena"
"1472152388225","}","magdalena"
"1472152388241","reject_adjust[reject_adjust==]=No","magdalena"
"1472152388241","","magdalena"
"1472152388241","beta_hat","magdalena"
"1472152388261","","magdalena"
"1472152388261","reject_unadjust","magdalena"
"1472152388261","","magdalena"
"1472152388276","reject_adjust","magdalena"
"1472152428758","","magdalena"
"1472152428765","","magdalena"
"1472152428768","","magdalena"
"1472152428772","library(lmtest)","magdalena"
"1472152428776","library(sandwich)","magdalena"
"1472152428781","","magdalena"
"1472152428783","","magdalena"
"1472152428788","","magdalena"
"1472152428791","rm(list = ls())","magdalena"
"1472152428796","","magdalena"
"1472152428800","cat(\014)","magdalena"
"1472152428803","","magdalena"
"1472152428803","","magdalena"
"1472152428803","set.seed(100)","magdalena"
"1472152428803","","magdalena"
"1472152428803","n = 1000","magdalena"
"1472152428820","","magdalena"
"1472152428823","s = 10","magdalena"
"1472152428826","","magdalena"
"1472152428826","beta = rep(0,s)","magdalena"
"1472152428826","","magdalena"
"1472152428826","","magdalena"
"1472152428826","","magdalena"
"1472152428842","","magdalena"
"1472152428842","","magdalena"
"1472152428842","beta_hyp=rep(0,s)","magdalena"
"1472152428842","","magdalena"
"1472152428842","prob=0.1","magdalena"
"1472152428858","treat=rbinom(n,1,prob)","magdalena"
"1472152428858","","magdalena"
"1472152428867","for (i in 1","magdalena"
"s){","","magdalena"
"1472152428869","y=beta[i]*treat+rnorm(n)","magdalena"
"1472152428869","if (i==1){","magdalena"
"1472152428869","y_mat=y","magdalena"
"1472152428869","}","magdalena"
"1472152428869","if (i>1){","magdalena"
"1472152428869","y_mat=cbind(y_mat,y)","magdalena"
"1472152428885","}","magdalena"
"1472152428885","}","magdalena"
"1472152428901","","magdalena"
"1472152428901","data=cbind(y_mat,treat)","magdalena"
"1472152428901","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1472152428918","data = as.data.frame(data)","magdalena"
"1472152428923","library(foreign)","magdalena"
"1472152428927","write.dta(data, datav1.dta)","magdalena"
"1472152428937","","magdalena"
"1472152428937","","magdalena"
"1472152428937","","magdalena"
"1472152428937","","magdalena"
"1472152428937","","magdalena"
"1472152428952","","magdalena"
"1472152428952","beta_hat=rep(NA,s)","magdalena"
"1472152428952","t_hat=rep(NA,s)","magdalena"
"1472152428952","reject_unadjust=rep(,s)","magdalena"
"1472152428952","for (i in 1","magdalena"
"s){","","magdalena"
"1472152428968","lm=lm(y_mat[,i]~treat)","magdalena"
"1472152428968","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472152428968","beta_hat[i]=lm$coefficients[2]","magdalena"
"1472152428968","","magdalena"
"1472152428968","t_hat[i]=abs(ct[2,3])","magdalena"
"1472152428968","","magdalena"
"1472152428984","if(ct[2,4]>0.1){","magdalena"
"1472152428984","reject_unadjust[i]=No","magdalena"
"1472152428984","}","magdalena"
"1472152428984","","magdalena"
"1472152428984","if(ct[2,4]<=0.1){","magdalena"
"1472152428999","reject_unadjust[i]=90","magdalena"
"1472152428999","}","magdalena"
"1472152428999","","magdalena"
"1472152428999","if(ct[2,4]<0.05){","magdalena"
"1472152428999","reject_unadjust[i]=95","magdalena"
"1472152428999","}","magdalena"
"1472152429019","","magdalena"
"1472152429023","if(ct[2,4]<0.01){","magdalena"
"1472152429026","reject_unadjust[i]=99","magdalena"
"1472152429026","}","magdalena"
"1472152429026","}","magdalena"
"1472152429305","","magdalena"
"1472152429305","data=rbind(t_hat,1)","magdalena"
"1472152429323","colnames(data)<-c(t_hat1,t_hat2,t_hat3,t_hat4,t_hat5,t_hat6,t_hat7,t_hat8,t_hat9,t_hat10)","magdalena"
"1472152429327","data = as.data.frame(data)","magdalena"
"1472152429327","library(foreign)","magdalena"
"1472152429327","write.dta(data, datav1_pvalues.dta)","magdalena"
"1472152460122","","magdalena"
"1472152460122","","magdalena"
"1472152460122","B=1000","magdalena"
"1472152460122","beta_bs=matrix(NA,B,s)","magdalena"
"1472152460138","t_bs=matrix(NA,B,s)","magdalena"
"1472152460138","for (i in 1","magdalena"
"B){","","magdalena"
"1472152460138","","magdalena"
"1472152460138","","magdalena"
"1472152460155","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1472152460159","y_mat_bs=y_mat[id,]","magdalena"
"1472152460159","treat_bs=treat[id]","magdalena"
"1472152460159","for (k in 1","magdalena"
"s){","","magdalena"
"1472152460159","lm=lm(y_mat_bs[,k]~treat_bs)","magdalena"
"1472152460159","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472152460174","beta_bs[i,k]=lm$coefficients[2]","magdalena"
"1472152460174","","magdalena"
"1472152460174","","magdalena"
"1472152460190","t_bs[i,k]=abs((beta_bs[i,k]-beta_hyp[k])/ct[2,2])","magdalena"
"1472152460190","}","magdalena"
"1472152460190","}","magdalena"
"1472152784593","","magdalena"
"1472152784593","data=t_bs","magdalena"
"1472152784609","colnames(data)<-c(t_bs1,t_bs2,t_bs3,t_bs4,t_bs5,t_bs6,t_bs7,t_bs8,t_bs9,t_bs10)","magdalena"
"1472152784609","data = as.data.frame(data)","magdalena"
"1472152784609","library(foreign)","magdalena"
"1472152784624","write.dta(data, datav1_bs.dta)","magdalena"
"1472152784640","","magdalena"
"1472152784640","alpha=c(0.95,0.975,0.995)","magdalena"
"1472152784660","","magdalena"
"1472152784668","reject_adjust=rep(,s)","magdalena"
"1472152784674","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1472152784680","t_hat_aux=t_hat","magdalena"
"1472152784685","t_bs_aux=t_bs","magdalena"
"1472152784689","done=F","magdalena"
"1472152784694","while(done==F){","magdalena"
"1472152784701","t_max=max(t_hat_aux)","magdalena"
"1472152784701","k=which(t_hat_aux==t_max)","magdalena"
"1472152784701","if(!is.null(dim(t_bs_aux))){","magdalena"
"1472152784716","t_bs_max=t_bs_aux[,k]","magdalena"
"1472152784716","}","magdalena"
"1472152784716","if(is.null(dim(t_bs_aux))){","magdalena"
"1472152784716","t_bs_max=t_bs_aux","magdalena"
"1472152784732","}","magdalena"
"1472152784732","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472152784732","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1472152784747","k_orig=which(t_hat==t_max)","magdalena"
"1472152784747","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472152784747","t_hat_aux=t_hat_aux[-k]","magdalena"
"1472152784766","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1472152784771","print(k_orig)","magdalena"
"1472152784776","}","magdalena"
"1472152784782","if(is.null(dim(t_bs_aux))){","magdalena"
"1472152784788","t_bs_max=t_bs_aux","magdalena"
"1472152784792","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472152784796","t_max=max(t_hat_aux)","magdalena"
"1472152784802","}","magdalena"
"1472152784809","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1472152784814","if(t_max>=t_quantile){","magdalena"
"1472152784820","k_orig=which(t_hat==t_max)","magdalena"
"1472152784825","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472152784830","}","magdalena"
"1472152784835","done=T","magdalena"
"1472152784839","}","magdalena"
"1472152784851","}","magdalena"
"1472152784857","}","magdalena"
"1472152784888","reject_adjust[reject_adjust==]=No","magdalena"
"1472152784897","","magdalena"
"1472152784905","beta_hat","magdalena"
"1472152784914","","magdalena"
"1472152784919","reject_unadjust","magdalena"
"1472152784927","","magdalena"
"1472152784933","reject_adjust","magdalena"
"1472152866316","","magdalena"
"1472152866316","","magdalena"
"1472152866316","","magdalena"
"1472152866316","library(lmtest)","magdalena"
"1472152866332","library(sandwich)","magdalena"
"1472152866332","","magdalena"
"1472152866332","","magdalena"
"1472152866332","","magdalena"
"1472152866332","rm(list = ls())","magdalena"
"1472152866348","","magdalena"
"1472152866348","cat(\014)","magdalena"
"1472152866348","","magdalena"
"1472152866348","","magdalena"
"1472152866348","","magdalena"
"1472152866363","","magdalena"
"1472152866363","n = 1000","magdalena"
"1472152866363","","magdalena"
"1472152866363","s = 10","magdalena"
"1472152866363","","magdalena"
"1472152866379","beta = rep(0,s)","magdalena"
"1472152866379","","magdalena"
"1472152866379","beta[1]=0.5","magdalena"
"1472152866379","","magdalena"
"1472152866379","","magdalena"
"1472152866396","","magdalena"
"1472152866396","beta_hyp=rep(0,s)","magdalena"
"1472152866396","","magdalena"
"1472152866412","prob=0.2","magdalena"
"1472152866412","treat=rbinom(n,1,prob)","magdalena"
"1472152866412","","magdalena"
"1472152866412","for (i in 1","magdalena"
"s){","","magdalena"
"1472152866412","y=beta[i]*treat+rnorm(n)","magdalena"
"1472152866427","if (i==1){","magdalena"
"1472152866427","y_mat=y","magdalena"
"1472152866427","}","magdalena"
"1472152866427","if (i>1){","magdalena"
"1472152866427","y_mat=cbind(y_mat,y)","magdalena"
"1472152866443","}","magdalena"
"1472152866443","}","magdalena"
"1472152866458","","magdalena"
"1472152866458","data=cbind(y_mat,treat)","magdalena"
"1472152866474","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1472152866474","data = as.data.frame(data)","magdalena"
"1472152866490","library(foreign)","magdalena"
"1472152866497","write.dta(data, datav1.dta)","magdalena"
"1472152866513","","magdalena"
"1472152866517","","magdalena"
"1472152866521","","magdalena"
"1472152866525","","magdalena"
"1472152866531","","magdalena"
"1472152866536","","magdalena"
"1472152866541","beta_hat=rep(NA,s)","magdalena"
"1472152866545","t_hat=rep(NA,s)","magdalena"
"1472152866550","reject_unadjust=rep(,s)","magdalena"
"1472152866554","for (i in 1","magdalena"
"s){","","magdalena"
"1472152866559","lm=lm(y_mat[,i]~treat)","magdalena"
"1472152866563","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472152866567","beta_hat[i]=lm$coefficients[2]","magdalena"
"1472152866571","","magdalena"
"1472152866574","t_hat[i]=abs(ct[2,3])","magdalena"
"1472152866580","","magdalena"
"1472152866584","if(ct[2,4]>0.1){","magdalena"
"1472152866588","reject_unadjust[i]=No","magdalena"
"1472152866593","}","magdalena"
"1472152866598","","magdalena"
"1472152866603","if(ct[2,4]<=0.1){","magdalena"
"1472152866608","reject_unadjust[i]=90","magdalena"
"1472152866613","}","magdalena"
"1472152866618","","magdalena"
"1472152866623","if(ct[2,4]<0.05){","magdalena"
"1472152866626","reject_unadjust[i]=95","magdalena"
"1472152866630","}","magdalena"
"1472152866635","","magdalena"
"1472152866640","if(ct[2,4]<0.01){","magdalena"
"1472152866644","reject_unadjust[i]=99","magdalena"
"1472152866648","}","magdalena"
"1472152866652","}","magdalena"
"1472152867133","","magdalena"
"1472152867137","data=rbind(t_hat,1)","magdalena"
"1472152867143","colnames(data)<-c(t_hat1,t_hat2,t_hat3,t_hat4,t_hat5,t_hat6,t_hat7,t_hat8,t_hat9,t_hat10)","magdalena"
"1472152867148","data = as.data.frame(data)","magdalena"
"1472152867153","library(foreign)","magdalena"
"1472152867160","write.dta(data, datav1_pvalues.dta)","magdalena"
"1472152867171","","magdalena"
"1472152867177","","magdalena"
"1472152867181","B=1000","magdalena"
"1472152867188","beta_bs=matrix(NA,B,s)","magdalena"
"1472152867193","t_bs=matrix(NA,B,s)","magdalena"
"1472152867200","for (i in 1","magdalena"
"B){","","magdalena"
"1472152867205","","magdalena"
"1472152867209","","magdalena"
"1472152867215","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1472152867221","y_mat_bs=y_mat[id,]","magdalena"
"1472152867225","treat_bs=treat[id]","magdalena"
"1472152867231","for (k in 1","magdalena"
"s){","","magdalena"
"1472152867235","lm=lm(y_mat_bs[,k]~treat_bs)","magdalena"
"1472152867240","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472152867246","beta_bs[i,k]=lm$coefficients[2]","magdalena"
"1472152867251","","magdalena"
"1472152867258","","magdalena"
"1472152867264","t_bs[i,k]=abs((beta_bs[i,k]-beta_hyp[k])/ct[2,2])","magdalena"
"1472152867270","}","magdalena"
"1472152867275","}","magdalena"
"1472153144069","","magdalena"
"1472153144072","data=t_bs","magdalena"
"1472153144075","colnames(data)<-c(t_bs1,t_bs2,t_bs3,t_bs4,t_bs5,t_bs6,t_bs7,t_bs8,t_bs9,t_bs10)","magdalena"
"1472153144079","data = as.data.frame(data)","magdalena"
"1472153144079","library(foreign)","magdalena"
"1472153144079","write.dta(data, datav1_bs.dta)","magdalena"
"1472153144097","","magdalena"
"1472153144102","alpha=c(0.95,0.975,0.995)","magdalena"
"1472153144106","","magdalena"
"1472153144107","reject_adjust=rep(,s)","magdalena"
"1472153144107","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1472153144107","t_hat_aux=t_hat","magdalena"
"1472153144122","t_bs_aux=t_bs","magdalena"
"1472153144122","done=F","magdalena"
"1472153144122","while(done==F){","magdalena"
"1472153144122","t_max=max(t_hat_aux)","magdalena"
"1472153144138","k=which(t_hat_aux==t_max)","magdalena"
"1472153144138","if(!is.null(dim(t_bs_aux))){","magdalena"
"1472153144154","t_bs_max=t_bs_aux[,k]","magdalena"
"1472153144154","}","magdalena"
"1472153144154","if(is.null(dim(t_bs_aux))){","magdalena"
"1472153144154","t_bs_max=t_bs_aux","magdalena"
"1472153144169","}","magdalena"
"1472153144169","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472153144169","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1472153144185","k_orig=which(t_hat==t_max)","magdalena"
"1472153144185","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472153144185","t_hat_aux=t_hat_aux[-k]","magdalena"
"1472153144185","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1472153144205","print(k_orig)","magdalena"
"1472153144209","}","magdalena"
"1472153144215","if(is.null(dim(t_bs_aux))){","magdalena"
"1472153144220","t_bs_max=t_bs_aux","magdalena"
"1472153144224","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472153144230","t_max=max(t_hat_aux)","magdalena"
"1472153144235","}","magdalena"
"1472153144241","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1472153144247","if(t_max>=t_quantile){","magdalena"
"1472153144252","k_orig=which(t_hat==t_max)","magdalena"
"1472153144257","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472153144261","}","magdalena"
"1472153144266","done=T","magdalena"
"1472153144271","}","magdalena"
"1472153144276","}","magdalena"
"1472153144281","}","magdalena"
"1472153144289","reject_adjust[reject_adjust==]=No","magdalena"
"1472153144294","","magdalena"
"1472153144298","beta_hat","magdalena"
"1472153144303","","magdalena"
"1472153144306","reject_unadjust","magdalena"
"1472153144312","","magdalena"
"1472153144316","reject_adjust","magdalena"
"1472154124497","","magdalena"
"1472154124502","","magdalena"
"1472154124507","","magdalena"
"1472154124512","library(lmtest)","magdalena"
"1472154124537","library(sandwich)","magdalena"
"1472154124547","","magdalena"
"1472154124552","","magdalena"
"1472154124596","","magdalena"
"1472154124601","rm(list = ls())","magdalena"
"1472154124618","","magdalena"
"1472154124624","cat(\014)","magdalena"
"1472154124634","","magdalena"
"1472154124641","","magdalena"
"1472154124646","","magdalena"
"1472154124652","","magdalena"
"1472154124704","n = 1000","magdalena"
"1472154124715","","magdalena"
"1472154124725","s = 10","magdalena"
"1472154124751","","magdalena"
"1472154124760","beta = rep(0,s)","magdalena"
"1472154124770","","magdalena"
"1472154124777","beta[1]=1","magdalena"
"1472154124785","","magdalena"
"1472154124791","","magdalena"
"1472154124800","","magdalena"
"1472154124817","beta_hyp=rep(0,s)","magdalena"
"1472154124835","","magdalena"
"1472154124845","prob=0.2","magdalena"
"1472154124854","treat=rbinom(n,1,prob)","magdalena"
"1472154124865","","magdalena"
"1472154124885","for (i in 1","magdalena"
"s){","","magdalena"
"1472154124911","y=beta[i]*treat+rnorm(n)","magdalena"
"1472154124962","if (i==1){","magdalena"
"1472154124984","y_mat=y","magdalena"
"1472154124991","}","magdalena"
"1472154124998","if (i>1){","magdalena"
"1472154125007","y_mat=cbind(y_mat,y)","magdalena"
"1472154125014","}","magdalena"
"1472154125023","}","magdalena"
"1472154125192","","magdalena"
"1472154125198","data=cbind(y_mat,treat)","magdalena"
"1472154125205","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1472154125224","data = as.data.frame(data)","magdalena"
"1472154125245","library(foreign)","magdalena"
"1472154125280","write.dta(data, datav1.dta)","magdalena"
"1472154125349","","magdalena"
"1472154125353","","magdalena"
"1472154125358","","magdalena"
"1472154125364","","magdalena"
"1472154125371","","magdalena"
"1472154125378","","magdalena"
"1472154125403","beta_hat=rep(NA,s)","magdalena"
"1472154125409","t_hat=rep(NA,s)","magdalena"
"1472154125415","reject_unadjust=rep(,s)","magdalena"
"1472154125430","for (i in 1","magdalena"
"s){","","magdalena"
"1472154125436","lm=lm(y_mat[,i]~treat)","magdalena"
"1472154125441","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472154125449","beta_hat[i]=lm$coefficients[2]","magdalena"
"1472154125487","","magdalena"
"1472154125528","t_hat[i]=abs(ct[2,3])","magdalena"
"1472154125537","","magdalena"
"1472154125545","if(ct[2,4]>0.1){","magdalena"
"1472154125553","reject_unadjust[i]=No","magdalena"
"1472154125579","}","magdalena"
"1472154125587","","magdalena"
"1472154125593","if(ct[2,4]<=0.1){","magdalena"
"1472154125600","reject_unadjust[i]=90","magdalena"
"1472154125605","}","magdalena"
"1472154125612","","magdalena"
"1472154125618","if(ct[2,4]<0.05){","magdalena"
"1472154125624","reject_unadjust[i]=95","magdalena"
"1472154125629","}","magdalena"
"1472154125636","","magdalena"
"1472154125641","if(ct[2,4]<0.01){","magdalena"
"1472154125647","reject_unadjust[i]=99","magdalena"
"1472154125652","}","magdalena"
"1472154125680","}","magdalena"
"1472154128067","","magdalena"
"1472154128071","data=rbind(t_hat,1)","magdalena"
"1472154128076","colnames(data)<-c(t_hat1,t_hat2,t_hat3,t_hat4,t_hat5,t_hat6,t_hat7,t_hat8,t_hat9,t_hat10)","magdalena"
"1472154128087","data = as.data.frame(data)","magdalena"
"1472154128093","library(foreign)","magdalena"
"1472154128099","write.dta(data, datav1_pvalues.dta)","magdalena"
"1472154128112","","magdalena"
"1472154128118","","magdalena"
"1472154128123","B=1000","magdalena"
"1472154128130","beta_bs=matrix(NA,B,s)","magdalena"
"1472154128136","t_bs=matrix(NA,B,s)","magdalena"
"1472154128144","for (i in 1","magdalena"
"B){","","magdalena"
"1472154128150","","magdalena"
"1472154128156","","magdalena"
"1472154128163","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1472154128169","y_mat_bs=y_mat[id,]","magdalena"
"1472154128175","treat_bs=treat[id]","magdalena"
"1472154128183","for (k in 1","magdalena"
"s){","","magdalena"
"1472154128189","lm=lm(y_mat_bs[,k]~treat_bs)","magdalena"
"1472154128193","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472154128200","beta_bs[i,k]=lm$coefficients[2]","magdalena"
"1472154128212","","magdalena"
"1472154128217","","magdalena"
"1472154128222","t_bs[i,k]=abs((beta_bs[i,k]-beta_hyp[k])/ct[2,2])","magdalena"
"1472154128228","}","magdalena"
"1472154128234","}","magdalena"
"1472154723426","","magdalena"
"1472154723435","data=t_bs","magdalena"
"1472154723442","colnames(data)<-c(t_bs1,t_bs2,t_bs3,t_bs4,t_bs5,t_bs6,t_bs7,t_bs8,t_bs9,t_bs10)","magdalena"
"1472154723449","data = as.data.frame(data)","magdalena"
"1472154723456","library(foreign)","magdalena"
"1472154723464","write.dta(data, datav1_bs.dta)","magdalena"
"1472154723484","","magdalena"
"1472154723489","alpha=c(0.95,0.975,0.995)","magdalena"
"1472154723496","","magdalena"
"1472154723504","reject_adjust=rep(,s)","magdalena"
"1472154723512","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1472154723520","t_hat_aux=t_hat","magdalena"
"1472154723525","t_bs_aux=t_bs","magdalena"
"1472154723529","done=F","magdalena"
"1472154723536","while(done==F){","magdalena"
"1472154723540","t_max=max(t_hat_aux)","magdalena"
"1472154723545","k=which(t_hat_aux==t_max)","magdalena"
"1472154723551","if(!is.null(dim(t_bs_aux))){","magdalena"
"1472154723556","t_bs_max=t_bs_aux[,k]","magdalena"
"1472154723562","}","magdalena"
"1472154723567","if(is.null(dim(t_bs_aux))){","magdalena"
"1472154723571","t_bs_max=t_bs_aux","magdalena"
"1472154723576","}","magdalena"
"1472154723583","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472154723590","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1472154723595","k_orig=which(t_hat==t_max)","magdalena"
"1472154723601","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472154723606","t_hat_aux=t_hat_aux[-k]","magdalena"
"1472154723611","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1472154723616","print(k_orig)","magdalena"
"1472154723621","}","magdalena"
"1472154723628","if(is.null(dim(t_bs_aux))){","magdalena"
"1472154723635","t_bs_max=t_bs_aux","magdalena"
"1472154723640","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472154723644","t_max=max(t_hat_aux)","magdalena"
"1472154723650","}","magdalena"
"1472154723657","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1472154723661","if(t_max>=t_quantile){","magdalena"
"1472154723668","k_orig=which(t_hat==t_max)","magdalena"
"1472154723673","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472154723679","}","magdalena"
"1472154723684","done=T","magdalena"
"1472154723698","}","magdalena"
"1472154723705","}","magdalena"
"1472154723710","}","magdalena"
"1472154723726","reject_adjust[reject_adjust==]=No","magdalena"
"1472154723733","","magdalena"
"1472154723738","beta_hat","magdalena"
"1472154723749","","magdalena"
"1472154723753","reject_unadjust","magdalena"
"1472154723762","","magdalena"
"1472154723770","reject_adjust","magdalena"
"1472166451445","alpha=c(0.95,0.975,0.995)","magdalena"
"1472166451495","","magdalena"
"1472166451510","reject_adjust=rep(,s)","magdalena"
"1472166455318","a=1","magdalena"
"1472166462895","t_hat_aux=t_hat","magdalena"
"1472166462900","t_bs_aux=t_bs","magdalena"
"1472166462906","done=F","magdalena"
"1472166470119","t_hat_aux","magdalena"
"1472166477708","t_max=max(t_hat_aux)","magdalena"
"1472166477711","k=which(t_hat_aux==t_max)","magdalena"
"1472166484657","k=1","magdalena"
"1472166488618","t_max=max(t_hat_aux)","magdalena"
"1472166488618","k=which(t_hat_aux==t_max)","magdalena"
"1472166490007","k","magdalena"
"1472166492947","t_max","magdalena"
"1472166499231","!is.null(dim(t_bs_aux))","magdalena"
"1472166502992","t_bs_max=t_bs_aux[,k]","magdalena"
"1472166511868","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472166515161","t_quantile","magdalena"
"1472166587088","aux=rep(beta_hat[k], 1000)","magdalena"
"1472166629049","aux=matrix(data=beta_hat,nrow=10,ncol=1000,byrow=T)","magdalena"
"1472166640266","aux[1","magdalena"
"5,]","","magdalena"
"1472166668783","aux=matrix(data=beta_hat,nrow=1000,ncol=10,byrow=T)","magdalena"
"1472166671323","aux[1","magdalena"
"5,]","","magdalena"
"1472166682015","t_bs=t_bs-aux","magdalena"
"1472166693008","t_hat_aux=t_hat","magdalena"
"1472166693008","t_bs_aux=t_bs","magdalena"
"1472166693008","done=F","magdalena"
"1472166696247","t_max=max(t_hat_aux)","magdalena"
"1472166696247","k=which(t_hat_aux==t_max)","magdalena"
"1472166699212","t_max","magdalena"
"1472166701074","k","magdalena"
"1472166704975","t_bs_max=t_bs_aux[,k]","magdalena"
"1472166710578","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472166713916","t_quantile","magdalena"
"1472166784852","","magdalena"
"1472166784868","","magdalena"
"1472166784868","","magdalena"
"1472166784868","library(lmtest)","magdalena"
"1472166784884","library(sandwich)","magdalena"
"1472166784884","","magdalena"
"1472166784884","","magdalena"
"1472166784899","","magdalena"
"1472166784899","rm(list = ls())","magdalena"
"1472166784899","","magdalena"
"1472166784915","cat(\014)","magdalena"
"1472166784915","","magdalena"
"1472166784915","","magdalena"
"1472166784930","","magdalena"
"1472166784930","","magdalena"
"1472166784930","n = 1000","magdalena"
"1472166784930","","magdalena"
"1472166784950","s = 10","magdalena"
"1472166784953","","magdalena"
"1472166784953","beta = rep(0,s)","magdalena"
"1472166784953","","magdalena"
"1472166784968","beta[1]=1","magdalena"
"1472166784968","","magdalena"
"1472166784984","","magdalena"
"1472166784984","","magdalena"
"1472166784984","beta_hyp=rep(0,s)","magdalena"
"1472166784999","","magdalena"
"1472166784999","prob=0.2","magdalena"
"1472166784999","treat=rbinom(n,1,prob)","magdalena"
"1472166785015","","magdalena"
"1472166785015","for (i in 1","magdalena"
"s){","","magdalena"
"1472166785015","y=beta[i]*treat+rnorm(n)","magdalena"
"1472166785031","if (i==1){","magdalena"
"1472166785031","y_mat=y","magdalena"
"1472166785031","}","magdalena"
"1472166785047","if (i>1){","magdalena"
"1472166785052","y_mat=cbind(y_mat,y)","magdalena"
"1472166785052","}","magdalena"
"1472166785052","}","magdalena"
"1472166785084","","magdalena"
"1472166785084","data=cbind(y_mat,treat)","magdalena"
"1472166785099","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1472166785099","data = as.data.frame(data)","magdalena"
"1472166785115","library(foreign)","magdalena"
"1472166785115","write.dta(data, datav1.dta)","magdalena"
"1472166785131","","magdalena"
"1472166785147","","magdalena"
"1472166785151","","magdalena"
"1472166785155","","magdalena"
"1472166785161","","magdalena"
"1472166785168","","magdalena"
"1472166785176","beta_hat=rep(NA,s)","magdalena"
"1472166785182","t_hat=rep(NA,s)","magdalena"
"1472166785188","reject_unadjust=rep(,s)","magdalena"
"1472166785197","for (i in 1","magdalena"
"s){","","magdalena"
"1472166785202","lm=lm(y_mat[,i]~treat)","magdalena"
"1472166785207","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472166785211","beta_hat[i]=lm$coefficients[2]","magdalena"
"1472166785215","","magdalena"
"1472166785221","t_hat[i]=abs(ct[2,3])","magdalena"
"1472166785227","","magdalena"
"1472166785234","if(ct[2,4]>0.1){","magdalena"
"1472166785238","reject_unadjust[i]=No","magdalena"
"1472166785243","}","magdalena"
"1472166785250","","magdalena"
"1472166785256","if(ct[2,4]<=0.1){","magdalena"
"1472166785262","reject_unadjust[i]=90","magdalena"
"1472166785276","}","magdalena"
"1472166785290","","magdalena"
"1472166785297","if(ct[2,4]<0.05){","magdalena"
"1472166785301","reject_unadjust[i]=95","magdalena"
"1472166785320","}","magdalena"
"1472166785327","","magdalena"
"1472166785333","if(ct[2,4]<0.01){","magdalena"
"1472166785340","reject_unadjust[i]=99","magdalena"
"1472166785347","}","magdalena"
"1472166785354","}","magdalena"
"1472166785852","","magdalena"
"1472166785856","data=rbind(t_hat,1)","magdalena"
"1472166785861","colnames(data)<-c(t_hat1,t_hat2,t_hat3,t_hat4,t_hat5,t_hat6,t_hat7,t_hat8,t_hat9,t_hat10)","magdalena"
"1472166785866","data = as.data.frame(data)","magdalena"
"1472166785871","library(foreign)","magdalena"
"1472166785877","write.dta(data, datav1_pvalues.dta)","magdalena"
"1472166785888","","magdalena"
"1472166785893","","magdalena"
"1472166785897","B=1000","magdalena"
"1472166785903","beta_bs=matrix(NA,B,s)","magdalena"
"1472166785908","t_bs=matrix(NA,B,s)","magdalena"
"1472166785914","for (i in 1","magdalena"
"B){","","magdalena"
"1472166785919","","magdalena"
"1472166785923","","magdalena"
"1472166785928","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1472166785933","y_mat_bs=y_mat[id,]","magdalena"
"1472166785938","treat_bs=treat[id]","magdalena"
"1472166785943","for (k in 1","magdalena"
"s){","","magdalena"
"1472166785949","lm=lm(y_mat_bs[,k]~treat_bs)","magdalena"
"1472166785955","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1472166785962","beta_bs[i,k]=lm$coefficients[2]","magdalena"
"1472166785967","","magdalena"
"1472166785972","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/ct[2,2])","magdalena"
"1472166785977","","magdalena"
"1472166785981","}","magdalena"
"1472166785986","}","magdalena"
"1472167110814","","magdalena"
"1472167110822","data=t_bs","magdalena"
"1472167110827","colnames(data)<-c(t_bs1,t_bs2,t_bs3,t_bs4,t_bs5,t_bs6,t_bs7,t_bs8,t_bs9,t_bs10)","magdalena"
"1472167110836","data = as.data.frame(data)","magdalena"
"1472167110844","library(foreign)","magdalena"
"1472167110853","write.dta(data, datav1_bs.dta)","magdalena"
"1472167110887","","magdalena"
"1472167110893","alpha=c(0.95,0.975,0.995)","magdalena"
"1472167110899","","magdalena"
"1472167110907","reject_adjust=rep(,s)","magdalena"
"1472167250759","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1472167250765","t_hat_aux=t_hat","magdalena"
"1472167250771","t_bs_aux=t_bs","magdalena"
"1472167250774","done=F","magdalena"
"1472167250778","while(done==F){","magdalena"
"1472167250782","t_max=max(t_hat_aux)","magdalena"
"1472167250787","k=which(t_hat_aux==t_max)","magdalena"
"1472167250792","if(!is.null(dim(t_bs_aux))){","magdalena"
"1472167250800","t_bs_max=t_bs_aux[,k]","magdalena"
"1472167250808","}","magdalena"
"1472167250815","if(is.null(dim(t_bs_aux))){","magdalena"
"1472167250820","t_bs_max=t_bs_aux","magdalena"
"1472167250827","}","magdalena"
"1472167250835","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472167250842","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1472167250847","k_orig=which(t_hat==t_max)","magdalena"
"1472167250852","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472167250857","t_hat_aux=t_hat_aux[-k]","magdalena"
"1472167250867","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1472167250875","print(k_orig)","magdalena"
"1472167250880","}","magdalena"
"1472167250886","if(is.null(dim(t_bs_aux))){","magdalena"
"1472167250890","t_bs_max=t_bs_aux","magdalena"
"1472167250894","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472167250897","t_max=max(t_hat_aux)","magdalena"
"1472167250907","}","magdalena"
"1472167250916","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1472167250922","if(t_max>=t_quantile){","magdalena"
"1472167250927","k_orig=which(t_hat==t_max)","magdalena"
"1472167250937","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472167250947","}","magdalena"
"1472167250952","done=T","magdalena"
"1472167250957","}","magdalena"
"1472167250961","}","magdalena"
"1472167250966","}","magdalena"
"1472167250990","reject_adjust[reject_adjust==]=No","magdalena"
"1472167251003","","magdalena"
"1472167251009","beta_hat","magdalena"
"1472167251015","","magdalena"
"1472167251018","reject_unadjust","magdalena"
"1472167251034","","magdalena"
"1472167251038","reject_adjust","magdalena"
"1472167280665","alpha=c(0.95,0.975,0.995)","magdalena"
"1472167280670","","magdalena"
"1472167280674","reject_adjust=rep(,s)","magdalena"
"1472167283026","a=1","magdalena"
"1472167286885","t_hat_aux=t_hat","magdalena"
"1472167286889","t_bs_aux=t_bs","magdalena"
"1472167286893","done=F","magdalena"
"1472167293138","t_max=max(t_hat_aux)","magdalena"
"1472167293142","k=which(t_hat_aux==t_max)","magdalena"
"1472167299763","t_hat_aux","magdalena"
"1472167304660","t_max","magdalena"
"1472167306777","k","magdalena"
"1472167311452","t_bs_max=t_bs_aux[,k]","magdalena"
"1472167317218","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472167333215","t_quantile","magdalena"
"1472167341041","t_max>=t_quantile & !is.null(dim(t_bs_aux))","magdalena"
"1472167348889","k_orig=which(t_hat==t_max)","magdalena"
"1472167353182","k_orig","magdalena"
"1472167359052","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1472167363105","reject_adjust","magdalena"
"1472167371042","t_hat_aux=t_hat_aux[-k]","magdalena"
"1472167371046","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1472167371050","print(k_orig)","magdalena"
"1472167391637","t_max=max(t_hat_aux)","magdalena"
"1472167391642","k=which(t_hat_aux==t_max)","magdalena"
"1472167394232","t_max","magdalena"
"1472167397432","k","magdalena"
"1472167405427","!is.null(dim(t_bs_aux))","magdalena"
"1472167409763","t_bs_max=t_bs_aux[,k]","magdalena"
"1472167416545","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1472167420930","t_quantile","magdalena"
"1473427696279","?lm","magdalena"
"1473428561981","xnam <- paste(x, 1","magdalena"
"25, sep=)","","magdalena"
"1473428563730","xnam","magdalena"
"1473429365549","x_1=c(x1,x2)","magdalena"
"1473429365555","x_2=c(x1)","magdalena"
"1473429365562","x_3=c(x2)","magdalena"
"1473429374865","rbind(x_1,x_2,x_3)","magdalena"
"1473429596623","","magdalena"
"1473429596623","k=2","magdalena"
"1473429596623","","magdalena"
"1473429596638","","magdalena"
"1473429596638","x_1=c(x1,x2)","magdalena"
"1473429596638","X=matrix(x_1,ncol=k,nrow=s)","magdalena"
"1473429606691","","magdalena"
"1473429606696","","magdalena"
"1473429606700","","magdalena"
"1473429606705","library(lmtest)","magdalena"
"1473429607363","library(sandwich)","magdalena"
"1473429607495","","magdalena"
"1473429607499","","magdalena"
"1473429607507","","magdalena"
"1473429607513","rm(list = ls())","magdalena"
"1473429607522","","magdalena"
"1473429607529","cat(\014)","magdalena"
"1473429607538","","magdalena"
"1473429607545","","magdalena"
"1473429607550","","magdalena"
"1473429607558","","magdalena"
"1473429607563","n = 1000","magdalena"
"1473429607570","","magdalena"
"1473429607575","s = 10","magdalena"
"1473429607582","","magdalena"
"1473429607587","beta = rep(0,s)","magdalena"
"1473429607593","","magdalena"
"1473429607597","beta[1]=1","magdalena"
"1473429607602","","magdalena"
"1473429607607","","magdalena"
"1473429607612","","magdalena"
"1473429607617","beta_hyp=rep(0,s)","magdalena"
"1473429607623","","magdalena"
"1473429607628","prob=0.5","magdalena"
"1473429607633","treat=rbinom(n,1,prob)","magdalena"
"1473429607642","","magdalena"
"1473429607646","x1=0.5+rnorm(n)","magdalena"
"1473429607653","x2=0.8+rnorm(n)","magdalena"
"1473429607660","","magdalena"
"1473429607666","for (i in 1","magdalena"
"s){","","magdalena"
"1473429607670","y=beta[i]*treat+x1+x2+rnorm(n)","magdalena"
"1473429607677","if (i==1){","magdalena"
"1473429607682","y_mat=y","magdalena"
"1473429607687","}","magdalena"
"1473429607692","if (i>1){","magdalena"
"1473429607697","y_mat=cbind(y_mat,y)","magdalena"
"1473429607702","}","magdalena"
"1473429607706","}","magdalena"
"1473429607722","","magdalena"
"1473429607727","data=cbind(y_mat,treat)","magdalena"
"1473429607733","colnames(data)<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1473429607741","data = as.data.frame(data)","magdalena"
"1473429607750","covariates=cbind(x1,x2)","magdalena"
"1473429607759","colnames(covariates)<-c(x1,x2)","magdalena"
"1473429607766","covariates = as.data.frame(covariates)","magdalena"
"1473429607773","library(foreign)","magdalena"
"1473429607915","write.dta(data, datav1.dta)","magdalena"
"1473429607934","","magdalena"
"1473429607939","","magdalena"
"1473429607944","","magdalena"
"1473429607949","","magdalena"
"1473429607953","","magdalena"
"1473429607960","","magdalena"
"1473429607966","","magdalena"
"1473429607971","k=2","magdalena"
"1473429607977","","magdalena"
"1473429607983","","magdalena"
"1473429607989","x_1=c(x1,x2)","magdalena"
"1473429607997","X=matrix(x_1,ncol=k,nrow=s)","magdalena"
"1473429615969","X","magdalena"
"1473429637059","X=matrix(t(x_1),ncol=k,nrow=s)","magdalena"
"1473429638861","X","magdalena"
"1473429691604","","magdalena"
"1473429691608","x_1=c(x1,x2)","magdalena"
"1473429691614","X=matrix(x_1,ncol=k,nrow=s)","magdalena"
"1473429693890","X","magdalena"
"1473429775657","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473429777661","X","magdalena"
"1473430041705","help(list)","magdalena"
"1473430099164","list_x<-list(x_2,x_3,x_5)","magdalena"
"1473430198988","list_x<-list(c(x_2),c(x_3),c(x_5)","magdalena"
"1473430200485",")","magdalena"
"1473430357876","l <- list(c(1,2,3), c(4,5,6))","magdalena"
"1473430383618","a=c(1,2,3)","magdalena"
"1473430391327","b=c(4,5,6)","magdalena"
"1473430395973","l=list(a,b)","magdalena"
"1473430397505","l","magdalena"
"1473430407539","b=c(4,5)","magdalena"
"1473430415142","l=list(a,b)","magdalena"
"1473430416397","l","magdalena"
"1473430489385","","magdalena"
"1473430489385","x_2=x2","magdalena"
"1473430489385","x_3=x_2","magdalena"
"1473430489385","x_5=I(x1^2)","magdalena"
"1473430489402","x_10=c(x2,x1)","magdalena"
"1473430489405","l<-list(x_2,x_3,x_5,x_10)","magdalena"
"1473430533772","l","magdalena"
"1473430582530","","magdalena"
"1473430582530","x_2=x2","magdalena"
"1473430582530","x_3=x_2","magdalena"
"1473430582546","x_5=I(x1^2)","magdalena"
"1473430582546","x_10=c(x2,x1)","magdalena"
"1473430582546","l<-list(x_2,x_3,x_5,x_10)","magdalena"
"1473430582566","diff=c(2,3,5,10)","magdalena"
"1473430582573","from (i in 1","magdalena"
"length(diff)){","","magdalena"
"1473430582578","aux=l[[i]]","magdalena"
"1473430582584","X[diff[i],]=NA","magdalena"
"1473430582589","X[diff[i],1","magdalena"
"length(aux)]=l[[i]]","","magdalena"
"1473430582595","}","magdalena"
"1473430634406","","magdalena"
"1473430634411","x_2=x2","magdalena"
"1473430634416","x_3=x_2","magdalena"
"1473430634421","x_5=I(x1^2)","magdalena"
"1473430634425","x_10=c(x2,x1)","magdalena"
"1473430634431","l<-list(x_2,x_3,x_5,x_10)","magdalena"
"1473430634438","diff=c(2,3,5,10)","magdalena"
"1473430634444","for (i in 1","magdalena"
"length(diff)){","","magdalena"
"1473430634449","aux=l[[i]]","magdalena"
"1473430634454","X[diff[i],]=NA","magdalena"
"1473430634458","X[diff[i],1","magdalena"
"length(aux)]=l[[i]]","","magdalena"
"1473430634462","}","magdalena"
"1473430639822","X","magdalena"
"1473431315532","s=ncol(y_mat)","magdalena"
"1473431317235","s","magdalena"
"1473431320424","i=1","magdalena"
"1473431326324","beta_hat=rep(NA,s)","magdalena"
"1473431326330","t_hat=rep(NA,s)","magdalena"
"1473431326334","reject_unadjust=rep(,s)","magdalena"
"1473431335580","covariates","magdalena"
"1473431347318","c(X[,i])","magdalena"
"1473431386200","","magdalena"
"1473431386205","","magdalena"
"1473431386209","","magdalena"
"1473431386215","library(lmtest)","magdalena"
"1473431386223","library(sandwich)","magdalena"
"1473431386230","","magdalena"
"1473431386234","","magdalena"
"1473431386240","","magdalena"
"1473431386245","rm(list = ls())","magdalena"
"1473431386253","","magdalena"
"1473431386257","cat(\014)","magdalena"
"1473431386265","","magdalena"
"1473431386271","","magdalena"
"1473431386276","","magdalena"
"1473431386281","","magdalena"
"1473431386284","n = 1000","magdalena"
"1473431386289","","magdalena"
"1473431386294","s = 10","magdalena"
"1473431386300","","magdalena"
"1473431386305","beta = rep(0,s)","magdalena"
"1473431386310","","magdalena"
"1473431386314","beta[1]=1","magdalena"
"1473431386320","","magdalena"
"1473431386326","","magdalena"
"1473431386332","","magdalena"
"1473431386337","beta_hyp=rep(0,s)","magdalena"
"1473431386344","","magdalena"
"1473431386349","prob=0.5","magdalena"
"1473431386354","treat=rbinom(n,1,prob)","magdalena"
"1473431386361","","magdalena"
"1473431386366","x1=0.5+rnorm(n)","magdalena"
"1473431386370","x2=0.8+rnorm(n)","magdalena"
"1473431386376","","magdalena"
"1473431386380","for (i in 1","magdalena"
"s){","","magdalena"
"1473431386385","y=beta[i]*treat+x1+x2+rnorm(n)","magdalena"
"1473431386390","if (i==1){","magdalena"
"1473431386395","y_mat=y","magdalena"
"1473431386399","}","magdalena"
"1473431386403","if (i>1){","magdalena"
"1473431386407","y_mat=cbind(y_mat,y)","magdalena"
"1473431386412","}","magdalena"
"1473431386417","}","magdalena"
"1473431386430","","magdalena"
"1473431386434","data=cbind(y_mat,treat)","magdalena"
"1473431386440","names_data<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1473431386446","colnames(data)<-names_data","magdalena"
"1473431386451","data = as.data.frame(data)","magdalena"
"1473431386459","covariates=cbind(x1,x2)","magdalena"
"1473431386464","colnames(covariates)<-c(x1,x2)","magdalena"
"1473431386469","covariates = as.data.frame(covariates)","magdalena"
"1473431386475","library(foreign)","magdalena"
"1473431386481","write.dta(data, datav1.dta)","magdalena"
"1473431386495","","magdalena"
"1473431386500","","magdalena"
"1473431386504","","magdalena"
"1473431386509","","magdalena"
"1473431386513","","magdalena"
"1473431386519","","magdalena"
"1473431386525","","magdalena"
"1473431386530","k=2","magdalena"
"1473431386536","","magdalena"
"1473431386541","","magdalena"
"1473431386546","x_1=c(x1,x2)","magdalena"
"1473431386551","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473431386557","","magdalena"
"1473431386561","x_2=x2","magdalena"
"1473431386566","x_3=x_2","magdalena"
"1473431386570","x_10=c(x2,x1)","magdalena"
"1473431386576","l<-list(x_2,x_3,x_10)","magdalena"
"1473431386581","diff=c(2,3,10)","magdalena"
"1473431386587","for (i in 1","magdalena"
"length(diff)){","","magdalena"
"1473431386591","aux=l[[i]]","magdalena"
"1473431386595","X[diff[i],]=NA","magdalena"
"1473431386600","X[diff[i],1","magdalena"
"length(aux)]=l[[i]]","","magdalena"
"1473431386605","}","magdalena"
"1473431400389","s=ncol(y_mat)","magdalena"
"1473431400396","","magdalena"
"1473431400401","beta_hat=rep(NA,s)","magdalena"
"1473431400407","t_hat=rep(NA,s)","magdalena"
"1473431400412","reject_unadjust=rep(,s)","magdalena"
"1473431402857","i=1","magdalena"
"1473431408707","c(X[i,]","magdalena"
"1473431412679",")","magdalena"
"1473431423263","i=2","magdalena"
"1473431425551","covariates_aux=covariates[,c(X[i,])]","magdalena"
"1473431433575","c(X[i,])","magdalena"
"1473431452771","c(!is.na(X[i,]))","magdalena"
"1473431494997","c((X[i,!is.na(X[i,])])","magdalena"
"1473431498544",")","magdalena"
"1473431513344","c(X[i,!is.na(X[i,])])","magdalena"
"1473431518469","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473431553279","data_aux=as.data.frame(y_mat[,i],treat,covariates_aux)","magdalena"
"1473431565534","names(data_aux)","magdalena"
"1473431845282","","magdalena"
"1473431845286","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473431845291","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473431869252","names(data_aux[,1","magdalena"
"(s+1)])<-names_data","","magdalena"
"1473431974206","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473431974212","names(data_aux[,1","magdalena"
"2])<-paste(names_data[i],treat,sep= )","","magdalena"
"1473432003787","names(data_aux[,1","magdalena"
"2])<-c(names_data[i],treat)","","magdalena"
"1473432009290","names(data_aux)","magdalena"
"1473432033917","names(data_aux)<-c(names_data[i],treat,X[i,])","magdalena"
"1473432041293","X[i,]","magdalena"
"1473432054976","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473432059543","names(data_aux)","magdalena"
"1473432127694","","magdalena"
"1473432127696","lm=lm(data_aux)","magdalena"
"1473432130120","lm","magdalena"
"1473432149091","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473432149178","beta_hat[i]=lm$coefficients[2]","magdalena"
"1473432810744","help(function)","magdalena"
"1473432817513","?function","magdalena"
"1473432821240",")","magdalena"
"1473432966523","","magdalena"
"1473432966528","","magdalena"
"1473432966532","","magdalena"
"1473432966536","library(lmtest)","magdalena"
"1473432966543","library(sandwich)","magdalena"
"1473432966551","","magdalena"
"1473432966556","","magdalena"
"1473432966562","","magdalena"
"1473432966566","rm(list = ls())","magdalena"
"1473432966574","","magdalena"
"1473432966578","cat(\014)","magdalena"
"1473432966586","","magdalena"
"1473432966592","","magdalena"
"1473432966597","","magdalena"
"1473432966603","","magdalena"
"1473432966608","n = 1000","magdalena"
"1473432966615","","magdalena"
"1473432966619","s = 10","magdalena"
"1473432966626","","magdalena"
"1473432966630","beta = rep(0,s)","magdalena"
"1473432966634","","magdalena"
"1473432966638","beta[1]=1","magdalena"
"1473432966642","","magdalena"
"1473432966646","","magdalena"
"1473432966651","","magdalena"
"1473432966656","beta_hyp=rep(0,s)","magdalena"
"1473432966662","","magdalena"
"1473432966666","prob=0.5","magdalena"
"1473432966672","treat=rbinom(n,1,prob)","magdalena"
"1473432966680","","magdalena"
"1473432966684","x1=0.5+rnorm(n)","magdalena"
"1473432966689","x2=0.8+rnorm(n)","magdalena"
"1473432966694","","magdalena"
"1473432966699","for (i in 1","magdalena"
"s){","","magdalena"
"1473432966704","y=beta[i]*treat+x1+x2+rnorm(n)","magdalena"
"1473432966709","if (i==1){","magdalena"
"1473432966714","y_mat=y","magdalena"
"1473432966718","}","magdalena"
"1473432966721","if (i>1){","magdalena"
"1473432966725","y_mat=cbind(y_mat,y)","magdalena"
"1473432966729","}","magdalena"
"1473432966732","}","magdalena"
"1473432966743","","magdalena"
"1473432966747","data=cbind(y_mat,treat)","magdalena"
"1473432966752","names_data<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1473432966757","colnames(data)<-names_data","magdalena"
"1473432966762","data = as.data.frame(data)","magdalena"
"1473432966770","covariates=cbind(x1,x2)","magdalena"
"1473432966775","colnames(covariates)<-c(x1,x2)","magdalena"
"1473432966779","covariates = as.data.frame(covariates)","magdalena"
"1473432966785","library(foreign)","magdalena"
"1473432966790","write.dta(data, datav1.dta)","magdalena"
"1473432966805","","magdalena"
"1473432966810","","magdalena"
"1473432966814","","magdalena"
"1473432966819","","magdalena"
"1473432966824","","magdalena"
"1473432966831","","magdalena"
"1473432966836","","magdalena"
"1473432966841","k=2","magdalena"
"1473432966847","","magdalena"
"1473432966856","","magdalena"
"1473432966861","x_1=c(x1,x2)","magdalena"
"1473432966867","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473432966874","","magdalena"
"1473432966879","x_2=x2","magdalena"
"1473432966884","x_3=x_2","magdalena"
"1473432966890","x_10=c(x2,x1)","magdalena"
"1473432966896","l<-list(x_2,x_3,x_10)","magdalena"
"1473432966904","diff=c(2,3,10)","magdalena"
"1473432966911","for (i in 1","magdalena"
"length(diff)){","","magdalena"
"1473432966916","aux=l[[i]]","magdalena"
"1473432966920","X[diff[i],]=NA","magdalena"
"1473432966926","X[diff[i],1","magdalena"
"length(aux)]=l[[i]]","","magdalena"
"1473432966932","}","magdalena"
"1473432966943","MHT_rw2005=function(y_mat,treat,X,covariates,B=1000,robust=yes,names=names_data){","magdalena"
"1473432966952","s=ncol(y_mat)","magdalena"
"1473432966958","","magdalena"
"1473432966968","beta_hat=rep(NA,s)","magdalena"
"1473432966975","t_hat=rep(NA,s)","magdalena"
"1473432966984","reject_unadjust=rep(,s)","magdalena"
"1473432966991","for (i in 1","magdalena"
"s){","","magdalena"
"1473432966999","","magdalena"
"1473432967008","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473432967021","","magdalena"
"1473432967028","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473432967033","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473432967040","","magdalena"
"1473432967045","lm=lm(data_aux)","magdalena"
"1473432967052","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473432967057","beta_hat[i]=lm$coefficients[2]","magdalena"
"1473432967064","","magdalena"
"1473432967069","if(robust==no){","magdalena"
"1473432967075","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1473432967083","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1473432967088","reject_unadjust[i]=No","magdalena"
"1473432967094","}","magdalena"
"1473432967101","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1473432967106","reject_unadjust[i]=90","magdalena"
"1473432967112","}","magdalena"
"1473432967119","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1473432967125","reject_unadjust[i]=95","magdalena"
"1473432967132","}","magdalena"
"1473432967140","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1473432967145","reject_unadjust[i]=99","magdalena"
"1473432967150","}","magdalena"
"1473432967157","","magdalena"
"1473432967162","if(robust==yes){","magdalena"
"1473432967168","t_hat[i]=abs(ct[2,3])","magdalena"
"1473432967175","if(ct[2,4]>0.1){","magdalena"
"1473432967180","reject_unadjust[i]=No","magdalena"
"1473432967185","}","magdalena"
"1473432967191","if(ct[2,4]<=0.1){","magdalena"
"1473432967199","reject_unadjust[i]=90","magdalena"
"1473432967204","}","magdalena"
"1473432967212","if(ct[2,4]<0.05){","magdalena"
"1473432967217","reject_unadjust[i]=95","magdalena"
"1473432967223","}","magdalena"
"1473432967231","if(ct[2,4]<0.01){","magdalena"
"1473432967237","reject_unadjust[i]=99","magdalena"
"1473432967243","}","magdalena"
"1473432967249","}","magdalena"
"1473432967254","}","magdalena"
"1473432967262","","magdalena"
"1473432967270","","magdalena"
"1473432967275","beta_bs=matrix(NA,B,s)","magdalena"
"1473432967282","t_bs=matrix(NA,B,s)","magdalena"
"1473432967290","for (i in 1","magdalena"
"B){","","magdalena"
"1473432967296","","magdalena"
"1473432967302","","magdalena"
"1473432967310","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1473432967319","y_mat_bs=y_mat[id,]","magdalena"
"1473432967325","treat_bs=treat[id]","magdalena"
"1473432967333","for (k in 1","magdalena"
"s){","","magdalena"
"1473432967338","lm=lm(y_mat_bs[,k]~treat_bs)","magdalena"
"1473432967344","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473432967351","beta_bs[i,k]=lm$coefficients[2]","magdalena"
"1473432967357","","magdalena"
"1473432967361","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/ct[2,2])","magdalena"
"1473432967367","","magdalena"
"1473432967373","}","magdalena"
"1473432967378","}","magdalena"
"1473432967384","","magdalena"
"1473432967392","alpha=c(0.95,0.975,0.995)","magdalena"
"1473432967398","","magdalena"
"1473432967405","reject_adjust=rep(,s)","magdalena"
"1473432967413","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1473432967422","t_hat_aux=t_hat","magdalena"
"1473432967427","t_bs_aux=t_bs","magdalena"
"1473432967432","done=F","magdalena"
"1473432967441","while(done==F){","magdalena"
"1473432967447","t_max=max(t_hat_aux)","magdalena"
"1473432967458","k=which(t_hat_aux==t_max)","magdalena"
"1473432967465","if(!is.null(dim(t_bs_aux))){","magdalena"
"1473432967470","t_bs_max=t_bs_aux[,k]","magdalena"
"1473432967474","}","magdalena"
"1473432967479","if(is.null(dim(t_bs_aux))){","magdalena"
"1473432967484","t_bs_max=t_bs_aux","magdalena"
"1473432967489","}","magdalena"
"1473432967498","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1473432967507","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1473432967513","k_orig=which(t_hat==t_max)","magdalena"
"1473432967521","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1473432967528","t_hat_aux=t_hat_aux[-k]","magdalena"
"1473432967536","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1473432967542","print(k_orig)","magdalena"
"1473432967548","}","magdalena"
"1473432967558","if(is.null(dim(t_bs_aux))){","magdalena"
"1473432967564","t_bs_max=t_bs_aux","magdalena"
"1473432967570","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1473432967578","t_max=max(t_hat_aux)","magdalena"
"1473432967586","}","magdalena"
"1473432967601","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1473432967610","if(t_max>=t_quantile){","magdalena"
"1473432967618","k_orig=which(t_hat==t_max)","magdalena"
"1473432967627","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1473432967633","}","magdalena"
"1473432967641","done=T","magdalena"
"1473432967648","}","magdalena"
"1473432967654","}","magdalena"
"1473432967662","}","magdalena"
"1473432967673","reject_adjust[reject_adjust==]=No","magdalena"
"1473432967684","","magdalena"
"1473432967691","","magdalena"
"1473432967701","return(list(beta_hat,reject_unadjust,reject_adjust))","magdalena"
"1473432967710","}","magdalena"
"1473432980757","}","magdalena"
"1473433110988","","magdalena"
"1473433110992","","magdalena"
"1473433110997","","magdalena"
"1473433111003","library(lmtest)","magdalena"
"1473433111009","library(sandwich)","magdalena"
"1473433111016","","magdalena"
"1473433111021","","magdalena"
"1473433111026","","magdalena"
"1473433111031","rm(list = ls())","magdalena"
"1473433111037","","magdalena"
"1473433111042","cat(\014)","magdalena"
"1473433111050","","magdalena"
"1473433111057","","magdalena"
"1473433111061","","magdalena"
"1473433111067","","magdalena"
"1473433111071","n = 1000","magdalena"
"1473433111077","","magdalena"
"1473433111082","s = 10","magdalena"
"1473433111090","","magdalena"
"1473433111095","beta = rep(0,s)","magdalena"
"1473433111101","","magdalena"
"1473433111109","beta[1]=1","magdalena"
"1473433111115","","magdalena"
"1473433111120","","magdalena"
"1473433111126","","magdalena"
"1473433111131","beta_hyp=rep(0,s)","magdalena"
"1473433111138","","magdalena"
"1473433111143","prob=0.5","magdalena"
"1473433111148","treat=rbinom(n,1,prob)","magdalena"
"1473433111156","","magdalena"
"1473433111161","x1=0.5+rnorm(n)","magdalena"
"1473433111167","x2=0.8+rnorm(n)","magdalena"
"1473433111175","","magdalena"
"1473433111181","for (i in 1","magdalena"
"s){","","magdalena"
"1473433111186","y=beta[i]*treat+x1+x2+rnorm(n)","magdalena"
"1473433111192","if (i==1){","magdalena"
"1473433111197","y_mat=y","magdalena"
"1473433111202","}","magdalena"
"1473433111206","if (i>1){","magdalena"
"1473433111213","y_mat=cbind(y_mat,y)","magdalena"
"1473433111218","}","magdalena"
"1473433111224","}","magdalena"
"1473433111249","","magdalena"
"1473433111255","data=cbind(y_mat,treat)","magdalena"
"1473433111260","names_data<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1473433111265","colnames(data)<-names_data","magdalena"
"1473433111273","data = as.data.frame(data)","magdalena"
"1473433111281","covariates=cbind(x1,x2)","magdalena"
"1473433111286","colnames(covariates)<-c(x1,x2)","magdalena"
"1473433111292","covariates = as.data.frame(covariates)","magdalena"
"1473433111300","library(foreign)","magdalena"
"1473433111308","write.dta(data, datav1.dta)","magdalena"
"1473433111326","","magdalena"
"1473433111332","","magdalena"
"1473433111336","","magdalena"
"1473433111341","","magdalena"
"1473433111352","","magdalena"
"1473433111358","","magdalena"
"1473433111367","","magdalena"
"1473433111371","k=2","magdalena"
"1473433111377","","magdalena"
"1473433111383","","magdalena"
"1473433111388","x_1=c(x1,x2)","magdalena"
"1473433111394","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473433111401","","magdalena"
"1473433111405","x_2=x2","magdalena"
"1473433111411","x_3=x_2","magdalena"
"1473433111416","x_10=c(x2,x1)","magdalena"
"1473433111423","l<-list(x_2,x_3,x_10)","magdalena"
"1473433111431","diff=c(2,3,10)","magdalena"
"1473433111437","for (i in 1","magdalena"
"length(diff)){","","magdalena"
"1473433111442","aux=l[[i]]","magdalena"
"1473433111451","X[diff[i],]=NA","magdalena"
"1473433111456","X[diff[i],1","magdalena"
"length(aux)]=l[[i]]","","magdalena"
"1473433111462","}","magdalena"
"1473433111470","MHT_rw2005=function(y_mat,treat,X,covariates,B=1000,robust=yes,names=names_data){","magdalena"
"1473433111477","s=ncol(y_mat)","magdalena"
"1473433111484","","magdalena"
"1473433111490","beta_hat=rep(NA,s)","magdalena"
"1473433111496","t_hat=rep(NA,s)","magdalena"
"1473433111501","reject_unadjust=rep(,s)","magdalena"
"1473433111507","for (i in 1","magdalena"
"s){","","magdalena"
"1473433111516","","magdalena"
"1473433111523","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473433111529","","magdalena"
"1473433111534","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473433111539","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473433111545","","magdalena"
"1473433111550","lm=lm(data_aux)","magdalena"
"1473433111557","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473433111561","beta_hat[i]=lm$coefficients[2]","magdalena"
"1473433111566","","magdalena"
"1473433111570","if(robust==no){","magdalena"
"1473433111574","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1473433111580","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1473433111585","reject_unadjust[i]=No","magdalena"
"1473433111589","}","magdalena"
"1473433111595","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1473433111600","reject_unadjust[i]=90","magdalena"
"1473433111605","}","magdalena"
"1473433111612","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1473433111616","reject_unadjust[i]=95","magdalena"
"1473433111620","}","magdalena"
"1473433111626","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1473433111631","reject_unadjust[i]=99","magdalena"
"1473433111636","}","magdalena"
"1473433111642","}","magdalena"
"1473433111649","","magdalena"
"1473433111655","if(robust==yes){","magdalena"
"1473433111660","t_hat[i]=abs(ct[2,3])","magdalena"
"1473433111666","if(ct[2,4]>0.1){","magdalena"
"1473433111671","reject_unadjust[i]=No","magdalena"
"1473433111676","}","magdalena"
"1473433111685","if(ct[2,4]<=0.1){","magdalena"
"1473433111690","reject_unadjust[i]=90","magdalena"
"1473433111697","}","magdalena"
"1473433111705","if(ct[2,4]<0.05){","magdalena"
"1473433111711","reject_unadjust[i]=95","magdalena"
"1473433111717","}","magdalena"
"1473433111726","if(ct[2,4]<0.01){","magdalena"
"1473433111733","reject_unadjust[i]=99","magdalena"
"1473433111738","}","magdalena"
"1473433111744","}","magdalena"
"1473433111749","}","magdalena"
"1473433111756","","magdalena"
"1473433111769","","magdalena"
"1473433111779","beta_bs=matrix(NA,B,s)","magdalena"
"1473433111787","t_bs=matrix(NA,B,s)","magdalena"
"1473433111795","for (i in 1","magdalena"
"B){","","magdalena"
"1473433111801","","magdalena"
"1473433111808","","magdalena"
"1473433111816","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1473433111824","y_mat_bs=y_mat[id,]","magdalena"
"1473433111830","treat_bs=treat[id]","magdalena"
"1473433111838","for (k in 1","magdalena"
"s){","","magdalena"
"1473433111843","lm=lm(y_mat_bs[,k]~treat_bs)","magdalena"
"1473433111848","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473433111854","beta_bs[i,k]=lm$coefficients[2]","magdalena"
"1473433111860","","magdalena"
"1473433111866","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/ct[2,2])","magdalena"
"1473433111872","","magdalena"
"1473433111878","}","magdalena"
"1473433111883","}","magdalena"
"1473433111891","","magdalena"
"1473433111900","alpha=c(0.95,0.975,0.995)","magdalena"
"1473433111907","","magdalena"
"1473433111913","reject_adjust=rep(,s)","magdalena"
"1473433111921","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1473433111928","t_hat_aux=t_hat","magdalena"
"1473433111934","t_bs_aux=t_bs","magdalena"
"1473433111940","done=F","magdalena"
"1473433111949","while(done==F){","magdalena"
"1473433111955","t_max=max(t_hat_aux)","magdalena"
"1473433111961","k=which(t_hat_aux==t_max)","magdalena"
"1473433111970","if(!is.null(dim(t_bs_aux))){","magdalena"
"1473433111976","t_bs_max=t_bs_aux[,k]","magdalena"
"1473433111982","}","magdalena"
"1473433111988","if(is.null(dim(t_bs_aux))){","magdalena"
"1473433111994","t_bs_max=t_bs_aux","magdalena"
"1473433112000","}","magdalena"
"1473433112006","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1473433112014","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1473433112019","k_orig=which(t_hat==t_max)","magdalena"
"1473433112023","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1473433112028","t_hat_aux=t_hat_aux[-k]","magdalena"
"1473433112033","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1473433112039","print(k_orig)","magdalena"
"1473433112043","}","magdalena"
"1473433112052","if(is.null(dim(t_bs_aux))){","magdalena"
"1473433112058","t_bs_max=t_bs_aux","magdalena"
"1473433112063","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1473433112069","t_max=max(t_hat_aux)","magdalena"
"1473433112075","}","magdalena"
"1473433112085","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1473433112092","if(t_max>=t_quantile){","magdalena"
"1473433112099","k_orig=which(t_hat==t_max)","magdalena"
"1473433112107","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1473433112115","}","magdalena"
"1473433112133","done=T","magdalena"
"1473433112140","}","magdalena"
"1473433112147","}","magdalena"
"1473433112153","}","magdalena"
"1473433112165","reject_adjust[reject_adjust==]=No","magdalena"
"1473433112176","","magdalena"
"1473433112183","","magdalena"
"1473433112193","return(list(beta_hat,reject_unadjust,reject_adjust))","magdalena"
"1473433112207","}","magdalena"
"1473433112219","MHT=MHT_rw2005(y_mat=y_mat,treat=treat,X=X,covariates=covariates,B=1000,robust=yes,names=names_data)","magdalena"
"1473433500881","MHT","magdalena"
"1473433524743","MHT=MHT_rw2005(y_mat=y_mat,treat=treat,X=X,covariates=covariates,B=1000,robust=no,names=names_data)","magdalena"
"1473433917415","MHT","magdalena"
"1473433981657","","magdalena"
"1473433981657","","magdalena"
"1473433981657","","magdalena"
"1473433981657","library(lmtest)","magdalena"
"1473433981673","library(sandwich)","magdalena"
"1473433981673","","magdalena"
"1473433981673","","magdalena"
"1473433981688","","magdalena"
"1473433981688","rm(list = ls())","magdalena"
"1473433981705","","magdalena"
"1473433981705","cat(\014)","magdalena"
"1473433981705","","magdalena"
"1473433981705","","magdalena"
"1473433981721","","magdalena"
"1473433981721","","magdalena"
"1473433981721","n = 1000","magdalena"
"1473433981736","","magdalena"
"1473433981736","s = 10","magdalena"
"1473433981752","","magdalena"
"1473433981752","beta = rep(0,s)","magdalena"
"1473433981752","beta[1]=1","magdalena"
"1473433981768","","magdalena"
"1473433981768","prob=0.7","magdalena"
"1473433981768","treat=rbinom(n,1,prob)","magdalena"
"1473433981783","","magdalena"
"1473433981783","x1=0.5+rnorm(n)","magdalena"
"1473433981799","x2=0.8+rnorm(n)","magdalena"
"1473433981806","","magdalena"
"1473433981812","for (i in 1","magdalena"
"s){","","magdalena"
"1473433981817","y=beta[i]*treat+x1+x2+rnorm(n)","magdalena"
"1473433981824","if (i==1){","magdalena"
"1473433981829","y_mat=y","magdalena"
"1473433981834","}","magdalena"
"1473433981840","if (i>1){","magdalena"
"1473433981845","y_mat=cbind(y_mat,y)","magdalena"
"1473433981849","}","magdalena"
"1473433981854","}","magdalena"
"1473433981871","","magdalena"
"1473433981876","data=cbind(y_mat,treat)","magdalena"
"1473433981881","names_data<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1473433981887","colnames(data)<-names_data","magdalena"
"1473433981892","data = as.data.frame(data)","magdalena"
"1473433981899","covariates=cbind(x1,x2)","magdalena"
"1473433981905","colnames(covariates)<-c(x1,x2)","magdalena"
"1473433981910","covariates = as.data.frame(covariates)","magdalena"
"1473433981917","","magdalena"
"1473433981922","","magdalena"
"1473433981926","","magdalena"
"1473433981931","","magdalena"
"1473433981936","","magdalena"
"1473433981942","","magdalena"
"1473433981948","","magdalena"
"1473433981953","k=2","magdalena"
"1473433981960","","magdalena"
"1473433981965","","magdalena"
"1473433981970","x_1=c(x1,x2)","magdalena"
"1473433981977","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473433981984","","magdalena"
"1473433981990","","magdalena"
"1473433981994","x_2=x2","magdalena"
"1473433982002","x_3=x_2","magdalena"
"1473433982008","x_10=c(x2,x1)","magdalena"
"1473433982015","","magdalena"
"1473433982020","l<-list(x_2,x_3,x_10)","magdalena"
"1473433982027","","magdalena"
"1473433982031","diff=c(2,3,10)","magdalena"
"1473433982037","","magdalena"
"1473433982041","for (i in 1","magdalena"
"length(diff)){","","magdalena"
"1473433982046","aux=l[[i]]","magdalena"
"1473433982051","X[diff[i],]=NA","magdalena"
"1473433982055","X[diff[i],1","magdalena"
"length(aux)]=l[[i]]","","magdalena"
"1473433982060","}","magdalena"
"1473433982067","","magdalena"
"1473433982073","MHT_rw2005=function(y_mat,treat,X,covariates,B=1000,robust=yes,names=names_data){","magdalena"
"1473433982079","","magdalena"
"1473433982083","s=ncol(y_mat)","magdalena"
"1473433982089","","magdalena"
"1473433982095","beta_hat=rep(NA,s)","magdalena"
"1473433982100","t_hat=rep(NA,s)","magdalena"
"1473433982105","reject_unadjust=rep(,s)","magdalena"
"1473433982111","for (i in 1","magdalena"
"s){","","magdalena"
"1473433982143","","magdalena"
"1473433982149","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473433982158","","magdalena"
"1473433982163","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473433982168","","magdalena"
"1473433982173","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473433982179","","magdalena"
"1473433982183","lm=lm(data_aux)","magdalena"
"1473433982190","","magdalena"
"1473433982195","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473433982200","beta_hat[i]=lm$coefficients[2]","magdalena"
"1473433982208","","magdalena"
"1473433982214","if(robust==no){","magdalena"
"1473433982219","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1473433982226","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1473433982231","reject_unadjust[i]=No","magdalena"
"1473433982236","}","magdalena"
"1473433982245","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1473433982251","reject_unadjust[i]=90","magdalena"
"1473433982260","}","magdalena"
"1473433982272","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1473433982278","reject_unadjust[i]=95","magdalena"
"1473433982284","}","magdalena"
"1473433982292","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1473433982308","reject_unadjust[i]=99","magdalena"
"1473433982314","}","magdalena"
"1473433982320","}","magdalena"
"1473433982328","","magdalena"
"1473433982333","if(robust==yes){","magdalena"
"1473433982339","t_hat[i]=abs(ct[2,3])","magdalena"
"1473433982346","if(ct[2,4]>0.1){","magdalena"
"1473433982351","reject_unadjust[i]=No","magdalena"
"1473433982357","}","magdalena"
"1473433982364","if(ct[2,4]<=0.1){","magdalena"
"1473433982372","reject_unadjust[i]=90","magdalena"
"1473433982378","}","magdalena"
"1473433982386","if(ct[2,4]<0.05){","magdalena"
"1473433982392","reject_unadjust[i]=95","magdalena"
"1473433982398","}","magdalena"
"1473433982407","if(ct[2,4]<0.01){","magdalena"
"1473433982412","reject_unadjust[i]=99","magdalena"
"1473433982418","}","magdalena"
"1473433982423","}","magdalena"
"1473433982429","}","magdalena"
"1473433982437","","magdalena"
"1473433982445","","magdalena"
"1473433982450","beta_bs=matrix(NA,B,s)","magdalena"
"1473433982456","t_bs=matrix(NA,B,s)","magdalena"
"1473433982464","for (i in 1","magdalena"
"B){","","magdalena"
"1473433982471","","magdalena"
"1473433982476","","magdalena"
"1473433982484","","magdalena"
"1473433982490","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1473433982499","","magdalena"
"1473433982504","y_mat_bs=y_mat[id,]","magdalena"
"1473433982510","treat_bs=treat[id]","magdalena"
"1473433982518","covariates_bs=covariates[id,]","magdalena"
"1473433982525","for (k in 1","magdalena"
"s){","","magdalena"
"1473433982533","","magdalena"
"1473433982540","covariates_aux=covariates_bs[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473433982548","","magdalena"
"1473433982554","data_aux=as.data.frame(cbind(y_mat_bs[,i],treat_bs,covariates_aux))","magdalena"
"1473433982560","","magdalena"
"1473433982566","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473433982574","","magdalena"
"1473433982580","lm=lm(data_aux)","magdalena"
"1473433982589","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473433982598","beta_bs[i,k]=lm$coefficients[2]","magdalena"
"1473433982607","if(robust==no){","magdalena"
"1473433982613","","magdalena"
"1473433982619","","magdalena"
"1473433982626","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1473433982633","}","magdalena"
"1473433982641","if(robust==yes){","magdalena"
"1473433982647","","magdalena"
"1473433982653","","magdalena"
"1473433982660","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/ct[2,2])","magdalena"
"1473433982666","}","magdalena"
"1473433982672","}","magdalena"
"1473433982678","}","magdalena"
"1473433982687","","magdalena"
"1473433982696","alpha=c(0.95,0.975,0.995)","magdalena"
"1473433982705","","magdalena"
"1473433982711","reject_adjust=rep(,s)","magdalena"
"1473433982720","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1473433982730","t_hat_aux=t_hat","magdalena"
"1473433982736","t_bs_aux=t_bs","magdalena"
"1473433982743","done=F","magdalena"
"1473433982757","while(done==F){","magdalena"
"1473433982765","","magdalena"
"1473433982804","t_max=max(t_hat_aux)","magdalena"
"1473433982811","","magdalena"
"1473433982818","k=which(t_hat_aux==t_max)","magdalena"
"1473433982828","","magdalena"
"1473433982853","if(!is.null(dim(t_bs_aux))){","magdalena"
"1473433982860","t_bs_max=t_bs_aux[,k]","magdalena"
"1473433982867","}","magdalena"
"1473433982873","","magdalena"
"1473433982880","if(is.null(dim(t_bs_aux))){","magdalena"
"1473433982902","t_bs_max=t_bs_aux","magdalena"
"1473433982909","}","magdalena"
"1473433982920","","magdalena"
"1473433982927","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1473433982939","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1473433982955","k_orig=which(t_hat==t_max)","magdalena"
"1473433982963","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1473433982969","t_hat_aux=t_hat_aux[-k]","magdalena"
"1473433982976","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1473433982983","print(k_orig)","magdalena"
"1473433982991","}","magdalena"
"1473433983004","if(is.null(dim(t_bs_aux))){","magdalena"
"1473433983010","t_bs_max=t_bs_aux","magdalena"
"1473433983018","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1473433983026","t_max=max(t_hat_aux)","magdalena"
"1473433983036","}","magdalena"
"1473433983062","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1473433983069","if(t_max>=t_quantile){","magdalena"
"1473433983078","k_orig=which(t_hat==t_max)","magdalena"
"1473433983086","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1473433983093","}","magdalena"
"1473433983101","done=T","magdalena"
"1473433983109","}","magdalena"
"1473433983117","}","magdalena"
"1473433983132","}","magdalena"
"1473433983142","reject_adjust[reject_adjust==]=No","magdalena"
"1473433983153","","magdalena"
"1473433983161","","magdalena"
"1473433983172","return(list(beta_hat,reject_unadjust,reject_adjust))","magdalena"
"1473433983194","}","magdalena"
"1473433983208","MHT=MHT_rw2005(y_mat=y_mat,treat=treat,X=X,covariates=covariates,B=1000,robust=no,names=names_data)","magdalena"
"1473434018536","","magdalena"
"1473434018541","","magdalena"
"1473434018545","","magdalena"
"1473434018551","library(lmtest)","magdalena"
"1473434018557","library(sandwich)","magdalena"
"1473434018564","","magdalena"
"1473434018569","","magdalena"
"1473434018575","","magdalena"
"1473434018580","rm(list = ls())","magdalena"
"1473434018589","","magdalena"
"1473434018593","cat(\014)","magdalena"
"1473434018605","","magdalena"
"1473434018611","","magdalena"
"1473434018615","","magdalena"
"1473434018622","","magdalena"
"1473434018627","n = 1000","magdalena"
"1473434018633","","magdalena"
"1473434018638","s = 10","magdalena"
"1473434018644","","magdalena"
"1473434018649","beta = rep(0,s)","magdalena"
"1473434018655","beta[1]=1","magdalena"
"1473434018663","","magdalena"
"1473434018668","prob=0.7","magdalena"
"1473434018682","treat=rbinom(n,1,prob)","magdalena"
"1473434018690","","magdalena"
"1473434018694","x1=0.5+rnorm(n)","magdalena"
"1473434018706","x2=0.8+rnorm(n)","magdalena"
"1473434018714","","magdalena"
"1473434018720","for (i in 1","magdalena"
"s){","","magdalena"
"1473434018725","y=beta[i]*treat+x1+x2+rnorm(n)","magdalena"
"1473434018731","if (i==1){","magdalena"
"1473434018736","y_mat=y","magdalena"
"1473434018741","}","magdalena"
"1473434018746","if (i>1){","magdalena"
"1473434018750","y_mat=cbind(y_mat,y)","magdalena"
"1473434018755","}","magdalena"
"1473434018760","}","magdalena"
"1473434018774","","magdalena"
"1473434018781","data=cbind(y_mat,treat)","magdalena"
"1473434018786","names_data<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1473434018791","colnames(data)<-names_data","magdalena"
"1473434018797","data = as.data.frame(data)","magdalena"
"1473434018805","covariates=cbind(x1,x2)","magdalena"
"1473434018811","colnames(covariates)<-c(x1,x2)","magdalena"
"1473434018817","covariates = as.data.frame(covariates)","magdalena"
"1473434018823","","magdalena"
"1473434018828","","magdalena"
"1473434018833","","magdalena"
"1473434018838","","magdalena"
"1473434018843","","magdalena"
"1473434018849","","magdalena"
"1473434018857","","magdalena"
"1473434018862","k=2","magdalena"
"1473434018872","","magdalena"
"1473434018879","","magdalena"
"1473434018883","x_1=c(x1,x2)","magdalena"
"1473434018892","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473434018899","","magdalena"
"1473434018905","","magdalena"
"1473434018912","x_2=x2","magdalena"
"1473434018918","x_3=x_2","magdalena"
"1473434018923","x_10=c(x2,x1)","magdalena"
"1473434018930","","magdalena"
"1473434018934","l<-list(x_2,x_3,x_10)","magdalena"
"1473434018941","","magdalena"
"1473434018946","diff=c(2,3,10)","magdalena"
"1473434018952","","magdalena"
"1473434018957","for (i in 1","magdalena"
"length(diff)){","","magdalena"
"1473434018962","aux=l[[i]]","magdalena"
"1473434018967","X[diff[i],]=NA","magdalena"
"1473434018972","X[diff[i],1","magdalena"
"length(aux)]=l[[i]]","","magdalena"
"1473434018977","}","magdalena"
"1473434031806","","magdalena"
"1473434031812","s=ncol(y_mat)","magdalena"
"1473434031818","","magdalena"
"1473434031824","beta_hat=rep(NA,s)","magdalena"
"1473434031830","t_hat=rep(NA,s)","magdalena"
"1473434031835","reject_unadjust=rep(,s)","magdalena"
"1473434048979","i=1","magdalena"
"1473434066364","for (i in 1","magdalena"
"s){","","magdalena"
"1473434066367","","magdalena"
"1473434066367","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473434066367","","magdalena"
"1473434066382","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473434066382","","magdalena"
"1473434066382","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473434066382","","magdalena"
"1473434066401","lm=lm(data_aux)","magdalena"
"1473434066405","","magdalena"
"1473434066408","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473434066410","beta_hat[i]=lm$coefficients[2]","magdalena"
"1473434066410","","magdalena"
"1473434066410","if(robust==no){","magdalena"
"1473434066426","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1473434066436","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1473434066440","reject_unadjust[i]=No","magdalena"
"1473434066444","}","magdalena"
"1473434066451","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1473434066456","reject_unadjust[i]=90","magdalena"
"1473434066461","}","magdalena"
"1473434066466","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1473434066469","reject_unadjust[i]=95","magdalena"
"1473434066472","}","magdalena"
"1473434066477","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1473434066481","reject_unadjust[i]=99","magdalena"
"1473434066486","}","magdalena"
"1473434066492","}","magdalena"
"1473434066498","","magdalena"
"1473434066504","if(robust==yes){","magdalena"
"1473434066509","t_hat[i]=abs(ct[2,3])","magdalena"
"1473434066521","if(ct[2,4]>0.1){","magdalena"
"1473434066526","reject_unadjust[i]=No","magdalena"
"1473434066532","}","magdalena"
"1473434066538","if(ct[2,4]<=0.1){","magdalena"
"1473434066543","reject_unadjust[i]=90","magdalena"
"1473434066549","}","magdalena"
"1473434066557","if(ct[2,4]<0.05){","magdalena"
"1473434066563","reject_unadjust[i]=95","magdalena"
"1473434066568","}","magdalena"
"1473434066576","if(ct[2,4]<0.01){","magdalena"
"1473434066582","reject_unadjust[i]=99","magdalena"
"1473434066587","}","magdalena"
"1473434066592","}","magdalena"
"1473434066598","}","magdalena"
"1473434076664","robust=no","magdalena"
"1473434078903","for (i in 1","magdalena"
"s){","","magdalena"
"1473434078908","","magdalena"
"1473434078912","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473434078917","","magdalena"
"1473434078922","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473434078923","","magdalena"
"1473434078923","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473434078923","","magdalena"
"1473434078939","lm=lm(data_aux)","magdalena"
"1473434078939","","magdalena"
"1473434078939","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473434078955","beta_hat[i]=lm$coefficients[2]","magdalena"
"1473434078955","","magdalena"
"1473434078955","if(robust==no){","magdalena"
"1473434078970","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1473434078970","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1473434078970","reject_unadjust[i]=No","magdalena"
"1473434078970","}","magdalena"
"1473434078986","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1473434078986","reject_unadjust[i]=90","magdalena"
"1473434078986","}","magdalena"
"1473434078986","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1473434079005","reject_unadjust[i]=95","magdalena"
"1473434079009","}","magdalena"
"1473434079016","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1473434079022","reject_unadjust[i]=99","magdalena"
"1473434079027","}","magdalena"
"1473434079032","}","magdalena"
"1473434079039","","magdalena"
"1473434079044","if(robust==yes){","magdalena"
"1473434079049","t_hat[i]=abs(ct[2,3])","magdalena"
"1473434079056","if(ct[2,4]>0.1){","magdalena"
"1473434079061","reject_unadjust[i]=No","magdalena"
"1473434079067","}","magdalena"
"1473434079081","if(ct[2,4]<=0.1){","magdalena"
"1473434079087","reject_unadjust[i]=90","magdalena"
"1473434079092","}","magdalena"
"1473434079100","if(ct[2,4]<0.05){","magdalena"
"1473434079105","reject_unadjust[i]=95","magdalena"
"1473434079110","}","magdalena"
"1473434079116","if(ct[2,4]<0.01){","magdalena"
"1473434079131","reject_unadjust[i]=99","magdalena"
"1473434079137","}","magdalena"
"1473434079143","}","magdalena"
"1473434079149","}","magdalena"
"1473434120484","","magdalena"
"1473434120488","beta_bs=matrix(NA,B,s)","magdalena"
"1473434120495","t_bs=matrix(NA,B,s)","magdalena"
"1473434125317","B=1000","magdalena"
"1473434127929","","magdalena"
"1473434127933","beta_bs=matrix(NA,B,s)","magdalena"
"1473434127938","t_bs=matrix(NA,B,s)","magdalena"
"1473434135247","I=1","magdalena"
"1473434137528","i=1","magdalena"
"1473434146230","","magdalena"
"1473434146230","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1473434146230","","magdalena"
"1473434146245","y_mat_bs=y_mat[id,]","magdalena"
"1473434146245","treat_bs=treat[id]","magdalena"
"1473434146245","covariates_bs=covariates[id,]","magdalena"
"1473434162963","k=1","magdalena"
"1473434176660","c(X[i,!is.na(X[i,])])","magdalena"
"1473434186905","covariates_aux=covariates_bs[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473434201922","View(covariates_bs)","magdalena"
"1473434264358","","magdalena"
"1473434264362","","magdalena"
"1473434264367","","magdalena"
"1473434264372","library(lmtest)","magdalena"
"1473434264379","library(sandwich)","magdalena"
"1473434264385","","magdalena"
"1473434264390","","magdalena"
"1473434264396","","magdalena"
"1473434264401","rm(list = ls())","magdalena"
"1473434264408","","magdalena"
"1473434264413","cat(\014)","magdalena"
"1473434264426","","magdalena"
"1473434264432","","magdalena"
"1473434264440","","magdalena"
"1473434264448","","magdalena"
"1473434264454","n = 1000","magdalena"
"1473434264460","","magdalena"
"1473434264469","s = 10","magdalena"
"1473434264481","","magdalena"
"1473434264486","beta = rep(0,s)","magdalena"
"1473434264491","beta[1]=1","magdalena"
"1473434264497","","magdalena"
"1473434264504","prob=0.7","magdalena"
"1473434264516","treat=rbinom(n,1,prob)","magdalena"
"1473434264523","","magdalena"
"1473434264528","x1=0.5+rnorm(n)","magdalena"
"1473434264560","x2=0.8+rnorm(n)","magdalena"
"1473434264573","","magdalena"
"1473434264585","for (i in 1","magdalena"
"s){","","magdalena"
"1473434264591","y=beta[i]*treat+x1+x2+rnorm(n)","magdalena"
"1473434264597","if (i==1){","magdalena"
"1473434264601","y_mat=y","magdalena"
"1473434264607","}","magdalena"
"1473434264612","if (i>1){","magdalena"
"1473434264616","y_mat=cbind(y_mat,y)","magdalena"
"1473434264623","}","magdalena"
"1473434264628","}","magdalena"
"1473434264642","","magdalena"
"1473434264646","data=cbind(y_mat,treat)","magdalena"
"1473434264652","names_data<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1473434264657","colnames(data)<-names_data","magdalena"
"1473434264663","data = as.data.frame(data)","magdalena"
"1473434264673","covariates=cbind(x1,x2)","magdalena"
"1473434264680","colnames(covariates)<-c(x1,x2)","magdalena"
"1473434264687","covariates = as.data.frame(covariates)","magdalena"
"1473434264694","","magdalena"
"1473434264698","","magdalena"
"1473434264702","","magdalena"
"1473434264709","","magdalena"
"1473434264714","","magdalena"
"1473434264720","","magdalena"
"1473434264727","","magdalena"
"1473434264733","k=2","magdalena"
"1473434264739","","magdalena"
"1473434264745","","magdalena"
"1473434264749","x_1=c(x1,x2)","magdalena"
"1473434264756","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473434264762","","magdalena"
"1473434264775","","magdalena"
"1473434264780","x_2=x2","magdalena"
"1473434264785","x_3=x_2","magdalena"
"1473434264791","x_10=c(x2,x1)","magdalena"
"1473434264797","","magdalena"
"1473434264801","l<-list(x_2,x_3,x_10)","magdalena"
"1473434264807","","magdalena"
"1473434264811","diff=c(2,3,10)","magdalena"
"1473434264818","","magdalena"
"1473434264823","for (i in 1","magdalena"
"length(diff)){","","magdalena"
"1473434264827","aux=l[[i]]","magdalena"
"1473434264832","X[diff[i],]=NA","magdalena"
"1473434264836","X[diff[i],1","magdalena"
"length(aux)]=l[[i]]","","magdalena"
"1473434264841","}","magdalena"
"1473434264847","","magdalena"
"1473434264853","MHT_rw2005=function(y_mat,treat,X,covariates,B=1000,robust=yes,names=names_data){","magdalena"
"1473434264859","","magdalena"
"1473434264864","s=ncol(y_mat)","magdalena"
"1473434264869","","magdalena"
"1473434264875","beta_hat=rep(NA,s)","magdalena"
"1473434264880","t_hat=rep(NA,s)","magdalena"
"1473434264885","reject_unadjust=rep(,s)","magdalena"
"1473434264891","for (i in 1","magdalena"
"s){","","magdalena"
"1473434264899","","magdalena"
"1473434264904","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473434264910","","magdalena"
"1473434264915","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473434264922","","magdalena"
"1473434264926","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473434264933","","magdalena"
"1473434264938","lm=lm(data_aux)","magdalena"
"1473434264944","","magdalena"
"1473434264949","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473434264954","beta_hat[i]=lm$coefficients[2]","magdalena"
"1473434264961","","magdalena"
"1473434264966","if(robust==no){","magdalena"
"1473434264970","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1473434264978","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1473434264983","reject_unadjust[i]=No","magdalena"
"1473434264987","}","magdalena"
"1473434264994","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1473434264999","reject_unadjust[i]=90","magdalena"
"1473434265004","}","magdalena"
"1473434265011","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1473434265016","reject_unadjust[i]=95","magdalena"
"1473434265021","}","magdalena"
"1473434265028","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1473434265033","reject_unadjust[i]=99","magdalena"
"1473434265038","}","magdalena"
"1473434265042","}","magdalena"
"1473434265049","","magdalena"
"1473434265054","if(robust==yes){","magdalena"
"1473434265060","t_hat[i]=abs(ct[2,3])","magdalena"
"1473434265067","if(ct[2,4]>0.1){","magdalena"
"1473434265073","reject_unadjust[i]=No","magdalena"
"1473434265078","}","magdalena"
"1473434265086","if(ct[2,4]<=0.1){","magdalena"
"1473434265092","reject_unadjust[i]=90","magdalena"
"1473434265098","}","magdalena"
"1473434265114","if(ct[2,4]<0.05){","magdalena"
"1473434265120","reject_unadjust[i]=95","magdalena"
"1473434265126","}","magdalena"
"1473434265133","if(ct[2,4]<0.01){","magdalena"
"1473434265138","reject_unadjust[i]=99","magdalena"
"1473434265144","}","magdalena"
"1473434265149","}","magdalena"
"1473434265155","}","magdalena"
"1473434265164","","magdalena"
"1473434265172","","magdalena"
"1473434265177","beta_bs=matrix(NA,B,s)","magdalena"
"1473434265183","t_bs=matrix(NA,B,s)","magdalena"
"1473434265193","for (i in 1","magdalena"
"B){","","magdalena"
"1473434265198","","magdalena"
"1473434265204","","magdalena"
"1473434265212","","magdalena"
"1473434265217","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1473434265225","","magdalena"
"1473434265233","y_mat_bs=y_mat[id,]","magdalena"
"1473434265239","treat_bs=treat[id]","magdalena"
"1473434265246","covariates_bs=covariates[id,]","magdalena"
"1473434265256","for (k in 1","magdalena"
"s){","","magdalena"
"1473434265265","","magdalena"
"1473434265272","covariates_aux=covariates_bs[,c(X[k,!is.na(X[k,])])]","magdalena"
"1473434265280","","magdalena"
"1473434265286","data_aux=as.data.frame(cbind(y_mat_bs[,k],treat_bs,covariates_aux))","magdalena"
"1473434265292","","magdalena"
"1473434265298","names(data_aux)<-c(names_data[k],treat,X[k,!is.na(X[k,])])","magdalena"
"1473434265306","","magdalena"
"1473434265312","lm=lm(data_aux)","magdalena"
"1473434265321","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473434265329","beta_bs[i,k]=lm$coefficients[2]","magdalena"
"1473434265339","if(robust==no){","magdalena"
"1473434265344","","magdalena"
"1473434265350","","magdalena"
"1473434265356","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1473434265362","}","magdalena"
"1473434265370","if(robust==yes){","magdalena"
"1473434265378","","magdalena"
"1473434265385","","magdalena"
"1473434265392","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/ct[2,2])","magdalena"
"1473434265401","}","magdalena"
"1473434265409","}","magdalena"
"1473434265457","}","magdalena"
"1473434265528","","magdalena"
"1473434265570","alpha=c(0.95,0.975,0.995)","magdalena"
"1473434265579","","magdalena"
"1473434265586","reject_adjust=rep(,s)","magdalena"
"1473434265595","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1473434265605","t_hat_aux=t_hat","magdalena"
"1473434265612","t_bs_aux=t_bs","magdalena"
"1473434265618","done=F","magdalena"
"1473434265627","while(done==F){","magdalena"
"1473434265634","","magdalena"
"1473434265641","t_max=max(t_hat_aux)","magdalena"
"1473434265648","","magdalena"
"1473434265654","k=which(t_hat_aux==t_max)","magdalena"
"1473434265664","","magdalena"
"1473434265670","if(!is.null(dim(t_bs_aux))){","magdalena"
"1473434265677","t_bs_max=t_bs_aux[,k]","magdalena"
"1473434265683","}","magdalena"
"1473434265689","","magdalena"
"1473434265696","if(is.null(dim(t_bs_aux))){","magdalena"
"1473434265701","t_bs_max=t_bs_aux","magdalena"
"1473434265708","}","magdalena"
"1473434265717","","magdalena"
"1473434265724","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1473434265733","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1473434265739","k_orig=which(t_hat==t_max)","magdalena"
"1473434265756","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1473434265762","t_hat_aux=t_hat_aux[-k]","magdalena"
"1473434265768","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1473434265774","print(k_orig)","magdalena"
"1473434265780","}","magdalena"
"1473434265792","if(is.null(dim(t_bs_aux))){","magdalena"
"1473434265799","t_bs_max=t_bs_aux","magdalena"
"1473434265805","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1473434265811","t_max=max(t_hat_aux)","magdalena"
"1473434265817","}","magdalena"
"1473434265830","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1473434265837","if(t_max>=t_quantile){","magdalena"
"1473434265845","k_orig=which(t_hat==t_max)","magdalena"
"1473434265851","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1473434265858","}","magdalena"
"1473434265864","done=T","magdalena"
"1473434265870","}","magdalena"
"1473434265878","}","magdalena"
"1473434265886","}","magdalena"
"1473434265897","reject_adjust[reject_adjust==]=No","magdalena"
"1473434265907","","magdalena"
"1473434265914","","magdalena"
"1473434265926","return(list(beta_hat,reject_unadjust,reject_adjust))","magdalena"
"1473434265941","}","magdalena"
"1473434265954","MHT=MHT_rw2005(y_mat=y_mat,treat=treat,X=X,covariates=covariates,B=1000,robust=no,names=names_data)","magdalena"
"1473435057007","MHT","magdalena"
"1473435115264","","magdalena"
"1473435115269","","magdalena"
"1473435115273","","magdalena"
"1473435115278","library(lmtest)","magdalena"
"1473435115286","library(sandwich)","magdalena"
"1473435115293","","magdalena"
"1473435115298","","magdalena"
"1473435115304","","magdalena"
"1473435115308","rm(list = ls())","magdalena"
"1473435115315","","magdalena"
"1473435115320","cat(\014)","magdalena"
"1473435115333","","magdalena"
"1473435115340","","magdalena"
"1473435115345","set.seed(100)","magdalena"
"1473435115358","","magdalena"
"1473435115364","n = 1000","magdalena"
"1473435115370","","magdalena"
"1473435115376","s = 10","magdalena"
"1473435115418","","magdalena"
"1473435115425","beta = rep(0,s)","magdalena"
"1473435115430","beta[1]=1","magdalena"
"1473435115437","","magdalena"
"1473435115442","prob=0.7","magdalena"
"1473435115448","treat=rbinom(n,1,prob)","magdalena"
"1473435115457","","magdalena"
"1473435115462","x1=0.5+rnorm(n)","magdalena"
"1473435115469","x2=0.8+rnorm(n)","magdalena"
"1473435115485","","magdalena"
"1473435115495","for (i in 1","magdalena"
"s){","","magdalena"
"1473435115500","y=beta[i]*treat+x1+x2+rnorm(n)","magdalena"
"1473435115517","if (i==1){","magdalena"
"1473435115535","y_mat=y","magdalena"
"1473435115550","}","magdalena"
"1473435115562","if (i>1){","magdalena"
"1473435115571","y_mat=cbind(y_mat,y)","magdalena"
"1473435115578","}","magdalena"
"1473435115599","}","magdalena"
"1473435115618","","magdalena"
"1473435115624","data=cbind(y_mat,treat)","magdalena"
"1473435115630","names_data<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1473435115639","colnames(data)<-names_data","magdalena"
"1473435115658","data = as.data.frame(data)","magdalena"
"1473435115667","covariates=cbind(x1,x2)","magdalena"
"1473435115674","colnames(covariates)<-c(x1,x2)","magdalena"
"1473435115680","covariates = as.data.frame(covariates)","magdalena"
"1473435115687","","magdalena"
"1473435115694","","magdalena"
"1473435115701","","magdalena"
"1473435115705","","magdalena"
"1473435115710","","magdalena"
"1473435115716","","magdalena"
"1473435115722","","magdalena"
"1473435115726","k=2","magdalena"
"1473435115733","","magdalena"
"1473435115739","","magdalena"
"1473435115745","x_1=c(x1,x2)","magdalena"
"1473435115754","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473435115772","","magdalena"
"1473435115780","","magdalena"
"1473435115788","x_2=x2","magdalena"
"1473435115797","x_3=x_2","magdalena"
"1473435115803","x_10=c(x2,x1)","magdalena"
"1473435115815","","magdalena"
"1473435115821","l<-list(x_2,x_3,x_10)","magdalena"
"1473435115840","","magdalena"
"1473435115845","diff=c(2,3,10)","magdalena"
"1473435115859","","magdalena"
"1473435115866","for (i in 1","magdalena"
"length(diff)){","","magdalena"
"1473435115871","aux=l[[i]]","magdalena"
"1473435115876","X[diff[i],]=NA","magdalena"
"1473435115883","X[diff[i],1","magdalena"
"length(aux)]=l[[i]]","","magdalena"
"1473435115891","}","magdalena"
"1473435115900","","magdalena"
"1473435115905","MHT_rw2005=function(y_mat,treat,X,covariates,B=1000,robust=yes,names=names_data){","magdalena"
"1473435115911","","magdalena"
"1473435115925","s=ncol(y_mat)","magdalena"
"1473435115934","","magdalena"
"1473435115944","beta_hat=rep(NA,s)","magdalena"
"1473435115950","t_hat=rep(NA,s)","magdalena"
"1473435115958","reject_unadjust=rep(,s)","magdalena"
"1473435115968","for (i in 1","magdalena"
"s){","","magdalena"
"1473435115976","","magdalena"
"1473435115986","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473435115993","","magdalena"
"1473435115999","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473435116005","","magdalena"
"1473435116020","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473435116031","","magdalena"
"1473435116038","lm=lm(data_aux)","magdalena"
"1473435116045","","magdalena"
"1473435116052","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473435116071","beta_hat[i]=lm$coefficients[2]","magdalena"
"1473435116087","","magdalena"
"1473435116094","if(robust==no){","magdalena"
"1473435116105","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1473435116121","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1473435116126","reject_unadjust[i]=No","magdalena"
"1473435116133","}","magdalena"
"1473435116141","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1473435116146","reject_unadjust[i]=90","magdalena"
"1473435116151","}","magdalena"
"1473435116161","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1473435116167","reject_unadjust[i]=95","magdalena"
"1473435116183","}","magdalena"
"1473435116193","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1473435116199","reject_unadjust[i]=99","magdalena"
"1473435116204","}","magdalena"
"1473435116209","}","magdalena"
"1473435116216","","magdalena"
"1473435116230","if(robust==yes){","magdalena"
"1473435116235","t_hat[i]=abs(ct[2,3])","magdalena"
"1473435116242","if(ct[2,4]>0.1){","magdalena"
"1473435116248","reject_unadjust[i]=No","magdalena"
"1473435116253","}","magdalena"
"1473435116261","if(ct[2,4]<=0.1){","magdalena"
"1473435116266","reject_unadjust[i]=90","magdalena"
"1473435116291","}","magdalena"
"1473435116302","if(ct[2,4]<0.05){","magdalena"
"1473435116309","reject_unadjust[i]=95","magdalena"
"1473435116316","}","magdalena"
"1473435116327","if(ct[2,4]<0.01){","magdalena"
"1473435116339","reject_unadjust[i]=99","magdalena"
"1473435116346","}","magdalena"
"1473435116354","}","magdalena"
"1473435116360","}","magdalena"
"1473435116402","","magdalena"
"1473435116410","","magdalena"
"1473435116426","beta_bs=matrix(NA,B,s)","magdalena"
"1473435116433","t_bs=matrix(NA,B,s)","magdalena"
"1473435116443","for (i in 1","magdalena"
"B){","","magdalena"
"1473435116458","","magdalena"
"1473435116466","","magdalena"
"1473435116476","","magdalena"
"1473435116485","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1473435116493","","magdalena"
"1473435116501","y_mat_bs=y_mat[id,]","magdalena"
"1473435116507","treat_bs=treat[id]","magdalena"
"1473435116516","covariates_bs=covariates[id,]","magdalena"
"1473435116524","for (k in 1","magdalena"
"s){","","magdalena"
"1473435116532","","magdalena"
"1473435116538","covariates_aux=covariates_bs[,c(X[k,!is.na(X[k,])])]","magdalena"
"1473435116546","","magdalena"
"1473435116552","data_aux=as.data.frame(cbind(y_mat_bs[,k],treat_bs,covariates_aux))","magdalena"
"1473435116558","","magdalena"
"1473435116564","names(data_aux)<-c(names_data[k],treat,X[k,!is.na(X[k,])])","magdalena"
"1473435116573","","magdalena"
"1473435116578","lm=lm(data_aux)","magdalena"
"1473435116586","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473435116595","beta_bs[i,k]=lm$coefficients[2]","magdalena"
"1473435116603","if(robust==no){","magdalena"
"1473435116610","","magdalena"
"1473435116617","","magdalena"
"1473435116623","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1473435116629","}","magdalena"
"1473435116637","if(robust==yes){","magdalena"
"1473435116643","","magdalena"
"1473435116649","","magdalena"
"1473435116655","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/ct[2,2])","magdalena"
"1473435116662","}","magdalena"
"1473435116668","}","magdalena"
"1473435116675","}","magdalena"
"1473435116689","","magdalena"
"1473435116700","alpha=c(0.95,0.975,0.995)","magdalena"
"1473435116709","","magdalena"
"1473435116716","reject_adjust=rep(,s)","magdalena"
"1473435116725","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1473435116735","t_hat_aux=t_hat","magdalena"
"1473435116741","t_bs_aux=t_bs","magdalena"
"1473435116748","done=F","magdalena"
"1473435116757","while(done==F){","magdalena"
"1473435116764","","magdalena"
"1473435116770","t_max=max(t_hat_aux)","magdalena"
"1473435116777","","magdalena"
"1473435116783","k=which(t_hat_aux==t_max)","magdalena"
"1473435116792","","magdalena"
"1473435116798","if(!is.null(dim(t_bs_aux))){","magdalena"
"1473435116805","t_bs_max=t_bs_aux[,k]","magdalena"
"1473435116811","}","magdalena"
"1473435116817","","magdalena"
"1473435116823","if(is.null(dim(t_bs_aux))){","magdalena"
"1473435116829","t_bs_max=t_bs_aux","magdalena"
"1473435116835","}","magdalena"
"1473435116846","","magdalena"
"1473435116852","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1473435116863","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1473435116869","k_orig=which(t_hat==t_max)","magdalena"
"1473435116876","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1473435116882","t_hat_aux=t_hat_aux[-k]","magdalena"
"1473435116888","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1473435116895","print(k_orig)","magdalena"
"1473435116902","}","magdalena"
"1473435116912","if(is.null(dim(t_bs_aux))){","magdalena"
"1473435116919","t_bs_max=t_bs_aux","magdalena"
"1473435116926","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1473435116932","t_max=max(t_hat_aux)","magdalena"
"1473435116939","}","magdalena"
"1473435116950","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1473435116957","if(t_max>=t_quantile){","magdalena"
"1473435116964","k_orig=which(t_hat==t_max)","magdalena"
"1473435116971","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1473435116982","}","magdalena"
"1473435116989","done=T","magdalena"
"1473435116996","}","magdalena"
"1473435117010","}","magdalena"
"1473435117018","}","magdalena"
"1473435117029","reject_adjust[reject_adjust==]=No","magdalena"
"1473435117040","","magdalena"
"1473435117049","","magdalena"
"1473435117060","return(list(beta_hat,reject_unadjust,reject_adjust))","magdalena"
"1473435117072","}","magdalena"
"1473435117087","MHT=MHT_rw2005(y_mat=y_mat,treat=treat,X=X,covariates=covariates,B=1000,robust=no,names=names_data)","magdalena"
"1473435669332","MHT","magdalena"
"1473435733971","","magdalena"
"1473435733976","","magdalena"
"1473435733976","","magdalena"
"1473435733976","library(lmtest)","magdalena"
"1473435733991","library(sandwich)","magdalena"
"1473435733991","","magdalena"
"1473435733991","","magdalena"
"1473435733991","","magdalena"
"1473435734010","rm(list = ls())","magdalena"
"1473435734016","","magdalena"
"1473435734020","cat(\014)","magdalena"
"1473435734022","","magdalena"
"1473435734022","","magdalena"
"1473435734038","","magdalena"
"1473435734043","","magdalena"
"1473435734048","n = 1000","magdalena"
"1473435734055","","magdalena"
"1473435734060","s = 10","magdalena"
"1473435734067","","magdalena"
"1473435734071","beta = rep(0,s)","magdalena"
"1473435734076","beta[1]=1","magdalena"
"1473435734083","","magdalena"
"1473435734087","prob=0.7","magdalena"
"1473435734092","treat=rbinom(n,1,prob)","magdalena"
"1473435734099","","magdalena"
"1473435734104","x1=0.5+rnorm(n)","magdalena"
"1473435734110","x2=0.8+rnorm(n)","magdalena"
"1473435734118","","magdalena"
"1473435734123","for (i in 1","magdalena"
"s){","","magdalena"
"1473435734127","y=beta[i]*treat+x1+x2+rnorm(n)","magdalena"
"1473435734133","if (i==1){","magdalena"
"1473435734137","y_mat=y","magdalena"
"1473435734141","}","magdalena"
"1473435734144","if (i>1){","magdalena"
"1473435734148","y_mat=cbind(y_mat,y)","magdalena"
"1473435734151","}","magdalena"
"1473435734155","}","magdalena"
"1473435734165","","magdalena"
"1473435734168","data=cbind(y_mat,treat)","magdalena"
"1473435734173","names_data<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1473435734178","colnames(data)<-names_data","magdalena"
"1473435734183","data = as.data.frame(data)","magdalena"
"1473435734188","covariates=cbind(x1,x2)","magdalena"
"1473435734192","colnames(covariates)<-c(x1,x2)","magdalena"
"1473435734196","covariates = as.data.frame(covariates)","magdalena"
"1473435734202","","magdalena"
"1473435734205","","magdalena"
"1473435734209","","magdalena"
"1473435734212","","magdalena"
"1473435734216","","magdalena"
"1473435734220","","magdalena"
"1473435734224","","magdalena"
"1473435734228","k=2","magdalena"
"1473435734232","","magdalena"
"1473435734237","","magdalena"
"1473435734241","x_1=c(x1,x2)","magdalena"
"1473435734246","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473435734253","","magdalena"
"1473435734258","","magdalena"
"1473435734261","x_2=x2","magdalena"
"1473435734265","x_3=x_2","magdalena"
"1473435734269","x_10=c(x2,x1)","magdalena"
"1473435734274","","magdalena"
"1473435734278","l<-list(x_2,x_3,x_10)","magdalena"
"1473435734283","","magdalena"
"1473435734287","diff=c(2,3,10)","magdalena"
"1473435734291","","magdalena"
"1473435734292","for (i in 1","magdalena"
"length(diff)){","","magdalena"
"1473435734292","aux=l[[i]]","magdalena"
"1473435734292","X[diff[i],]=NA","magdalena"
"1473435734292","X[diff[i],1","magdalena"
"length(aux)]=l[[i]]","","magdalena"
"1473435734307","}","magdalena"
"1473435734307","","magdalena"
"1473435734307","MHT_rw2005=function(y_mat,treat,X,covariates,B=1000,robust=yes,names=names_data){","magdalena"
"1473435734323","","magdalena"
"1473435734323","s=ncol(y_mat)","magdalena"
"1473435734323","","magdalena"
"1473435734339","beta_hat=rep(NA,s)","magdalena"
"1473435734339","t_hat=rep(NA,s)","magdalena"
"1473435734339","reject_unadjust=rep(,s)","magdalena"
"1473435734354","for (i in 1","magdalena"
"s){","","magdalena"
"1473435734354","","magdalena"
"1473435734354","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473435734370","","magdalena"
"1473435734370","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473435734370","","magdalena"
"1473435734370","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473435734389","","magdalena"
"1473435734393","lm=lm(data_aux)","magdalena"
"1473435734397","","magdalena"
"1473435734401","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473435734405","beta_hat[i]=lm$coefficients[2]","magdalena"
"1473435734411","","magdalena"
"1473435734416","if(robust==no){","magdalena"
"1473435734420","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1473435734425","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1473435734429","reject_unadjust[i]=No","magdalena"
"1473435734432","}","magdalena"
"1473435734438","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1473435734442","reject_unadjust[i]=90","magdalena"
"1473435734442","}","magdalena"
"1473435734442","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1473435734442","reject_unadjust[i]=95","magdalena"
"1473435734458","}","magdalena"
"1473435734458","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1473435734458","reject_unadjust[i]=99","magdalena"
"1473435734473","}","magdalena"
"1473435734473","}","magdalena"
"1473435734473","","magdalena"
"1473435734491","if(robust==yes){","magdalena"
"1473435734492","t_hat[i]=abs(ct[2,3])","magdalena"
"1473435734492","if(ct[2,4]>0.1){","magdalena"
"1473435734492","reject_unadjust[i]=No","magdalena"
"1473435734508","}","magdalena"
"1473435734508","if(ct[2,4]<=0.1){","magdalena"
"1473435734523","reject_unadjust[i]=90","magdalena"
"1473435734523","}","magdalena"
"1473435734523","if(ct[2,4]<0.05){","magdalena"
"1473435734539","reject_unadjust[i]=95","magdalena"
"1473435734539","}","magdalena"
"1473435734554","if(ct[2,4]<0.01){","magdalena"
"1473435734554","reject_unadjust[i]=99","magdalena"
"1473435734554","}","magdalena"
"1473435734570","}","magdalena"
"1473435734570","}","magdalena"
"1473435734570","","magdalena"
"1473435734591","","magdalena"
"1473435734597","beta_bs=matrix(NA,B,s)","magdalena"
"1473435734602","t_bs=matrix(NA,B,s)","magdalena"
"1473435734608","for (i in 1","magdalena"
"B){","","magdalena"
"1473435734613","","magdalena"
"1473435734617","","magdalena"
"1473435734624","","magdalena"
"1473435734629","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1473435734636","","magdalena"
"1473435734642","y_mat_bs=y_mat[id,]","magdalena"
"1473435734648","treat_bs=treat[id]","magdalena"
"1473435734656","covariates_bs=covariates[id,]","magdalena"
"1473435734665","for (k in 1","magdalena"
"s){","","magdalena"
"1473435734673","","magdalena"
"1473435734679","covariates_aux=covariates_bs[,c(X[k,!is.na(X[k,])])]","magdalena"
"1473435734687","","magdalena"
"1473435734693","data_aux=as.data.frame(cbind(y_mat_bs[,k],treat_bs,covariates_aux))","magdalena"
"1473435734699","","magdalena"
"1473435734705","names(data_aux)<-c(names_data[k],treat,X[k,!is.na(X[k,])])","magdalena"
"1473435734715","","magdalena"
"1473435734721","lm=lm(data_aux)","magdalena"
"1473435734730","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473435734738","beta_bs[i,k]=lm$coefficients[2]","magdalena"
"1473435734746","if(robust==no){","magdalena"
"1473435734753","","magdalena"
"1473435734759","","magdalena"
"1473435734766","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm(y_mat_bs[,k]~treat_bs))$coefficients[2,2])","magdalena"
"1473435734773","}","magdalena"
"1473435734779","if(robust==yes){","magdalena"
"1473435734784","","magdalena"
"1473435734790","","magdalena"
"1473435734797","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/ct[2,2])","magdalena"
"1473435734804","}","magdalena"
"1473435734810","}","magdalena"
"1473435734815","}","magdalena"
"1473435734823","","magdalena"
"1473435734832","alpha=c(0.95,0.975,0.995)","magdalena"
"1473435734841","","magdalena"
"1473435734847","reject_adjust=rep(,s)","magdalena"
"1473435734857","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1473435734866","t_hat_aux=t_hat","magdalena"
"1473435734871","t_bs_aux=t_bs","magdalena"
"1473435734876","done=F","magdalena"
"1473435734882","while(done==F){","magdalena"
"1473435734887","","magdalena"
"1473435734894","t_max=max(t_hat_aux)","magdalena"
"1473435734901","","magdalena"
"1473435734907","k=which(t_hat_aux==t_max)","magdalena"
"1473435734917","","magdalena"
"1473435734926","if(!is.null(dim(t_bs_aux))){","magdalena"
"1473435734933","t_bs_max=t_bs_aux[,k]","magdalena"
"1473435734940","}","magdalena"
"1473435734946","","magdalena"
"1473435734953","if(is.null(dim(t_bs_aux))){","magdalena"
"1473435734966","t_bs_max=t_bs_aux","magdalena"
"1473435734975","}","magdalena"
"1473435734985","","magdalena"
"1473435734993","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1473435735003","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1473435735010","k_orig=which(t_hat==t_max)","magdalena"
"1473435735017","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1473435735023","t_hat_aux=t_hat_aux[-k]","magdalena"
"1473435735030","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1473435735037","print(k_orig)","magdalena"
"1473435735045","}","magdalena"
"1473435735055","if(is.null(dim(t_bs_aux))){","magdalena"
"1473435735062","t_bs_max=t_bs_aux","magdalena"
"1473435735069","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1473435735078","t_max=max(t_hat_aux)","magdalena"
"1473435735085","}","magdalena"
"1473435735095","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1473435735101","if(t_max>=t_quantile){","magdalena"
"1473435735106","k_orig=which(t_hat==t_max)","magdalena"
"1473435735111","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1473435735117","}","magdalena"
"1473435735124","done=T","magdalena"
"1473435735131","}","magdalena"
"1473435735138","}","magdalena"
"1473435735144","}","magdalena"
"1473435735154","reject_adjust[reject_adjust==]=No","magdalena"
"1473435735165","","magdalena"
"1473435735173","","magdalena"
"1473435735181","return(list(beta_hat,reject_unadjust,reject_adjust))","magdalena"
"1473435735191","}","magdalena"
"1473435735204","MHT=MHT_rw2005(y_mat=y_mat,treat=treat,X=X,covariates=covariates,B=1000,robust=no,names=names_data)","magdalena"
"1473437070288","MHT","magdalena"
"1473437174800","","magdalena"
"1473437174800","","magdalena"
"1473437174800","","magdalena"
"1473437174815","library(lmtest)","magdalena"
"1473437174815","library(sandwich)","magdalena"
"1473437174831","","magdalena"
"1473437174831","","magdalena"
"1473437174831","","magdalena"
"1473437174846","rm(list = ls())","magdalena"
"1473437174846","","magdalena"
"1473437174846","cat(\014)","magdalena"
"1473437174865","","magdalena"
"1473437174871","","magdalena"
"1473437174875","set.seed(100)","magdalena"
"1473437174881","","magdalena"
"1473437174886","n = 1000","magdalena"
"1473437174892","","magdalena"
"1473437174897","s = 10","magdalena"
"1473437174903","","magdalena"
"1473437174908","beta = rep(0,s)","magdalena"
"1473437174914","beta[1]=1","magdalena"
"1473437174920","","magdalena"
"1473437174925","prob=0.7","magdalena"
"1473437174930","treat=rbinom(n,1,prob)","magdalena"
"1473437174937","","magdalena"
"1473437174939","x1=0.5+rnorm(n)","magdalena"
"1473437174939","x2=0.8+rnorm(n)","magdalena"
"1473437174955","","magdalena"
"1473437174955","for (i in 1","magdalena"
"s){","","magdalena"
"1473437174955","y=beta[i]*treat+2*x1+x2+rnorm(n)","magdalena"
"1473437174980","if (i==1){","magdalena"
"1473437174985","y_mat=y","magdalena"
"1473437174990","}","magdalena"
"1473437174995","if (i>1){","magdalena"
"1473437175000","y_mat=cbind(y_mat,y)","magdalena"
"1473437175005","}","magdalena"
"1473437175011","}","magdalena"
"1473437175047","","magdalena"
"1473437175051","data=cbind(y_mat,treat)","magdalena"
"1473437175066","names_data<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1473437175081","colnames(data)<-names_data","magdalena"
"1473437175088","data = as.data.frame(data)","magdalena"
"1473437175096","covariates=cbind(x1,x2)","magdalena"
"1473437175102","colnames(covariates)<-c(x1,x2)","magdalena"
"1473437175108","covariates = as.data.frame(covariates)","magdalena"
"1473437175118","","magdalena"
"1473437175122","","magdalena"
"1473437175127","","magdalena"
"1473437175132","","magdalena"
"1473437175136","","magdalena"
"1473437175142","","magdalena"
"1473437175148","","magdalena"
"1473437175158","k=2","magdalena"
"1473437175165","","magdalena"
"1473437175172","","magdalena"
"1473437175177","x_1=c(x1,x2)","magdalena"
"1473437175183","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473437175190","","magdalena"
"1473437175197","","magdalena"
"1473437175202","x_2=x2","magdalena"
"1473437175208","x_3=x_2","magdalena"
"1473437175214","x_10=c(x2,x1)","magdalena"
"1473437175222","","magdalena"
"1473437175227","l<-list(x_2,x_3,x_10)","magdalena"
"1473437175234","","magdalena"
"1473437175240","diff=c(2,3,10)","magdalena"
"1473437175247","","magdalena"
"1473437175252","for (i in 1","magdalena"
"length(diff)){","","magdalena"
"1473437175257","aux=l[[i]]","magdalena"
"1473437175304","X[diff[i],]=NA","magdalena"
"1473437175317","X[diff[i],1","magdalena"
"length(aux)]=l[[i]]","","magdalena"
"1473437175322","}","magdalena"
"1473437187027","B=1000","magdalena"
"1473437196365","robust=no","magdalena"
"1473437211553","","magdalena"
"1473437211556","s=ncol(y_mat)","magdalena"
"1473437211562","","magdalena"
"1473437211567","beta_hat=rep(NA,s)","magdalena"
"1473437211571","t_hat=rep(NA,s)","magdalena"
"1473437211575","reject_unadjust=rep(,s)","magdalena"
"1473437211575","for (i in 1","magdalena"
"s){","","magdalena"
"1473437211575","","magdalena"
"1473437211591","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473437211591","","magdalena"
"1473437211591","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473437211607","","magdalena"
"1473437211607","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473437211607","","magdalena"
"1473437211623","lm=lm(data_aux)","magdalena"
"1473437211629","","magdalena"
"1473437211634","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473437211638","beta_hat[i]=lm$coefficients[2]","magdalena"
"1473437211643","","magdalena"
"1473437211649","if(robust==no){","magdalena"
"1473437211653","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1473437211659","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1473437211663","reject_unadjust[i]=No","magdalena"
"1473437211667","}","magdalena"
"1473437211672","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1473437211675","reject_unadjust[i]=90","magdalena"
"1473437211680","}","magdalena"
"1473437211681","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1473437211681","reject_unadjust[i]=95","magdalena"
"1473437211681","}","magdalena"
"1473437211681","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1473437211701","reject_unadjust[i]=99","magdalena"
"1473437211706","}","magdalena"
"1473437211709","}","magdalena"
"1473437211710","","magdalena"
"1473437211710","if(robust==yes){","magdalena"
"1473437211725","t_hat[i]=abs(ct[2,3])","magdalena"
"1473437211725","if(ct[2,4]>0.1){","magdalena"
"1473437211725","reject_unadjust[i]=No","magdalena"
"1473437211741","}","magdalena"
"1473437211741","if(ct[2,4]<=0.1){","magdalena"
"1473437211741","reject_unadjust[i]=90","magdalena"
"1473437211760","}","magdalena"
"1473437211765","if(ct[2,4]<0.05){","magdalena"
"1473437211765","reject_unadjust[i]=95","magdalena"
"1473437211765","}","magdalena"
"1473437211780","if(ct[2,4]<0.01){","magdalena"
"1473437211780","reject_unadjust[i]=99","magdalena"
"1473437211796","}","magdalena"
"1473437211796","}","magdalena"
"1473437211796","}","magdalena"
"1473437217413","reject_unadjust","magdalena"
"1473437222660","beta_hat","magdalena"
"1473437257240","","magdalena"
"1473437257244","","magdalena"
"1473437257248","","magdalena"
"1473437257252","library(lmtest)","magdalena"
"1473437257258","library(sandwich)","magdalena"
"1473437257264","","magdalena"
"1473437257268","","magdalena"
"1473437257273","","magdalena"
"1473437257278","rm(list = ls())","magdalena"
"1473437257283","","magdalena"
"1473437257288","cat(\014)","magdalena"
"1473437257295","","magdalena"
"1473437257301","","magdalena"
"1473437257306","set.seed(100)","magdalena"
"1473437257312","","magdalena"
"1473437257318","n = 1000","magdalena"
"1473437257327","","magdalena"
"1473437257336","s = 10","magdalena"
"1473437257345","","magdalena"
"1473437257350","beta = rep(0,s)","magdalena"
"1473437257355","beta[1]=1","magdalena"
"1473437257360","","magdalena"
"1473437257365","prob=0.7","magdalena"
"1473437257366","treat=rbinom(n,1,prob)","magdalena"
"1473437257366","","magdalena"
"1473437257366","x1=0.5+rnorm(n)","magdalena"
"1473437257366","x2=0.8+rnorm(n)","magdalena"
"1473437257382","","magdalena"
"1473437257382","for (i in 1","magdalena"
"s){","","magdalena"
"1473437257382","y=beta[i]*treat+2*x1+x2+rnorm(n)","magdalena"
"1473437257397","if (i==1){","magdalena"
"1473437257397","y_mat=y","magdalena"
"1473437257397","}","magdalena"
"1473437257397","if (i>1){","magdalena"
"1473437257415","y_mat=cbind(y_mat,y)","magdalena"
"1473437257419","}","magdalena"
"1473437257424","}","magdalena"
"1473437257436","","magdalena"
"1473437257447","data=cbind(y_mat,treat)","magdalena"
"1473437257455","names_data<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1473437257460","colnames(data)<-names_data","magdalena"
"1473437257465","data = as.data.frame(data)","magdalena"
"1473437257471","covariates=cbind(x1,x2)","magdalena"
"1473437257476","colnames(covariates)<-c(x1,x2)","magdalena"
"1473437257482","covariates = as.data.frame(covariates)","magdalena"
"1473437257489","","magdalena"
"1473437257493","","magdalena"
"1473437257497","","magdalena"
"1473437257500","","magdalena"
"1473437257504","","magdalena"
"1473437257509","","magdalena"
"1473437257514","","magdalena"
"1473437257517","k=2","magdalena"
"1473437257523","","magdalena"
"1473437257529","","magdalena"
"1473437257533","x_1=c(x1,x2)","magdalena"
"1473437257540","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473437272482","B=1000","magdalena"
"1473437276428","robust=no","magdalena"
"1473437285302","","magdalena"
"1473437285306","s=ncol(y_mat)","magdalena"
"1473437285312","","magdalena"
"1473437285317","beta_hat=rep(NA,s)","magdalena"
"1473437285322","t_hat=rep(NA,s)","magdalena"
"1473437285327","reject_unadjust=rep(,s)","magdalena"
"1473437285333","for (i in 1","magdalena"
"s){","","magdalena"
"1473437285339","","magdalena"
"1473437285344","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473437285349","","magdalena"
"1473437285354","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473437285359","","magdalena"
"1473437285363","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473437285369","","magdalena"
"1473437285372","lm=lm(data_aux)","magdalena"
"1473437285378","","magdalena"
"1473437285381","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473437285385","beta_hat[i]=lm$coefficients[2]","magdalena"
"1473437285389","","magdalena"
"1473437285393","if(robust==no){","magdalena"
"1473437285397","t_hat[i]=abs(summary(lm(y_mat[,i]~treat))$coefficients[2,3])","magdalena"
"1473437285402","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]>0.1){","magdalena"
"1473437285408","reject_unadjust[i]=No","magdalena"
"1473437285413","}","magdalena"
"1473437285419","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.1){","magdalena"
"1473437285424","reject_unadjust[i]=90","magdalena"
"1473437285429","}","magdalena"
"1473437285438","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.05){","magdalena"
"1473437285443","reject_unadjust[i]=95","magdalena"
"1473437285448","}","magdalena"
"1473437285455","if(summary(lm(y_mat[,i]~treat))$coefficients[2,4]<=0.01){","magdalena"
"1473437285464","reject_unadjust[i]=99","magdalena"
"1473437285470","}","magdalena"
"1473437285476","}","magdalena"
"1473437285482","","magdalena"
"1473437285486","if(robust==yes){","magdalena"
"1473437285491","t_hat[i]=abs(ct[2,3])","magdalena"
"1473437285497","if(ct[2,4]>0.1){","magdalena"
"1473437285502","reject_unadjust[i]=No","magdalena"
"1473437285507","}","magdalena"
"1473437285513","if(ct[2,4]<=0.1){","magdalena"
"1473437285517","reject_unadjust[i]=90","magdalena"
"1473437285522","}","magdalena"
"1473437285528","if(ct[2,4]<0.05){","magdalena"
"1473437285533","reject_unadjust[i]=95","magdalena"
"1473437285537","}","magdalena"
"1473437285544","if(ct[2,4]<0.01){","magdalena"
"1473437285549","reject_unadjust[i]=99","magdalena"
"1473437285554","}","magdalena"
"1473437285558","}","magdalena"
"1473437285563","}","magdalena"
"1473437291879","reject_unadjust","magdalena"
"1473437299989","X","magdalena"
"1473437322194","","magdalena"
"1473437322196","s=ncol(y_mat)","magdalena"
"1473437322196","","magdalena"
"1473437322196","beta_hat=rep(NA,s)","magdalena"
"1473437322211","t_hat=rep(NA,s)","magdalena"
"1473437322211","reject_unadjust=rep(,s)","magdalena"
"1473437327005","i=1","magdalena"
"1473437331538","","magdalena"
"1473437331538","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473437331538","","magdalena"
"1473437331538","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473437331554","","magdalena"
"1473437331554","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473437331554","","magdalena"
"1473437331572","lm=lm(data_aux)","magdalena"
"1473437333544","lm","magdalena"
"1473437347892","summary(lm)","magdalena"
"1473437359340","i=2","magdalena"
"1473437362391","","magdalena"
"1473437362391","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473437362407","","magdalena"
"1473437362407","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473437362407","","magdalena"
"1473437362423","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473437362423","","magdalena"
"1473437362423","lm=lm(data_aux)","magdalena"
"1473437366265","summary(lm)","magdalena"
"1473437379972","i=3","magdalena"
"1473437381993","","magdalena"
"1473437381997","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473437382002","","magdalena"
"1473437382006","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473437382013","","magdalena"
"1473437382016","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473437382021","","magdalena"
"1473437382024","lm=lm(data_aux)","magdalena"
"1473437384635","summary(lm)","magdalena"
"1473437511718","","magdalena"
"1473437511733","s=ncol(y_mat)","magdalena"
"1473437511733","","magdalena"
"1473437511733","beta_hat=rep(NA,s)","magdalena"
"1473437511749","t_hat=rep(NA,s)","magdalena"
"1473437511749","reject_unadjust=rep(,s)","magdalena"
"1473437511749","for (i in 1","magdalena"
"s){","","magdalena"
"1473437511768","","magdalena"
"1473437511773","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473437511779","","magdalena"
"1473437511783","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473437511788","","magdalena"
"1473437511793","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473437511803","","magdalena"
"1473437511808","lm=lm(data_aux)","magdalena"
"1473437511815","","magdalena"
"1473437511822","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473437511827","beta_hat[i]=lm$coefficients[2]","magdalena"
"1473437511834","","magdalena"
"1473437511839","if(robust==no){","magdalena"
"1473437511844","t_hat[i]=abs(summary(lm)$coefficients[2,3])","magdalena"
"1473437511851","if(summary(lm)$coefficients[2,4]>0.1){","magdalena"
"1473437511856","reject_unadjust[i]=No","magdalena"
"1473437511861","}","magdalena"
"1473437511868","if(summary(lm)$coefficients[2,4]<=0.1){","magdalena"
"1473437511874","reject_unadjust[i]=90","magdalena"
"1473437511879","}","magdalena"
"1473437511886","if(summary(lm)$coefficients[2,4]<=0.05){","magdalena"
"1473437511891","reject_unadjust[i]=95","magdalena"
"1473437511896","}","magdalena"
"1473437511903","if(summary(lm)$coefficients[2,4]<=0.01){","magdalena"
"1473437511908","reject_unadjust[i]=99","magdalena"
"1473437511913","}","magdalena"
"1473437511918","}","magdalena"
"1473437511925","","magdalena"
"1473437511930","if(robust==yes){","magdalena"
"1473437511936","t_hat[i]=abs(ct[2,3])","magdalena"
"1473437511943","if(ct[2,4]>0.1){","magdalena"
"1473437511948","reject_unadjust[i]=No","magdalena"
"1473437511954","}","magdalena"
"1473437511961","if(ct[2,4]<=0.1){","magdalena"
"1473437511967","reject_unadjust[i]=90","magdalena"
"1473437511972","}","magdalena"
"1473437511980","if(ct[2,4]<0.05){","magdalena"
"1473437511986","reject_unadjust[i]=95","magdalena"
"1473437511993","}","magdalena"
"1473437512000","if(ct[2,4]<0.01){","magdalena"
"1473437512006","reject_unadjust[i]=99","magdalena"
"1473437512012","}","magdalena"
"1473437512017","}","magdalena"
"1473437512023","}","magdalena"
"1473437517948","reject_unadjust","magdalena"
"1473437578935","","magdalena"
"1473437578940","","magdalena"
"1473437578944","","magdalena"
"1473437578950","library(lmtest)","magdalena"
"1473437578956","library(sandwich)","magdalena"
"1473437578962","","magdalena"
"1473437578966","","magdalena"
"1473437578972","","magdalena"
"1473437578979","rm(list = ls())","magdalena"
"1473437578986","","magdalena"
"1473437578991","cat(\014)","magdalena"
"1473437578998","","magdalena"
"1473437579004","","magdalena"
"1473437579009","","magdalena"
"1473437579015","","magdalena"
"1473437579020","n = 1000","magdalena"
"1473437579027","","magdalena"
"1473437579032","s = 10","magdalena"
"1473437579038","","magdalena"
"1473437579042","beta = rep(0,s)","magdalena"
"1473437579048","beta[1]=1","magdalena"
"1473437579054","","magdalena"
"1473437579061","prob=0.7","magdalena"
"1473437579066","treat=rbinom(n,1,prob)","magdalena"
"1473437579073","","magdalena"
"1473437579077","x1=0.5+rnorm(n)","magdalena"
"1473437579083","x2=0.8+rnorm(n)","magdalena"
"1473437579090","","magdalena"
"1473437579096","for (i in 1","magdalena"
"s){","","magdalena"
"1473437579101","y=beta[i]*treat+2*x1+x2+rnorm(n)","magdalena"
"1473437579107","if (i==1){","magdalena"
"1473437579112","y_mat=y","magdalena"
"1473437579117","}","magdalena"
"1473437579121","if (i>1){","magdalena"
"1473437579126","y_mat=cbind(y_mat,y)","magdalena"
"1473437579131","}","magdalena"
"1473437579135","}","magdalena"
"1473437579151","","magdalena"
"1473437579155","data=cbind(y_mat,treat)","magdalena"
"1473437579162","names_data<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1473437579168","colnames(data)<-names_data","magdalena"
"1473437579174","data = as.data.frame(data)","magdalena"
"1473437579181","covariates=cbind(x1,x2)","magdalena"
"1473437579186","colnames(covariates)<-c(x1,x2)","magdalena"
"1473437579192","covariates = as.data.frame(covariates)","magdalena"
"1473437579198","","magdalena"
"1473437579203","","magdalena"
"1473437579207","","magdalena"
"1473437579212","","magdalena"
"1473437579216","","magdalena"
"1473437579222","","magdalena"
"1473437579228","","magdalena"
"1473437579233","k=2","magdalena"
"1473437579239","","magdalena"
"1473437579245","","magdalena"
"1473437579249","x_1=c(x1,x2)","magdalena"
"1473437579255","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473437579263","","magdalena"
"1473437579269","","magdalena"
"1473437579274","x_2=x2","magdalena"
"1473437579279","x_3=x_2","magdalena"
"1473437579284","x_10=c(x2,x1)","magdalena"
"1473437579291","","magdalena"
"1473437579295","l<-list(x_2,x_3,x_10)","magdalena"
"1473437579301","","magdalena"
"1473437579306","diff=c(2,3,10)","magdalena"
"1473437579312","","magdalena"
"1473437579316","for (i in 1","magdalena"
"length(diff)){","","magdalena"
"1473437579324","aux=l[[i]]","magdalena"
"1473437579328","X[diff[i],]=NA","magdalena"
"1473437579333","X[diff[i],1","magdalena"
"length(aux)]=l[[i]]","","magdalena"
"1473437579337","}","magdalena"
"1473437579343","","magdalena"
"1473437579349","MHT_rw2005=function(y_mat,treat,X,covariates,B=1000,robust=yes,names=names_data){","magdalena"
"1473437579356","","magdalena"
"1473437579362","s=ncol(y_mat)","magdalena"
"1473437579368","","magdalena"
"1473437579374","beta_hat=rep(NA,s)","magdalena"
"1473437579378","t_hat=rep(NA,s)","magdalena"
"1473437579383","reject_unadjust=rep(,s)","magdalena"
"1473437579389","for (i in 1","magdalena"
"s){","","magdalena"
"1473437579395","","magdalena"
"1473437579400","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473437579406","","magdalena"
"1473437579411","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473437579422","","magdalena"
"1473437579428","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473437579440","","magdalena"
"1473437579445","lm=lm(data_aux)","magdalena"
"1473437579452","","magdalena"
"1473437579457","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473437579465","beta_hat[i]=lm$coefficients[2]","magdalena"
"1473437579472","","magdalena"
"1473437579482","if(robust==no){","magdalena"
"1473437579489","t_hat[i]=abs(summary(lm)$coefficients[2,3])","magdalena"
"1473437579496","if(summary(lm)$coefficients[2,4]>0.1){","magdalena"
"1473437579502","reject_unadjust[i]=No","magdalena"
"1473437579507","}","magdalena"
"1473437579516","if(summary(lm)$coefficients[2,4]<=0.1){","magdalena"
"1473437579522","reject_unadjust[i]=90","magdalena"
"1473437579528","}","magdalena"
"1473437579535","if(summary(lm)$coefficients[2,4]<=0.05){","magdalena"
"1473437579540","reject_unadjust[i]=95","magdalena"
"1473437579545","}","magdalena"
"1473437579553","if(summary(lm)$coefficients[2,4]<=0.01){","magdalena"
"1473437579558","reject_unadjust[i]=99","magdalena"
"1473437579565","}","magdalena"
"1473437579570","}","magdalena"
"1473437579579","","magdalena"
"1473437579585","if(robust==yes){","magdalena"
"1473437579591","t_hat[i]=abs(ct[2,3])","magdalena"
"1473437579599","if(ct[2,4]>0.1){","magdalena"
"1473437579606","reject_unadjust[i]=No","magdalena"
"1473437579611","}","magdalena"
"1473437579620","if(ct[2,4]<=0.1){","magdalena"
"1473437579625","reject_unadjust[i]=90","magdalena"
"1473437579631","}","magdalena"
"1473437579644","if(ct[2,4]<0.05){","magdalena"
"1473437579649","reject_unadjust[i]=95","magdalena"
"1473437579655","}","magdalena"
"1473437579662","if(ct[2,4]<0.01){","magdalena"
"1473437579667","reject_unadjust[i]=99","magdalena"
"1473437579672","}","magdalena"
"1473437579680","}","magdalena"
"1473437579685","}","magdalena"
"1473437579692","","magdalena"
"1473437579699","","magdalena"
"1473437579704","beta_bs=matrix(NA,B,s)","magdalena"
"1473437579717","t_bs=matrix(NA,B,s)","magdalena"
"1473437579725","for (i in 1","magdalena"
"B){","","magdalena"
"1473437579731","","magdalena"
"1473437579736","","magdalena"
"1473437579799","","magdalena"
"1473437579805","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1473437579816","","magdalena"
"1473437579824","y_mat_bs=y_mat[id,]","magdalena"
"1473437579830","treat_bs=treat[id]","magdalena"
"1473437579840","covariates_bs=covariates[id,]","magdalena"
"1473437579851","for (k in 1","magdalena"
"s){","","magdalena"
"1473437579862","","magdalena"
"1473437579870","covariates_aux=covariates_bs[,c(X[k,!is.na(X[k,])])]","magdalena"
"1473437579882","","magdalena"
"1473437579888","data_aux=as.data.frame(cbind(y_mat_bs[,k],treat_bs,covariates_aux))","magdalena"
"1473437579920","","magdalena"
"1473437579926","names(data_aux)<-c(names_data[k],treat,X[k,!is.na(X[k,])])","magdalena"
"1473437579935","","magdalena"
"1473437579941","lm=lm(data_aux)","magdalena"
"1473437579950","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473437579975","beta_bs[i,k]=lm$coefficients[2]","magdalena"
"1473437579984","if(robust==no){","magdalena"
"1473437579990","","magdalena"
"1473437579996","","magdalena"
"1473437580003","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm)$coefficients[2,2])","magdalena"
"1473437580035","}","magdalena"
"1473437580045","if(robust==yes){","magdalena"
"1473437580052","","magdalena"
"1473437580058","","magdalena"
"1473437580064","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/ct[2,2])","magdalena"
"1473437580070","}","magdalena"
"1473437580077","}","magdalena"
"1473437580084","}","magdalena"
"1473437580093","","magdalena"
"1473437580101","alpha=c(0.95,0.975,0.995)","magdalena"
"1473437580110","","magdalena"
"1473437580116","reject_adjust=rep(,s)","magdalena"
"1473437580125","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1473437580133","t_hat_aux=t_hat","magdalena"
"1473437580139","t_bs_aux=t_bs","magdalena"
"1473437580146","done=F","magdalena"
"1473437580157","while(done==F){","magdalena"
"1473437580164","","magdalena"
"1473437580170","t_max=max(t_hat_aux)","magdalena"
"1473437580176","","magdalena"
"1473437580183","k=which(t_hat_aux==t_max)","magdalena"
"1473437580195","","magdalena"
"1473437580203","if(!is.null(dim(t_bs_aux))){","magdalena"
"1473437580212","t_bs_max=t_bs_aux[,k]","magdalena"
"1473437580219","}","magdalena"
"1473437580225","","magdalena"
"1473437580231","if(is.null(dim(t_bs_aux))){","magdalena"
"1473437580259","t_bs_max=t_bs_aux","magdalena"
"1473437580266","}","magdalena"
"1473437580274","","magdalena"
"1473437580281","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1473437580290","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1473437580297","k_orig=which(t_hat==t_max)","magdalena"
"1473437580304","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1473437580310","t_hat_aux=t_hat_aux[-k]","magdalena"
"1473437580320","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1473437580326","print(k_orig)","magdalena"
"1473437580336","}","magdalena"
"1473437580346","if(is.null(dim(t_bs_aux))){","magdalena"
"1473437580352","t_bs_max=t_bs_aux","magdalena"
"1473437580358","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1473437580365","t_max=max(t_hat_aux)","magdalena"
"1473437580371","}","magdalena"
"1473437580381","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1473437580387","if(t_max>=t_quantile){","magdalena"
"1473437580394","k_orig=which(t_hat==t_max)","magdalena"
"1473437580400","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1473437580406","}","magdalena"
"1473437580413","done=T","magdalena"
"1473437580420","}","magdalena"
"1473437580433","}","magdalena"
"1473437580440","}","magdalena"
"1473437580451","reject_adjust[reject_adjust==]=No","magdalena"
"1473437580461","","magdalena"
"1473437580467","","magdalena"
"1473437580476","return(list(beta_hat,reject_unadjust,reject_adjust))","magdalena"
"1473437580486","}","magdalena"
"1473437580498","MHT=MHT_rw2005(y_mat=y_mat,treat=treat,X=X,covariates=covariates,B=1000,robust=no,names=names_data)","magdalena"
"1473438002330","MHT","magdalena"
"1473438103016","","magdalena"
"1473438103020","","magdalena"
"1473438103024","","magdalena"
"1473438103028","","magdalena"
"1473438103032","","magdalena"
"1473438103034","","magdalena"
"1473438103034","rm(list = ls())","magdalena"
"1473438103034","","magdalena"
"1473438103034","cat(\014)","magdalena"
"1473438103049","library(lmtest)","magdalena"
"1473438103049","library(sandwich)","magdalena"
"1473438103067","","magdalena"
"1473438103071","setwd(C:\Users\Magdalena Bennett\Dropbox\PhD Columbia\Research\Romano_and_Wolf)","magdalena"
"1473438103079","","magdalena"
"1473438103089","source(MHT_rw2005.R)","magdalena"
"1473438103114","","magdalena"
"1473438103121","","magdalena"
"1473438103137","","magdalena"
"1473438103142","n = 1000","magdalena"
"1473438103149","","magdalena"
"1473438103153","s = 10","magdalena"
"1473438103166","","magdalena"
"1473438103172","beta = rep(0,s)","magdalena"
"1473438103181","beta[1]=1","magdalena"
"1473438103186","","magdalena"
"1473438103186","prob=0.7","magdalena"
"1473438103201","treat=rbinom(n,1,prob)","magdalena"
"1473438103201","","magdalena"
"1473438103217","x1=0.5+rnorm(n)","magdalena"
"1473438103217","x2=0.8+rnorm(n)","magdalena"
"1473438103234","","magdalena"
"1473438103234","for (i in 1","magdalena"
"s){","","magdalena"
"1473438103234","y=beta[i]*treat+2*x1+x2+rnorm(n)","magdalena"
"1473438103234","if (i==1){","magdalena"
"1473438103250","y_mat=y","magdalena"
"1473438103250","}","magdalena"
"1473438103250","if (i>1){","magdalena"
"1473438103250","y_mat=cbind(y_mat,y)","magdalena"
"1473438103265","}","magdalena"
"1473438103265","}","magdalena"
"1473438103265","data=cbind(y_mat,treat)","magdalena"
"1473438103281","names_data<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1473438103299","colnames(data)<-names_data","magdalena"
"1473438103306","data = as.data.frame(data)","magdalena"
"1473438103310","covariates=cbind(x1,x2)","magdalena"
"1473438103310","colnames(covariates)<-c(x1,x2)","magdalena"
"1473438103310","covariates = as.data.frame(covariates)","magdalena"
"1473438103334","","magdalena"
"1473438103334","","magdalena"
"1473438103334","k=2","magdalena"
"1473438103350","","magdalena"
"1473438103350","","magdalena"
"1473438103350","x_1=c(x1,x2)","magdalena"
"1473438103366","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473438103366","","magdalena"
"1473438103366","","magdalena"
"1473438103381","x_2=x2","magdalena"
"1473438103381","x_3=x_2","magdalena"
"1473438103381","x_10=c(x2,x1)","magdalena"
"1473438103401","","magdalena"
"1473438103401","l<-list(x_2,x_3,x_10)","magdalena"
"1473438103401","","magdalena"
"1473438103422","diff=c(2,3,10)","magdalena"
"1473438103428","","magdalena"
"1473438103432","for (i in 1","magdalena"
"length(diff)){","","magdalena"
"1473438103434","aux=l[[i]]","magdalena"
"1473438103434","X[diff[i],]=NA","magdalena"
"1473438103434","X[diff[i],1","magdalena"
"length(aux)]=l[[i]]","","magdalena"
"1473438103449","}","magdalena"
"1473438103449","","magdalena"
"1473438103449","","magdalena"
"1473438103449","","magdalena"
"1473438103465","","magdalena"
"1473438103465","","magdalena"
"1473438103465","","magdalena"
"1473438103481","MHT=MHT_rw2005(y_mat=y_mat,treat=treat,X=X,covariates=covariates,B=1000,robust=no,names=names_data)","magdalena"
"1473438103481","MHT","magdalena"
"1473438149608","","magdalena"
"1473438149613","","magdalena"
"1473438149617","","magdalena"
"1473438149622","","magdalena"
"1473438149625","","magdalena"
"1473438149631","","magdalena"
"1473438149633","rm(list = ls())","magdalena"
"1473438149633","","magdalena"
"1473438149662","cat(\014)","magdalena"
"1473438149669","library(lmtest)","magdalena"
"1473438149676","library(sandwich)","magdalena"
"1473438149685","","magdalena"
"1473438149687","setwd(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Research/Romano_and_Wolf)","magdalena"
"1473438149700","","magdalena"
"1473438149704","source(MHT_rw2005.R)","magdalena"
"1473438158600","","magdalena"
"1473438158600","","magdalena"
"1473438158600","","magdalena"
"1473438158616","n = 1000","magdalena"
"1473438158616","","magdalena"
"1473438158616","s = 10","magdalena"
"1473438158631","","magdalena"
"1473438158631","beta = rep(0,s)","magdalena"
"1473438158631","beta[1]=1","magdalena"
"1473438158652","","magdalena"
"1473438158652","prob=0.7","magdalena"
"1473438158652","treat=rbinom(n,1,prob)","magdalena"
"1473438158667","","magdalena"
"1473438158667","x1=0.5+rnorm(n)","magdalena"
"1473438158667","x2=0.8+rnorm(n)","magdalena"
"1473438158683","","magdalena"
"1473438158683","for (i in 1","magdalena"
"s){","","magdalena"
"1473438158683","y=beta[i]*treat+2*x1+x2+rnorm(n)","magdalena"
"1473438158699","if (i==1){","magdalena"
"1473438158699","y_mat=y","magdalena"
"1473438158699","}","magdalena"
"1473438158699","if (i>1){","magdalena"
"1473438158715","y_mat=cbind(y_mat,y)","magdalena"
"1473438158719","}","magdalena"
"1473438158723","}","magdalena"
"1473438158736","data=cbind(y_mat,treat)","magdalena"
"1473438158742","names_data<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1473438158756","colnames(data)<-names_data","magdalena"
"1473438158761","data = as.data.frame(data)","magdalena"
"1473438158770","covariates=cbind(x1,x2)","magdalena"
"1473438158778","colnames(covariates)<-c(x1,x2)","magdalena"
"1473438158792","covariates = as.data.frame(covariates)","magdalena"
"1473438158799","","magdalena"
"1473438158804","","magdalena"
"1473438158808","k=2","magdalena"
"1473438158816","","magdalena"
"1473438158822","","magdalena"
"1473438158827","x_1=c(x1,x2)","magdalena"
"1473438158834","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473438158850","","magdalena"
"1473438158855","","magdalena"
"1473438158859","x_2=x2","magdalena"
"1473438158865","x_3=x_2","magdalena"
"1473438158872","x_10=c(x2,x1)","magdalena"
"1473438158880","","magdalena"
"1473438158884","l<-list(x_2,x_3,x_10)","magdalena"
"1473438158891","","magdalena"
"1473438158895","diff=c(2,3,10)","magdalena"
"1473438158902","","magdalena"
"1473438158905","for (i in 1","magdalena"
"length(diff)){","","magdalena"
"1473438158909","aux=l[[i]]","magdalena"
"1473438158913","X[diff[i],]=NA","magdalena"
"1473438158916","X[diff[i],1","magdalena"
"length(aux)]=l[[i]]","","magdalena"
"1473438158919","}","magdalena"
"1473438158925","","magdalena"
"1473438158928","","magdalena"
"1473438158932","","magdalena"
"1473438158935","","magdalena"
"1473438158938","","magdalena"
"1473438158941","","magdalena"
"1473438158947","MHT=MHT_rw2005(y_mat=y_mat,treat=treat,X=X,covariates=covariates,B=1000,robust=no,names=names_data)","magdalena"
"1473438511525","MHT","magdalena"
"1473439114915","B=1000","magdalena"
"1473439120203","robust=no","magdalena"
"1473439141413","","magdalena"
"1473439141418","s=ncol(y_mat)","magdalena"
"1473439141423","","magdalena"
"1473439141423","beta_hat=rep(NA,s)","magdalena"
"1473439141439","t_hat=rep(NA,s)","magdalena"
"1473439141439","reject_unadjust=rep(,s)","magdalena"
"1473439141439","for (i in 1","magdalena"
"s){","","magdalena"
"1473439141455","","magdalena"
"1473439141455","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473439141455","","magdalena"
"1473439141455","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473439141470","","magdalena"
"1473439141470","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473439141470","","magdalena"
"1473439141470","lm=lm(data_aux)","magdalena"
"1473439141491","","magdalena"
"1473439141495","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473439141501","beta_hat[i]=lm$coefficients[2]","magdalena"
"1473439141507","","magdalena"
"1473439141512","if(robust==no){","magdalena"
"1473439141517","t_hat[i]=abs(summary(lm)$coefficients[2,3])","magdalena"
"1473439141523","if(summary(lm)$coefficients[2,4]>0.1){","magdalena"
"1473439141528","reject_unadjust[i]=No","magdalena"
"1473439141533","}","magdalena"
"1473439141539","if(summary(lm)$coefficients[2,4]<=0.1){","magdalena"
"1473439141543","reject_unadjust[i]=90","magdalena"
"1473439141547","}","magdalena"
"1473439141555","if(summary(lm)$coefficients[2,4]<=0.05){","magdalena"
"1473439141561","reject_unadjust[i]=95","magdalena"
"1473439141565","}","magdalena"
"1473439141571","if(summary(lm)$coefficients[2,4]<=0.01){","magdalena"
"1473439141575","reject_unadjust[i]=99","magdalena"
"1473439141579","}","magdalena"
"1473439141583","}","magdalena"
"1473439141589","","magdalena"
"1473439141592","if(robust==yes){","magdalena"
"1473439141596","t_hat[i]=abs(ct[2,3])","magdalena"
"1473439141601","if(ct[2,4]>0.1){","magdalena"
"1473439141605","reject_unadjust[i]=No","magdalena"
"1473439141608","}","magdalena"
"1473439141613","if(ct[2,4]<=0.1){","magdalena"
"1473439141616","reject_unadjust[i]=90","magdalena"
"1473439141621","}","magdalena"
"1473439141627","if(ct[2,4]<0.05){","magdalena"
"1473439141631","reject_unadjust[i]=95","magdalena"
"1473439141636","}","magdalena"
"1473439141642","if(ct[2,4]<0.01){","magdalena"
"1473439141646","reject_unadjust[i]=99","magdalena"
"1473439141650","}","magdalena"
"1473439141654","}","magdalena"
"1473439141657","}","magdalena"
"1473439147935","beta_hat","magdalena"
"1473439151901","reject_unadjust","magdalena"
"1473439168587","","magdalena"
"1473439168591","","magdalena"
"1473439168593","beta_bs=matrix(NA,B,s)","magdalena"
"1473439168593","t_bs=matrix(NA,B,s)","magdalena"
"1473439168609","for (i in 1","magdalena"
"B){","","magdalena"
"1473439168609","","magdalena"
"1473439168609","","magdalena"
"1473439168624","","magdalena"
"1473439168624","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1473439168624","","magdalena"
"1473439168640","y_mat_bs=y_mat[id,]","magdalena"
"1473439168644","treat_bs=treat[id]","magdalena"
"1473439168649","covariates_bs=covariates[id,]","magdalena"
"1473439168654","for (k in 1","magdalena"
"s){","","magdalena"
"1473439168660","","magdalena"
"1473439168661","covariates_aux=covariates_bs[,c(X[k,!is.na(X[k,])])]","magdalena"
"1473439168661","","magdalena"
"1473439168661","data_aux=as.data.frame(cbind(y_mat_bs[,k],treat_bs,covariates_aux))","magdalena"
"1473439168661","","magdalena"
"1473439168678","names(data_aux)<-c(names_data[k],treat,X[k,!is.na(X[k,])])","magdalena"
"1473439168684","","magdalena"
"1473439168688","lm=lm(data_aux)","magdalena"
"1473439168692","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473439168693","beta_bs[i,k]=lm$coefficients[2]","magdalena"
"1473439168693","if(robust==no){","magdalena"
"1473439168693","","magdalena"
"1473439168693","","magdalena"
"1473439168693","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm)$coefficients[2,2])","magdalena"
"1473439168709","}","magdalena"
"1473439168709","if(robust==yes){","magdalena"
"1473439168709","","magdalena"
"1473439168724","","magdalena"
"1473439168724","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/ct[2,2])","magdalena"
"1473439168724","}","magdalena"
"1473439168740","}","magdalena"
"1473439168749","}","magdalena"
"1473441780794","reject_unadjust","magdalena"
"1473441787252","","magdalena"
"1473441787257","alpha=c(0.95,0.975,0.995)","magdalena"
"1473441787265","","magdalena"
"1473441787269","reject_adjust=rep(,s)","magdalena"
"1473441793329","a=1","magdalena"
"1473441798115","t_hat_aux=t_hat","magdalena"
"1473441798127","t_bs_aux=t_bs","magdalena"
"1473441798143","done=F","magdalena"
"1473441804499","","magdalena"
"1473441804503","t_max=max(t_hat_aux)","magdalena"
"1473441804508","","magdalena"
"1473441804512","k=which(t_hat_aux==t_max)","magdalena"
"1473441807732","t_max","magdalena"
"1473441808754","k","magdalena"
"1473441831332","","magdalena"
"1473441831332","if(!is.null(dim(t_bs_aux))){","magdalena"
"1473441831332","t_bs_max=t_bs_aux[,k]","magdalena"
"1473441831332","}","magdalena"
"1473441831350","","magdalena"
"1473441831350","if(is.null(dim(t_bs_aux))){","magdalena"
"1473441831350","t_bs_max=t_bs_aux","magdalena"
"1473441831366","}","magdalena"
"1473441831372","","magdalena"
"1473441831372","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1473441831387","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1473441831387","k_orig=which(t_hat==t_max)","magdalena"
"1473441831403","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1473441831403","t_hat_aux=t_hat_aux[-k]","magdalena"
"1473441831403","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1473441831403","print(k_orig)","magdalena"
"1473441831403","}","magdalena"
"1473441831418","if(is.null(dim(t_bs_aux))){","magdalena"
"1473441831418","t_bs_max=t_bs_aux","magdalena"
"1473441831418","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1473441831438","t_max=max(t_hat_aux)","magdalena"
"1473441831443","}","magdalena"
"1473441831448","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1473441831450","if(t_max>=t_quantile){","magdalena"
"1473441831450","k_orig=which(t_hat==t_max)","magdalena"
"1473441831450","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1473441831450","}","magdalena"
"1473441835249","}","magdalena"
"1473441841925","reject_adjust","magdalena"
"1473441879643","","magdalena"
"1473441879648","","magdalena"
"1473441879652","","magdalena"
"1473441879657","","magdalena"
"1473441879661","","magdalena"
"1473441879667","","magdalena"
"1473441879671","rm(list = ls())","magdalena"
"1473441879692","","magdalena"
"1473441879697","cat(\014)","magdalena"
"1473441879704","library(lmtest)","magdalena"
"1473441879713","library(sandwich)","magdalena"
"1473441879722","","magdalena"
"1473441879726","setwd(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Research/Romano_and_Wolf)","magdalena"
"1473441879734","","magdalena"
"1473441879738","source(MHT_rw2005.R)","magdalena"
"1473441879762","","magdalena"
"1473441879767","","magdalena"
"1473441879772","","magdalena"
"1473441879776","n = 1000","magdalena"
"1473441879783","","magdalena"
"1473441879787","s = 10","magdalena"
"1473441879803","","magdalena"
"1473441879808","beta = rep(0,s)","magdalena"
"1473441879815","beta[1]=1","magdalena"
"1473441879823","","magdalena"
"1473441879827","prob=0.3","magdalena"
"1473441879836","treat=rbinom(n,1,prob)","magdalena"
"1473441879846","","magdalena"
"1473441879850","x1=0.5+rnorm(n)","magdalena"
"1473441879857","x2=0.8+rnorm(n)","magdalena"
"1473441879867","","magdalena"
"1473441879872","for (i in 1","magdalena"
"s){","","magdalena"
"1473441879876","y=beta[i]*treat+2*x1+x2+rnorm(n)","magdalena"
"1473441879882","if (i==1){","magdalena"
"1473441879886","y_mat=y","magdalena"
"1473441879890","}","magdalena"
"1473441879894","if (i>1){","magdalena"
"1473441879899","y_mat=cbind(y_mat,y)","magdalena"
"1473441879911","}","magdalena"
"1473441879919","}","magdalena"
"1473441879957","data=cbind(y_mat,treat)","magdalena"
"1473441879986","","magdalena"
"1473441879991","names_data<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1473441879998","colnames(data)<-names_data","magdalena"
"1473441880004","data = as.data.frame(data)","magdalena"
"1473441880012","covariates=cbind(x1,x2)","magdalena"
"1473441880023","colnames(covariates)<-c(x1,x2)","magdalena"
"1473441880030","covariates = as.data.frame(covariates)","magdalena"
"1473441880046","","magdalena"
"1473441880051","","magdalena"
"1473441880063","k=2","magdalena"
"1473441880071","","magdalena"
"1473441880076","","magdalena"
"1473441880080","x_1=c(x1,x2)","magdalena"
"1473441880088","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473441880096","","magdalena"
"1473441880102","","magdalena"
"1473441880106","x_2=x2","magdalena"
"1473441880112","x_3=x_2","magdalena"
"1473441880119","x_10=c(x2,x1)","magdalena"
"1473441880128","","magdalena"
"1473441880132","l<-list(x_2,x_3,x_10)","magdalena"
"1473441880147","","magdalena"
"1473441880152","diff=c(2,3,10)","magdalena"
"1473441880161","","magdalena"
"1473441880167","for (i in 1","magdalena"
"length(diff)){","","magdalena"
"1473441880172","aux=l[[i]]","magdalena"
"1473441880176","X[diff[i],]=NA","magdalena"
"1473441880181","X[diff[i],1","magdalena"
"length(aux)]=l[[i]]","","magdalena"
"1473441880185","}","magdalena"
"1473441880203","","magdalena"
"1473441880208","","magdalena"
"1473441880212","","magdalena"
"1473441880217","","magdalena"
"1473441880222","","magdalena"
"1473441880227","","magdalena"
"1473441880232","","magdalena"
"1473441880236","MHT=MHT_rw2005(y_mat=y_mat,treat=treat,X=X,covariates=covariates,B=1000,robust=no,names=names_data)","magdalena"
"1473442306018","MHT","magdalena"
"1473442682387","reject_90_u=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473442682387","reject_90_a=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473442682403","reject_95_u=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473442682403","reject_95_a=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473442682418","reject_99_u=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473442682434","reject_99_a=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473442689444","n_sim=500","magdalena"
"1473442689452","reject_90_u=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473442689459","reject_90_a=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473442689466","reject_95_u=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473442689472","reject_95_a=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473442689480","reject_99_u=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473442689498","reject_99_a=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473442696580","i=1","magdalena"
"1473442703866","reject_90_u[i,reject_unadjust==90]=1","magdalena"
"1473442724239","reject_unadjust=MHT$reject_unadjust","magdalena"
"1473442738407","reject_90_u[i,MHT$reject_unadjust==90]=1","magdalena"
"1473442749616","reject_90_u[1,]","magdalena"
"1473442765154","MHT$reject_unadjust","magdalena"
"1473442797855","reject_90_u[i,MHT$reject_unadjust==90 | MHT$reject_unadjust==95 | MHT$reject_unadjust==99]=1","magdalena"
"1473442801471","reject_90_u[1,]","magdalena"
"1473442845279","reject_95_u[i,MHT$reject_unadjust==95 | MHT$reject_unadjust==99]=1","magdalena"
"1473442845286","reject_95_a[i,MHT$reject_adjust==95 | MHT$reject_adjust==99]=1","magdalena"
"1473442851447","reject_90_a","magdalena"
"1473442854968","reject_90_a[1,]","magdalena"
"1473442870296","MHT$reject_adjust","magdalena"
"1473442905584","reject_95_u[1,]","magdalena"
"1473533317452","","magdalena"
"1473533317460","","magdalena"
"1473533317467","","magdalena"
"1473533317473","","magdalena"
"1473533317478","","magdalena"
"1473533317483","","magdalena"
"1473533317487","rm(list = ls())","magdalena"
"1473533317495","","magdalena"
"1473533317499","cat(\014)","magdalena"
"1473533317506","library(lmtest)","magdalena"
"1473533318697","library(sandwich)","magdalena"
"1473533318834","","magdalena"
"1473533318839","setwd(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Research/Romano_and_Wolf)","magdalena"
"1473533329907","load(simulation.RData)","magdalena"
"1473533347585","dim(reject_90_a)","magdalena"
"1473533359743","mean(reject_90_a[,1])","magdalena"
"1473533364802","mean(reject_90_u[,1])","magdalena"
"1473533376932","mean(reject_95_u[,1])","magdalena"
"1473533382638","mean(reject_95_a[,1])","magdalena"
"1473533387339","mean(reject_99_a[,1])","magdalena"
"1473533393777","mean(reject_99_u[,1])","magdalena"
"1473533417806","mean(reject_90_a[,2])","magdalena"
"1473533509680","","magdalena"
"1473533509685","","magdalena"
"1473533509689","","magdalena"
"1473533509694","","magdalena"
"1473533509699","","magdalena"
"1473533509704","","magdalena"
"1473533509708","rm(list = ls())","magdalena"
"1473533509714","","magdalena"
"1473533509718","cat(\014)","magdalena"
"1473533509724","library(lmtest)","magdalena"
"1473533509732","library(sandwich)","magdalena"
"1473533509740","","magdalena"
"1473533509746","setwd(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Research/Romano_and_Wolf)","magdalena"
"1473533509753","","magdalena"
"1473533509759","source(MHT_rw2005.R)","magdalena"
"1473533509782","","magdalena"
"1473533509788","","magdalena"
"1473533509801","","magdalena"
"1473533509805","","magdalena"
"1473533509811","","magdalena"
"1473533509817","","magdalena"
"1473533509823","","magdalena"
"1473533509827","n_sim=500","magdalena"
"1473533509836","reject_90_u=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473533509842","reject_90_a=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473533509848","reject_95_u=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473533509853","reject_95_a=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473533509857","reject_99_u=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473533509862","reject_99_a=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473533529184","","magdalena"
"1473533529189","","magdalena"
"1473533529193","","magdalena"
"1473533529199","","magdalena"
"1473533529203","","magdalena"
"1473533529209","","magdalena"
"1473533529215","rm(list = ls())","magdalena"
"1473533529223","","magdalena"
"1473533529227","cat(\014)","magdalena"
"1473533529234","library(lmtest)","magdalena"
"1473533529240","library(sandwich)","magdalena"
"1473533529248","","magdalena"
"1473533529252","setwd(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Research/Romano_and_Wolf)","magdalena"
"1473533529260","","magdalena"
"1473533529265","source(MHT_rw2005.R)","magdalena"
"1473533529282","","magdalena"
"1473533529289","","magdalena"
"1473533529295","","magdalena"
"1473533529303","","magdalena"
"1473533529309","","magdalena"
"1473533529315","","magdalena"
"1473533529326","","magdalena"
"1473533529331","n_sim=500","magdalena"
"1473533529337","s=10","magdalena"
"1473533529342","reject_90_u=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473533529347","reject_90_a=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473533529351","reject_95_u=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473533529355","reject_95_a=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473533529360","reject_99_u=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473533529365","reject_99_a=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473533537113","i=1","magdalena"
"1473533570885","","magdalena"
"1473533570890","","magdalena"
"1473533570896","","magdalena"
"1473533570901","n = 1000","magdalena"
"1473533570907","","magdalena"
"1473533570912","s = 10","magdalena"
"1473533570919","","magdalena"
"1473533570923","beta = rep(0,s)","magdalena"
"1473533570928","beta[1]=1","magdalena"
"1473533570938","","magdalena"
"1473533570942","prob=0.3","magdalena"
"1473533570948","treat=rbinom(n,1,prob)","magdalena"
"1473533570957","","magdalena"
"1473533570962","x1=0.5+rnorm(n)","magdalena"
"1473533570969","x2=0.8+rnorm(n)","magdalena"
"1473533570976","","magdalena"
"1473533590492","for (i in 1","magdalena"
"s){","","magdalena"
"1473533590497","y=beta[i]*treat+2*x1+x2+rnorm(n)","magdalena"
"1473533590502","if (i==1){","magdalena"
"1473533590505","y_mat=y","magdalena"
"1473533590509","}","magdalena"
"1473533590512","if (i>1){","magdalena"
"1473533590516","y_mat=cbind(y_mat,y)","magdalena"
"1473533590520","}","magdalena"
"1473533590523","}","magdalena"
"1473533590537","data=cbind(y_mat,treat)","magdalena"
"1473533590545","","magdalena"
"1473533590553","names_data<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1473533590559","colnames(data)<-names_data","magdalena"
"1473533590564","data = as.data.frame(data)","magdalena"
"1473533590572","covariates=cbind(x1,x2)","magdalena"
"1473533590577","colnames(covariates)<-c(x1,x2)","magdalena"
"1473533590583","covariates = as.data.frame(covariates)","magdalena"
"1473533590590","","magdalena"
"1473533590594","","magdalena"
"1473533590599","k=2","magdalena"
"1473533590604","","magdalena"
"1473533590609","","magdalena"
"1473533590613","x_1=c(x1,x2)","magdalena"
"1473533590620","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473533590625","","magdalena"
"1473533590630","","magdalena"
"1473533590633","x_2=x2","magdalena"
"1473533590637","x_3=x_2","magdalena"
"1473533590642","x_10=c(x2,x1)","magdalena"
"1473533590647","","magdalena"
"1473533590650","l<-list(x_2,x_3,x_10)","magdalena"
"1473533590657","","magdalena"
"1473533590663","diff=c(2,3,10)","magdalena"
"1473533590682","","magdalena"
"1473533590687","for (i in 1","magdalena"
"length(diff)){","","magdalena"
"1473533590692","aux=l[[i]]","magdalena"
"1473533590696","X[diff[i],]=NA","magdalena"
"1473533590701","X[diff[i],1","magdalena"
"length(aux)]=l[[i]]","","magdalena"
"1473533590707","}","magdalena"
"1473533590714","MHT=MHT_rw2005(y_mat=y_mat,treat=treat,X=X,covariates=covariates,B=1000,robust=no,names=names_data)","magdalena"
"1473533772488","","magdalena"
"1473533772493","","magdalena"
"1473533772497","","magdalena"
"1473533772503","","magdalena"
"1473533772507","","magdalena"
"1473533772513","","magdalena"
"1473533772517","rm(list = ls())","magdalena"
"1473533772524","","magdalena"
"1473533772529","cat(\014)","magdalena"
"1473533772535","library(lmtest)","magdalena"
"1473533772542","library(sandwich)","magdalena"
"1473533772549","","magdalena"
"1473533772556","setwd(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Research/Romano_and_Wolf)","magdalena"
"1473533772563","","magdalena"
"1473533772568","source(MHT_rw2005.R)","magdalena"
"1473533772577","","magdalena"
"1473533772593","","magdalena"
"1473533772593","","magdalena"
"1473533772593","","magdalena"
"1473533772609","","magdalena"
"1473533772609","","magdalena"
"1473533772609","","magdalena"
"1473533772624","n_sim=500","magdalena"
"1473533772624","s=10","magdalena"
"1473533772624","reject_90_u=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473533772641","reject_90_a=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473533772645","reject_95_u=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473533772650","reject_95_a=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473533772656","reject_99_u=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473533772661","reject_99_a=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473533781671","j=1","magdalena"
"1473533791997","","magdalena"
"1473533792001","","magdalena"
"1473533792003","","magdalena"
"1473533792003","n = 1000","magdalena"
"1473533792003","","magdalena"
"1473533792019","s = 10","magdalena"
"1473533792019","","magdalena"
"1473533792019","beta = rep(0,s)","magdalena"
"1473533792034","beta[1]=1","magdalena"
"1473533792041","","magdalena"
"1473533792045","prob=0.3","magdalena"
"1473533792049","treat=rbinom(n,1,prob)","magdalena"
"1473533792057","","magdalena"
"1473533792061","x1=0.5+rnorm(n)","magdalena"
"1473533792067","x2=0.8+rnorm(n)","magdalena"
"1473533792073","","magdalena"
"1473533792079","for (i in 1","magdalena"
"s){","","magdalena"
"1473533792084","y=beta[i]*treat+2*x1+x2+rnorm(n)","magdalena"
"1473533792092","if (i==1){","magdalena"
"1473533792097","y_mat=y","magdalena"
"1473533792102","}","magdalena"
"1473533792107","if (i>1){","magdalena"
"1473533792112","y_mat=cbind(y_mat,y)","magdalena"
"1473533792117","}","magdalena"
"1473533792122","}","magdalena"
"1473533792136","data=cbind(y_mat,treat)","magdalena"
"1473533792143","","magdalena"
"1473533792148","names_data<-c(y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,treat)","magdalena"
"1473533792154","colnames(data)<-names_data","magdalena"
"1473533792159","data = as.data.frame(data)","magdalena"
"1473533792167","covariates=cbind(x1,x2)","magdalena"
"1473533792173","colnames(covariates)<-c(x1,x2)","magdalena"
"1473533792178","covariates = as.data.frame(covariates)","magdalena"
"1473533792186","","magdalena"
"1473533792193","","magdalena"
"1473533792198","k=2","magdalena"
"1473533792204","","magdalena"
"1473533792210","","magdalena"
"1473533792214","x_1=c(x1,x2)","magdalena"
"1473533792219","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473533792224","","magdalena"
"1473533792228","","magdalena"
"1473533792232","x_2=x2","magdalena"
"1473533792238","x_3=x_2","magdalena"
"1473533792245","x_10=c(x2,x1)","magdalena"
"1473533792252","","magdalena"
"1473533792257","l<-list(x_2,x_3,x_10)","magdalena"
"1473533792263","","magdalena"
"1473533792268","diff=c(2,3,10)","magdalena"
"1473533792274","","magdalena"
"1473533792278","for (d in 1","magdalena"
"length(diff)){","","magdalena"
"1473533792283","aux=l[[d]]","magdalena"
"1473533792288","X[diff[d],]=NA","magdalena"
"1473533792293","X[diff[d],1","magdalena"
"length(aux)]=l[[d]]","","magdalena"
"1473533792297","}","magdalena"
"1473533792303","MHT=MHT_rw2005(y_mat=y_mat,treat=treat,X=X,covariates=covariates,B=1000,robust=no,names=names_data)","magdalena"
"1473534251720","MHT$reject_unadjust","magdalena"
"1473534256621","MHT$reject_adjust","magdalena"
"1473534266876","for(k in 1","magdalena"
"s){","","magdalena"
"1473534266881","if(MHT$reject_unadjust[k]==90 | MHT$reject_unadjust[k]==95 | MHT$reject_unadjust[k]==99){","magdalena"
"1473534266886","reject_90_u[j,k]=1","magdalena"
"1473534266890","}","magdalena"
"1473534266896","if(MHT$reject_adjust[k]==90 | MHT$reject_adjust[k]==95 | MHT$reject_adjust[k]==99){","magdalena"
"1473534266901","reject_90_a[j,k]=1","magdalena"
"1473534266906","}","magdalena"
"1473534266912","if(MHT$reject_unadjust[k]==95 | MHT$reject_unadjust[k]==99){","magdalena"
"1473534266917","reject_95_u[j,k]=1","magdalena"
"1473534266921","}","magdalena"
"1473534266928","if(MHT$reject_adjust[k]==95 | MHT$reject_adjust[k]==99){","magdalena"
"1473534266946","reject_95_a[j,k]=1","magdalena"
"1473534266952","}","magdalena"
"1473534266959","if(MHT$reject_unadjust[k]==99){","magdalena"
"1473534266963","reject_99_u[j,k]=1","magdalena"
"1473534266968","}","magdalena"
"1473534266975","if(MHT$reject_adjust[k]==99){","magdalena"
"1473534266980","reject_99_a[j,k]=1","magdalena"
"1473534266985","}","magdalena"
"1473534276763","}","magdalena"
"1473534285890","reject_90_a[1,]","magdalena"
"1473534291086","reject_90_u[1,]","magdalena"
"1473534294306","reject_95_u[1,]","magdalena"
"1473534297578","reject_95_a[1,]","magdalena"
"1473534300662","reject_99_a[1,]","magdalena"
"1473534303423","reject_99_u[1,]","magdalena"
"1473645359802","","magdalena"
"1473645359814","","magdalena"
"1473645359818","","magdalena"
"1473645359824","","magdalena"
"1473645359828","","magdalena"
"1473645359833","","magdalena"
"1473645359838","rm(list = ls())","magdalena"
"1473645359846","","magdalena"
"1473645359853","cat(\014)","magdalena"
"1473645361127","library(lmtest)","magdalena"
"1473645364309","library(sandwich)","magdalena"
"1473645365095","","magdalena"
"1473645365100","setwd(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Research/Romano_and_Wolf)","magdalena"
"1473645386761","load(simulation.RData)","magdalena"
"1473645396083","mean(reject_90_a[,1])","magdalena"
"1473645403000","mean(reject_90_u[,1])","magdalena"
"1473645406346","mean(reject_90_a[,2])","magdalena"
"1473645410209","mean(reject_90_u[,2])","magdalena"
"1473645418070","mean(reject_90_a[,3])","magdalena"
"1473645421653","mean(reject_90_a[,4])","magdalena"
"1473645425124","mean(reject_90_a[,5])","magdalena"
"1473645427705","mean(reject_90_a[,6])","magdalena"
"1473645430515","mean(reject_90_a[,7])","magdalena"
"1473645433060","mean(reject_90_a[,8])","magdalena"
"1473645435917","mean(reject_90_a[,9])","magdalena"
"1473645438763","mean(reject_90_a[,10])","magdalena"
"1473645476346","help(apply)","magdalena"
"1473645571834","perc_reject_90_u=apply(reject_90_u,MARGIN = 2,FUN=mean)","magdalena"
"1473645577644","perc_reject_90_u","magdalena"
"1473645614363","perc_reject_90_u=apply(reject_90_u,MARGIN = 2,FUN=mean)","magdalena"
"1473645614370","perc_reject_95_u=apply(reject_95_u,MARGIN = 2,FUN=mean)","magdalena"
"1473645614376","perc_reject_99_u=apply(reject_99_u,MARGIN = 2,FUN=mean)","magdalena"
"1473645614384","perc_reject_90_a=apply(reject_90_a,MARGIN = 2,FUN=mean)","magdalena"
"1473645614391","perc_reject_95_a=apply(reject_95_a,MARGIN = 2,FUN=mean)","magdalena"
"1473645614399","perc_reject_99_u=apply(reject_99_a,MARGIN = 2,FUN=mean)","magdalena"
"1473645621328","perc_reject_90_u","magdalena"
"1473645632687","perc_reject_90_a","magdalena"
"1473645643892","perc_reject_95_u","magdalena"
"1473645650004","perc_reject_95_a","magdalena"
"1473645667890","perc_reject_99_u","magdalena"
"1473645676754","perc_reject_99_a","magdalena"
"1473645689513","perc_reject_99_u=apply(reject_99_u,MARGIN = 2,FUN=mean)","magdalena"
"1473645689522","perc_reject_90_a=apply(reject_90_a,MARGIN = 2,FUN=mean)","magdalena"
"1473645689529","perc_reject_95_a=apply(reject_95_a,MARGIN = 2,FUN=mean)","magdalena"
"1473645689536","perc_reject_99_a=apply(reject_99_a,MARGIN = 2,FUN=mean)","magdalena"
"1473645694596","perc_reject_99_u","magdalena"
"1473645701363","perc_reject_99_a","magdalena"
"1473699355604","pwd","magdalena"
"1473699386501","getwd()","magdalena"
"1473700165889","MHT_rw2005=function(y_mat,treat,X,covariates,B=1000,robust,names=names_data){","magdalena"
"1473700165894","","magdalena"
"1473700165898","s=ncol(y_mat)","magdalena"
"1473700165902","","magdalena"
"1473700165906","beta_hat=rep(NA,s)","magdalena"
"1473700165910","t_hat=rep(NA,s)","magdalena"
"1473700165915","reject_unadjust=rep(,s)","magdalena"
"1473700165919","for (i in 1","magdalena"
"s){","","magdalena"
"1473700165925","","magdalena"
"1473700165930","covariates_aux=covariates[,c(X[i,!is.na(X[i,])])]","magdalena"
"1473700165936","","magdalena"
"1473700165940","data_aux=as.data.frame(cbind(y_mat[,i],treat,covariates_aux))","magdalena"
"1473700165945","","magdalena"
"1473700165950","names(data_aux)<-c(names_data[i],treat,X[i,!is.na(X[i,])])","magdalena"
"1473700165955","","magdalena"
"1473700165959","lm=lm(data_aux)","magdalena"
"1473700165965","","magdalena"
"1473700165970","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473700165975","beta_hat[i]=lm$coefficients[2]","magdalena"
"1473700165981","","magdalena"
"1473700165986","if(robust==no){","magdalena"
"1473700165991","t_hat[i]=abs(summary(lm)$coefficients[2,3])","magdalena"
"1473700165997","if(summary(lm)$coefficients[2,4]>0.1){","magdalena"
"1473700166002","reject_unadjust[i]=No","magdalena"
"1473700166007","}","magdalena"
"1473700166014","if(summary(lm)$coefficients[2,4]<=0.1){","magdalena"
"1473700166019","reject_unadjust[i]=90","magdalena"
"1473700166023","}","magdalena"
"1473700166028","if(summary(lm)$coefficients[2,4]<=0.05){","magdalena"
"1473700166031","reject_unadjust[i]=95","magdalena"
"1473700166035","}","magdalena"
"1473700166040","if(summary(lm)$coefficients[2,4]<=0.01){","magdalena"
"1473700166044","reject_unadjust[i]=99","magdalena"
"1473700166048","}","magdalena"
"1473700166052","}","magdalena"
"1473700166058","","magdalena"
"1473700166063","if(robust==yes){","magdalena"
"1473700166069","t_hat[i]=abs(ct[2,3])","magdalena"
"1473700166076","if(ct[2,4]>0.1){","magdalena"
"1473700166082","reject_unadjust[i]=No","magdalena"
"1473700166088","}","magdalena"
"1473700166096","if(ct[2,4]<=0.1){","magdalena"
"1473700166101","reject_unadjust[i]=90","magdalena"
"1473700166106","}","magdalena"
"1473700166114","if(ct[2,4]<0.05){","magdalena"
"1473700166119","reject_unadjust[i]=95","magdalena"
"1473700166125","}","magdalena"
"1473700166133","if(ct[2,4]<0.01){","magdalena"
"1473700166138","reject_unadjust[i]=99","magdalena"
"1473700166144","}","magdalena"
"1473700166149","}","magdalena"
"1473700166154","}","magdalena"
"1473700166161","","magdalena"
"1473700166169","","magdalena"
"1473700166174","beta_bs=matrix(NA,B,s)","magdalena"
"1473700166178","t_bs=matrix(NA,B,s)","magdalena"
"1473700166185","for (i in 1","magdalena"
"B){","","magdalena"
"1473700166190","","magdalena"
"1473700166196","","magdalena"
"1473700166204","","magdalena"
"1473700166209","id=sample(seq(1","magdalena"
"n),n,replace=T)","","magdalena"
"1473700166217","","magdalena"
"1473700166222","y_mat_bs=y_mat[id,]","magdalena"
"1473700166231","treat_bs=treat[id]","magdalena"
"1473700166240","covariates_bs=covariates[id,]","magdalena"
"1473700166248","for (k in 1","magdalena"
"s){","","magdalena"
"1473700166256","","magdalena"
"1473700166262","covariates_aux=covariates_bs[,c(X[k,!is.na(X[k,])])]","magdalena"
"1473700166271","","magdalena"
"1473700166277","data_aux=as.data.frame(cbind(y_mat_bs[,k],treat_bs,covariates_aux))","magdalena"
"1473700166283","","magdalena"
"1473700166289","names(data_aux)<-c(names_data[k],treat,X[k,!is.na(X[k,])])","magdalena"
"1473700166297","","magdalena"
"1473700166304","lm=lm(data_aux)","magdalena"
"1473700166313","ct=coeftest(lm, vcov = vcovHC(lm, HC1))","magdalena"
"1473700166322","beta_bs[i,k]=lm$coefficients[2]","magdalena"
"1473700166331","if(robust==no){","magdalena"
"1473700166337","","magdalena"
"1473700166343","","magdalena"
"1473700166349","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/summary(lm)$coefficients[2,2])","magdalena"
"1473700166355","}","magdalena"
"1473700166363","if(robust==yes){","magdalena"
"1473700166369","","magdalena"
"1473700166376","","magdalena"
"1473700166382","t_bs[i,k]=abs((beta_bs[i,k]-beta_hat[k])/ct[2,2])","magdalena"
"1473700166388","}","magdalena"
"1473700166393","}","magdalena"
"1473700166399","}","magdalena"
"1473700166407","","magdalena"
"1473700166415","alpha=c(0.95,0.975,0.995)","magdalena"
"1473700166424","","magdalena"
"1473700166429","reject_adjust=rep(,s)","magdalena"
"1473700166435","for (a in 1","magdalena"
"length(alpha)){","","magdalena"
"1473700166442","t_hat_aux=t_hat","magdalena"
"1473700166447","t_bs_aux=t_bs","magdalena"
"1473700166451","done=F","magdalena"
"1473700166458","while(done==F){","magdalena"
"1473700166462","","magdalena"
"1473700166466","t_max=max(t_hat_aux)","magdalena"
"1473700166471","","magdalena"
"1473700166475","k=which(t_hat_aux==t_max)","magdalena"
"1473700166482","","magdalena"
"1473700166488","if(!is.null(dim(t_bs_aux))){","magdalena"
"1473700166495","t_bs_max=t_bs_aux[,k]","magdalena"
"1473700166504","}","magdalena"
"1473700166512","","magdalena"
"1473700166518","if(is.null(dim(t_bs_aux))){","magdalena"
"1473700166525","t_bs_max=t_bs_aux","magdalena"
"1473700166531","}","magdalena"
"1473700166538","","magdalena"
"1473700166542","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1473700166549","if(t_max>=t_quantile & !is.null(dim(t_bs_aux))){","magdalena"
"1473700166556","k_orig=which(t_hat==t_max)","magdalena"
"1473700166562","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1473700166569","t_hat_aux=t_hat_aux[-k]","magdalena"
"1473700166573","t_bs_aux=t_bs_aux[,-k]","magdalena"
"1473700166579","print(k_orig)","magdalena"
"1473700166584","}","magdalena"
"1473700166593","if(is.null(dim(t_bs_aux))){","magdalena"
"1473700166599","t_bs_max=t_bs_aux","magdalena"
"1473700166605","t_quantile=quantile(t_bs_max,alpha[a],na.rm=F)","magdalena"
"1473700166610","t_max=max(t_hat_aux)","magdalena"
"1473700166617","}","magdalena"
"1473700166627","if(t_max<t_quantile | is.null(dim(t_bs_aux))){","magdalena"
"1473700166635","if(t_max>=t_quantile){","magdalena"
"1473700166642","k_orig=which(t_hat==t_max)","magdalena"
"1473700166648","reject_adjust[k_orig]=alpha[a]*100-(1-alpha[a])*100","magdalena"
"1473700166655","}","magdalena"
"1473700166661","done=T","magdalena"
"1473700166668","}","magdalena"
"1473700166675","}","magdalena"
"1473700166681","}","magdalena"
"1473700166691","reject_adjust[reject_adjust==]=No","magdalena"
"1473700166699","","magdalena"
"1473700166706","","magdalena"
"1473700166717","outcome=list(beta_hat,reject_unadjust,reject_adjust)","magdalena"
"1473700166724","names(outcome)=c(beta_hat,reject_unadjust,reject_adjust)","magdalena"
"1473700166735","return(outcome)","magdalena"
"1473700166745","}","magdalena"
"1473777227919","","magdalena"
"1473777227926","","magdalena"
"1473777227930","","magdalena"
"1473777227936","","magdalena"
"1473777227941","","magdalena"
"1473777227947","","magdalena"
"1473777227955","rm(list = ls())","magdalena"
"1473777227967","","magdalena"
"1473777227974","cat(\014)","magdalena"
"1473777227984","library(lmtest)","magdalena"
"1473777228677","library(sandwich)","magdalena"
"1473777228765","","magdalena"
"1473777228765","setwd(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Research/Romano_and_Wolf)","magdalena"
"1473777228765","","magdalena"
"1473777228784","source(MHT_rw2005.R)","magdalena"
"1473777228794","","magdalena"
"1473777228809","","magdalena"
"1473777228809","","magdalena"
"1473777228809","","magdalena"
"1473777228825","","magdalena"
"1473777228825","","magdalena"
"1473777228825","","magdalena"
"1473777228825","n_sim=500","magdalena"
"1473777228841","s=10","magdalena"
"1473777228841","reject_90_u=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473777228856","reject_90_a=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473777228856","reject_95_u=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473777228856","reject_95_a=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473777228856","reject_99_u=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473777228872","reject_99_a=matrix(0,ncol=s,nrow=n_sim)","magdalena"
"1473777280899","load(simulation.RData)","magdalena"
"1473777280915","perc_reject_90_u=apply(reject_90_u,MARGIN = 2,FUN=sum)/n_sim","magdalena"
"1473777280921","perc_reject_95_u=apply(reject_95_u,MARGIN = 2,FUN=sum)/n_sim","magdalena"
"1473777280927","perc_reject_99_u=apply(reject_99_u,MARGIN = 2,FUN=sum)/n_sim","magdalena"
"1473777280935","perc_reject_90_a=apply(reject_90_a,MARGIN = 2,FUN=sum)/n_sim","magdalena"
"1473777280941","perc_reject_95_a=apply(reject_95_a,MARGIN = 2,FUN=sum)/n_sim","magdalena"
"1473777280947","perc_reject_99_a=apply(reject_99_a,MARGIN = 2,FUN=sum)/n_sim","magdalena"
"1473777312899","perc_reject_90_u","magdalena"
"1473777312907","perc_reject_95_u","magdalena"
"1473777312914","perc_reject_99_u","magdalena"
"1473777312922","perc_reject_90_a","magdalena"
"1473777312928","perc_reject_95_a","magdalena"
"1473777312935","perc_reject_99_a","magdalena"
"1473777339498","load(simulationv2.RData)","magdalena"
"1473777339512","perc_reject_90_u=apply(reject_90_u,MARGIN = 2,FUN=sum)/n_sim","magdalena"
"1473777339519","perc_reject_95_u=apply(reject_95_u,MARGIN = 2,FUN=sum)/n_sim","magdalena"
"1473777339525","perc_reject_99_u=apply(reject_99_u,MARGIN = 2,FUN=sum)/n_sim","magdalena"
"1473777339532","perc_reject_90_a=apply(reject_90_a,MARGIN = 2,FUN=sum)/n_sim","magdalena"
"1473777339539","perc_reject_95_a=apply(reject_95_a,MARGIN = 2,FUN=sum)/n_sim","magdalena"
"1473777339545","perc_reject_99_a=apply(reject_99_a,MARGIN = 2,FUN=sum)/n_sim","magdalena"
"1473777339553","perc_reject_90_u","magdalena"
"1473777339560","perc_reject_95_u","magdalena"
"1473777339567","perc_reject_99_u","magdalena"
"1473777339575","perc_reject_90_a","magdalena"
"1473777339583","perc_reject_95_a","magdalena"
"1473777339589","perc_reject_99_a","magdalena"
"1473968268857","setwd(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Research/Romano_and_Wolf)","magdalena"
"1473968281045","","magdalena"
"1473968281049","","magdalena"
"1473968281052","","magdalena"
"1473968281056","","magdalena"
"1473968281059","","magdalena"
"1473968281064","","magdalena"
"1473968281067","rm(list = ls())","magdalena"
"1473968281074","","magdalena"
"1473968281078","cat(\014)","magdalena"
"1473968281084","install.packages(lmtest)","magdalena"
"1473968297930","install.packages(sandwich)","magdalena"
"1473968311376","library(lmtest)","magdalena"
"1473968312494","library(sandwich)","magdalena"
"1473968312586","","magdalena"
"1473968312591","setwd(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Research/Romano_and_Wolf)","magdalena"
"1473968312599","","magdalena"
"1473968312604","source(MHT_rw2005.R)","magdalena"
"1473968356464","","magdalena"
"1473968356469","n = 1000","magdalena"
"1473968356475","","magdalena"
"1473968356479","s = 10","magdalena"
"1473968356485","","magdalena"
"1473968356489","beta = rep(0,s)","magdalena"
"1473968356494","beta[1]=1","magdalena"
"1473968361772","beta","magdalena"
"1473968415832","","magdalena"
"1473968415847","prob=0.3","magdalena"
"1473968415847","treat=rbinom(n,1,prob)","magdalena"
"1473968429581","","magdalena"
"1473968429581","x1=0.5+rnorm(n)","magdalena"
"1473968429581","x2=0.8+rnorm(n)","magdalena"
"1473968443997","","magdalena"
"1473968443997","for (i in 1","magdalena"
"s){","","magdalena"
"1473968443997","y=beta[i]*treat+2*x1+x2+rnorm(n)","magdalena"
"1473968444013","if (i==1){","magdalena"
"1473968444013","y_mat=y","magdalena"
"1473968444013","}","magdalena"
"1473968444013","if (i>1){","magdalena"
"1473968444029","y_mat=cbind(y_mat,y)","magdalena"
"1473968444029","}","magdalena"
"1473968444029","}","magdalena"
"1473968629218","library(foreign)","magdalena"
"1473968646568","data=read.dta(blocks.dta)","magdalena"
"1473968694010","View(data)","magdalena"
"1473968793998","data=cbind(y_mat,treat)","magdalena"
"1473968843900","covariates=cbind(x1,x2)","magdalena"
"1473968857353","colnames(covariates)<-c(x1,x2)","magdalena"
"1473968864862","covariates = as.data.frame(covariates)","magdalena"
"1473968902808","","magdalena"
"1473968902808","x_1=c(x1,x2)","magdalena"
"1473968908108","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473968914387","","magdalena"
"1473968914391","k=2","magdalena"
"1473968914397","","magdalena"
"1473968914403","","magdalena"
"1473968914407","x_1=c(x1,x2)","magdalena"
"1473968914413","X=matrix(x_1,ncol=k,nrow=s,byrow=TRUE)","magdalena"
"1473979352212","rm(list = ls())","magdalena"
"1473979356841","cat(\014)","magdalena"
"1473979368193","","magdalena"
"1473979368194","","magdalena"
"1473979368194","","magdalena"
"1473979368194","","magdalena"
"1473979368194","","magdalena"
"1473979368211","","magdalena"
"1473979368211","rm(list = ls())","magdalena"
"1473979368211","","magdalena"
"1473979368211","cat(\014)","magdalena"
"1473979368227","library(lmtest)","magdalena"
"1473979368892","library(sandwich)","magdalena"
"1473979368958","","magdalena"
"1473979368958","setwd(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Research/Romano_and_Wolf)","magdalena"
"1473979368958","","magdalena"
"1473979368973","source(MHT_rw2005.R)","magdalena"
"1473980035541","?ncol","magdalena"
"1473980152157","outcome2=outcome2","magdalena"
"1473980160255","outcome2=outcome2","magdalena"
"1473980165315","outcome3=outcome3","magdalena"
"1473980167754","outcome3=outcome10","magdalena"
"1473980170284","outcome3=outcome3","magdalena"
"1473980173583","outcome10=outcome10","magdalena"
"1473980181381","l<-list(c(outcome2,x2),","magdalena"
"1473980181381","c(outcome3,x2),","magdalena"
"1473980181381","c(outcome10,x1))","magdalena"
"1473980186325","length(l)","magdalena"
"1473980201772","i=1","magdalena"
"1473980204041","aux=l[[i]]","magdalena"
"1473980207214","aux","magdalena"
"1473980260440","l[[i]][1]","magdalena"
"1473980340263","outcomes<-outcome1,outcome2,outcome3","magdalena"
"1473980344774","outcomes","magdalena"
"1473980365042","outcome1<-rep(1,10)","magdalena"
"1473980369349","outcome2<-rep(2,10)","magdalena"
"1473980373066","outcome3<-rep(3,10)","magdalena"
"1473980377841","y_mat=as.matrix(cbind(outcomes))","magdalena"
"1473980381034","y_mat","magdalena"
"1473980532194","l[[i]][-1]","magdalena"
"1474498613706","install.packages(swirl)","magdalena"
"1474498663946","library(swirl)","magdalena"
"1474498674351","swirl()","magdalena"
"1474498896286","library(swirl)","magdalena"
"1474498896292","install_course(R Programming)","magdalena"
"1474498896302","swirl()","magdalena"
"1474498922869","install.packages(curl)","magdalena"
"1474498958496","install_course(R Programming)","magdalena"
"1474499154058","library(swirl)","magdalena"
"1474499154073","install_course(R Programming)","magdalena"
"1474499154089","swirl()","magdalena"
"1474499199776","","magdalena"
"1474499199781","rm(list = ls())","magdalena"
"1474499199788","","magdalena"
"1474499199792","cat(\014)","magdalena"
"1474499212745","install.packages(swirl)","magdalena"
"1474499251003","library(swirl, lib.loc=~/R/win-library/3.3)","magdalena"
"1474499258445","library(swirl)","magdalena"
"1474499263511","install_course(R Programming)","magdalena"
"1474499338907","install_from_swirl(R_Programming)","magdalena"
"1474499391225","install.packages(RCurl)","magdalena"
"1474499403380","install.packages(RCurl)","magdalena"
"1474499431728","install.packages(swirl)","magdalena"
"1474499447387","library(swirl)","magdalena"
"1474499448573","install_from_swirl(R_Programming)","magdalena"
"1474499523339","install_course_zip(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Fall 2016/Core Methods in EDM/swirl_courses-master.zip,","magdalena"
"1474499523343","multi=TRUE,","magdalena"
"1474499523346","which_course=R Programming)","magdalena"
"1474499596565","swirl()","magdalena"
"1474499628416","5+7","magdalena"
"1474499653704","x<-5+7","magdalena"
"1474499660767","x","magdalena"
"1474499668941","y<-x-3","magdalena"
"1474499672873","y","magdalena"
"1474499690418","c(1.1,9,3.14)","magdalena"
"1474499702484","z<-c(1.1,9,3.14)","magdalena"
"1474499715264","?c","magdalena"
"1474499723701","z","magdalena"
"1474499740261","c(z,555,z)","magdalena"
"1474499749324","z*2+100","magdalena"
"1474499773096","my_sqrt<-sqrt(z-1)","magdalena"
"1474499790466","my_sqrt","magdalena"
"1474499814186","my_div<-z/my_sqrt","magdalena"
"1474499832949","my_div","magdalena"
"1474500123716","c(1,2,3,4)+c(0,10)","magdalena"
"1474500161005","c(1,2,3,4)+c(0,10,100)","magdalena"
"1474500214032","z*2+1000","magdalena"
"1474500239873","my_sqrt","magdalena"
"1474500256114","my_div","magdalena"
"1474500540550","savehistory(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Fall 2016/Core Methods in EDM/history_database1.Rhistory)","magdalena"
"1474500676378","savehistory(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Fall 2016/Core Methods in EDM/history_database1.Rhistory)","magdalena"
"1474500816818","H <-read.table(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Fall 2016/Core Methods in EDM/history_database1.Rhistory, sep=:, fill=T, stringsAsFactors=F)","magdalena"
"1474500822969","H","magdalena"
"1474500883482","H <-read.table(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Fall 2016/Core Methods in EDM/history_database1.Rhistory, sep= , fill=T, stringsAsFactors=F)","magdalena"
"1474500883489","names(H) <- c(time, answer)","magdalena"
"1474500894043","h","magdalena"
"1474500896875","H","magdalena"
"1474500907607","View(H)","magdalena"
"1474500964046","H <-read.table(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Fall 2016/Core Methods in EDM/history_database1.Rhistory, sep=:, fill=T, stringsAsFactors=F)","magdalena"
"1474500964049","names(H) <- c(time, answer)","magdalena"
"1474501084975","swirl_options()","magdalena"
"1474501454087","savehistory(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Fall 2016/Core Methods in EDM/history_database1.Rhistory)","magdalena"
"1474501478879","savehistory(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Fall 2016/Core Methods in EDM/history_database1.Rhistory)","magdalena"
"1474501482129","H <-read.table(C:/Users/Magdalena Bennett/Dropbox/PhD Columbia/Fall 2016/Core Methods in EDM/history_database1.Rhistory, sep=:, fill=T, stringsAsFactors=F)","magdalena"
"1474501486128","View(H)","magdalena"
"1474501556916","H<-cbind(rownames(H),H)","magdalena"
"1474501556923","names(H) <- c(time, answer)","magdalena"
"1474501585107","setwd(~/Class 5 - Swirl)","magdalena"
"1474501592291","write.csv(H, file = lesson1.csv, row.names = FALSE)","magdalena"
"1474502023932","H$id <- magdalena","magdalena"
"1474502023939","write.csv(H, file = lesson1.csv, row.names = FALSE)","magdalena"
"1474556810436","H <-read.table(C:/Users/Magdalena Bennett/AppData/Local/RStudio-Desktop/history_database, sep=:, fill=T, stringsAsFactors=F)","magdalena"
